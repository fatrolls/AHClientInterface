/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

int __thiscall sub_103E(_DWORD *this, int a2, int a3);
// int __usercall sub_10CD@<eax>(_DWORD *a1@<ecx>, int a2@<ebp>);
int __thiscall sub_110C(_DWORD *this, int a2, int a3);
// int __usercall sub_1156@<eax>(_DWORD *a1@<ecx>, int a2@<ebp>);
// int __usercall sub_11C0@<eax>(_DWORD *a1@<ecx>, int a2@<ebp>);
// unsigned int __usercall sub_1201@<eax>(_DWORD *this@<ecx>, int a2@<ebp>);
int __thiscall sub_131D(_DWORD *this, _BYTE *a2, int a3);
// int __usercall sub_1562@<eax>(int a1@<esi>);
_DWORD *__thiscall sub_1679(_DWORD *this, int a2, int a3);
int __cdecl sub_1747(unsigned int a1, unsigned __int8 *a2, unsigned int a3);
int __cdecl sub_1860(int a1, _BYTE *a2, unsigned int a3);
int (__cdecl *__cdecl sub_238B(_DWORD *a1, int a2, _DWORD *a3))(_DWORD, _DWORD, _DWORD);
_DWORD *__cdecl sub_23F6(int a1, int a2, int a3);
int __cdecl sub_2BFB(_DWORD *a1, int a2);
int __cdecl sub_31C7(int a1, int a2);
int __cdecl sub_3498(_DWORD *a1);
int __cdecl sub_34D7(_DWORD *a1);
int __cdecl sub_3515(_DWORD *a1, int a2, _BYTE *a3, int a4);
_DWORD __cdecl sub_35FA(_DWORD, _DWORD); // weak
// int __usercall sub_3961@<eax>(unsigned int *a1@<eax>, _DWORD *a2, unsigned int a3, unsigned int a4, int a5, int a6, _DWORD *a7, int a8, unsigned int *a9, unsigned int *a10);
int __cdecl sub_3E8F(_DWORD *a1, _DWORD *a2, int a3);
// int __usercall sub_3F7B@<eax>(int result@<eax>);
// int __usercall sub_3FD9@<eax>(int result@<eax>, int a2@<edi>, int a3);
// int __usercall sub_4089@<eax>(int *a1@<eax>, _DWORD *a2@<edx>);
// int __usercall sub_4241@<eax>(int result@<eax>, int a2@<ecx>, _WORD *a3);
// int __usercall sub_42FD@<eax>(int result@<eax>, int a2@<edx>, int a3@<ecx>);
// int __usercall sub_479A@<eax>(int a1@<eax>, int a2, int a3, int a4);
// int __usercall sub_49D3@<eax>(int result@<eax>, int a2, int a3);
bool __thiscall sub_4D85(unsigned __int16 *this);
// int __usercall sub_4DDA@<eax>(int result@<eax>);
// _DWORD *__usercall sub_4E31@<eax>(int a1@<eax>, _BYTE *a2@<edx>, int a3@<ecx>, int a4);
// int __usercall sub_4EA9@<eax>(int a1@<edx>, int a2@<ebx>, int a3);
// int __usercall sub_4F27@<eax>(_DWORD *a1@<esi>, int *a2);
// int __usercall sub_510C@<eax>(int a1@<eax>);
_DWORD *__cdecl sub_5169(int a1, _BYTE *a2, int a3, int a4);
// void __usercall sub_53E0(int a1@<ebp>);
int sub_5433();
_DWORD __cdecl sub_5460(_DWORD, _DWORD, _DWORD); // weak
unsigned __int8 *__cdecl sub_57A0(unsigned __int8 *a1, unsigned __int8 a2, unsigned int a3);
// void __usercall sub_5800(int a1@<ebp>);
int sub_5872();
// void __usercall sub_587B(int a1@<ebp>, unsigned int a2, int a3);
// void __usercall sub_58A7(int a1@<ebp>, unsigned int a2);
// int *__usercall sub_58B9@<eax>(int a1@<ebp>);
// int *__usercall sub_58C2@<eax>(int a1@<ebp>);
// int *__usercall sub_58CB@<eax>(int a1@<ebp>, unsigned int a2);
// void __usercall sub_596F(int a1@<ecx>, int a2@<ebp>);
// void __usercall sub_5980(unsigned int a1@<eax>, char a2);
// void __usercall sub_59BD(int a1@<ebp>, unsigned int a2);
char *__cdecl sub_5A70(_DWORD *a1);
void sub_5C70();
_DWORD *__cdecl sub_5C80(_DWORD *a1, _BYTE *a2);
void __cdecl __noreturn sub_5D68(int a1);
int sub_5D98();
int sub_5DA1();
// int (*__usercall sub_5DAA@<eax>(int (*result)(void)@<eax>, unsigned int a2))(void);
// int __usercall sub_5DC2@<eax>(int a1@<ebp>, int a2);
// void __usercall sub_5E2C(int a1@<ebp>);
// int __usercall sub_5EDB@<eax>(int a1@<ebp>, int a2@<edi>);
// void __usercall sub_5EEF(int a1@<ebp>);
// void __usercall sub_5F00(int a1@<ebp>);
// void __usercall sub_6070(int a1@<ebp>);
int sub_611A();
int __cdecl sub_6390(int a1);
int sub_63C3();
int __cdecl sub_63DD(int a1);
int sub_642E();
// int __usercall sub_64AD@<eax>(int a1@<ebp>);
int __cdecl sub_654B(int a1);
// void __usercall sub_6560(int a1@<ebp>);
int sub_65F7();
int __cdecl sub_6600(int a1);
int __cdecl sub_6631(int a1);
unsigned int __cdecl sub_6679(int a1);
_DWORD *__cdecl sub_66A4(_DWORD *a1, int a2);
_DWORD *sub_69BC();
int __cdecl sub_6A73(_DWORD *a1);
int __cdecl sub_6B79(_DWORD *a1, int a2, int a3);
_DWORD *__cdecl sub_6E58(int a1);
_DWORD *__cdecl sub_7154(int a1, int a2);
void sub_718F();
BOOL __cdecl sub_72A9(int a1);
// int __usercall sub_72CD@<eax>(int a1@<ebp>);
int __cdecl sub_72EA(int a1);
// int *__usercall sub_72FD@<eax>(int a1@<ebp>);
// void __userpurge sub_736E(int a1@<ebp>, int a2);
int sub_74A0();
int sub_74AC();
// void __usercall sub_74B5(int a1@<ebp>, int a2);
// int __usercall sub_74E4@<eax>(int a1@<ebp>);
int __cdecl sub_7639(_DWORD, _DWORD); // weak
// int __usercall sub_7BFF@<eax>(_BYTE *a1@<ebp>, int a2@<edi>, int a3@<esi>);
// void __usercall sub_7DFD(int a1@<ebp>);
// void __usercall sub_7E49(int a1@<ebp>, int a2@<edi>);
// void __usercall sub_7EF1(int a1@<ebp>);
int sub_7F23();
// int __usercall sub_7F29@<eax>(int a1@<ebp>);
// void __usercall sub_7F3B(int a1@<ebp>);
// int __usercall sub_805E@<eax>(int a1@<ebp>);
// char **__usercall sub_8125@<eax>(char *a1@<eax>, char *a2@<ecx>, _DWORD *a3@<esi>, char **a4, _DWORD *a5);
int sub_8291();
int sub_8333();
unsigned int __cdecl sub_85D4(int a1);
unsigned int sub_874B();
// void __usercall sub_8794(int a1@<ebp>);
int __cdecl sub_8820(int a1);
// int __usercall sub_8862@<eax>(int a1@<ebp>, int a2, int a3);
// int __userpurge sub_88F6@<eax>(int result@<eax>, int a2@<ebp>, int a3);
_DWORD __cdecl sub_8910(_DWORD, _DWORD, _DWORD); // weak
int __cdecl sub_8C4D(unsigned int a1);
// void __usercall sub_8E76(int a1@<ebp>, int a2);
// int __usercall sub_8F46@<eax>(int a1@<ebp>);
// void __usercall sub_9007(int a1@<ebp>);
int sub_9039();
// int __usercall sub_9042@<eax>(int a1@<eax>);
int sub_9071();
unsigned int sub_909A();
int __cdecl sub_9226(int a1);
// void __usercall sub_93B6(int a1@<ebp>);
int sub_94FD();
// int __usercall sub_9506@<eax>(int a1@<ebp>);
int __cdecl sub_9524(int a1, int a2, int a3);
_BYTE *__cdecl sub_9620(_BYTE *a1, char *a2, unsigned int a3);
// int __usercall sub_9846@<eax>(int a1@<ebp>, int a2);
// void __usercall sub_99E5(int a1@<ebp>);
int sub_9B4D();
// void __usercall sub_9B92(int a1@<ebp>);
int sub_9BFF();
// void __usercall sub_9C08(int a1@<ebp>, int a2);
// void __usercall sub_9D98(int a1@<ebp>, _DWORD *a2);
// void __usercall sub_9DF7(int a1@<ebp>, _DWORD *a2);
// void __usercall sub_A068(_DWORD *a1@<ebp>);
// void __usercall sub_A2B0(int a1@<ebp>);
// int __usercall sub_A7B1@<eax>(int a1@<ebp>, unsigned __int8 *a2);
int __cdecl sub_A839(int a1);
// void __usercall sub_A87C(int a1@<ebp>);
int __cdecl sub_AA45(_DWORD *a1, int a2, int a3);
int __stdcall sub_AC3E(_DWORD, _DWORD, _DWORD, _DWORD); // weak
void __cdecl decrypt(void **, int *, unsigned __int8 *, int); // idb
// void __usercall _L31378(int a1@<ebp>);
void __cdecl __noreturn Interface_SeTranslator(unsigned int pExceptionObject);
int _E34();
CProtectedAddress *_E31();
int _E33();
void __cdecl _E32(); // idb
int _E39();
CProtectedAddress *_E36();
int _E38();
void __cdecl _E37(); // idb
int _E44();
MutexBuffer_T *_E41();
int _E43();
void __cdecl _E42(); // idb
void __thiscall MutexBuffer_T::~MutexBuffer_T(LPCRITICAL_SECTION lpCriticalSection); // idb
// void __usercall _L31421(int a1@<ebp>);
MutexBuffer_T *__thiscall MutexBuffer_T::MutexBuffer_T(LPCRITICAL_SECTION lpCriticalSection); // idb
// void __usercall _L31433(int a1@<ebp>);
int _E49();
CProtectedAddress *_E46();
int _E48();
void __cdecl _E47(); // idb
int _E54();
CProtectedAddress *_E51();
int _E53();
void __cdecl _E52(); // idb
// void __userpurge CHCSetCodeData(int a1@<edi>, const void *a2, int a3);
// void __usercall _L31463(int a1@<ebp>);
void __cdecl free_lib(); // idb
// unsigned int __usercall load_lib@<eax>(int a1@<edi>);
// void __usercall _L31509(int a1@<ebp>);
_DWORD _L31605(); // weak
// int __userpurge _L31612@<eax>(int a1@<ebp>, int a2, int a3);
_DWORD _L31603(); // weak
// int __userpurge _L31611@<eax>(int a1@<ebp>, int a2, int a3);
_DWORD _L31606(); // weak
// int __userpurge _L31613@<eax>(int a1@<ebp>, int a2, int a3);
_DWORD _L31607(); // weak
// int __userpurge _L31614@<eax>(int a1@<ebp>, int a2, int a3);
int (__userpurge *_L31599())@<eax>(int a1@<ebp>, int a2, int a3);
// int __userpurge _L31609@<eax>(int a1@<ebp>, int a2, int a3);
int (__userpurge *_L31600())@<eax>(int a1@<ebp>, int a2, int a3);
// int __userpurge _L31610@<eax>(int a1@<ebp>, int a2, int a3);
// void __usercall _L31608(int a1@<ebp>);
void __cdecl cleanup_sh(); // weak
int __stdcall CHCEnd();
int _E17();
int _E14();
int _E16();
void __cdecl _E15(); // idb
int _E23();
int _E20();
int _E22();
void __cdecl _E21(); // idb
void __thiscall CSHMutex::~CSHMutex(LPCRITICAL_SECTION lpCriticalSection); // idb
void __thiscall CSHMutexLock::~CSHMutexLock(CSHMutexLock *__hidden this); // idb
int _E61();
int _E60();
void __cdecl std::ctype<unsigned short>::id`template static data member destructor helper'(); // idb
// unsigned int __cdecl UnloadPbDllFromMemory(struct _IMAGE_DOS_HEADER *); idb
// void *__cdecl operator new(unsigned int); idb
// void __thiscall CProtectedString::~CProtectedString(CProtectedString *__hidden this); idb
// unsigned int __cdecl GetProcAddressDirectly(struct _IMAGE_DOS_HEADER *, char *); idb
// char *__thiscall CProtectedString::Str(CProtectedString *__hidden this); idb
// CProtectedString *__thiscall CProtectedString::CProtectedString(CProtectedString *__hidden this, char *, int, unsigned int, unsigned int); idb
// unsigned int __cdecl LoadPbDllFromMemory(void *, void **); idb
// void __stdcall __noreturn _CxxThrowException(void *pExceptionObject, _ThrowInfo *pThrowInfo);
// CProtectedAddress *__thiscall CProtectedAddress::CProtectedAddress(CProtectedAddress *__hidden this, void *); idb
// int __cdecl atexit(void (__cdecl *)());
// void __thiscall CProtectedAddress::~CProtectedAddress(CProtectedAddress *__hidden this); idb
// void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection);
// void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection);
// void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection);
// int __thiscall CProtectedAddress::operator=(_DWORD, _DWORD); weak
// void __cdecl operator delete(void *); idb
// int __thiscall CProtectedAddress::operator()(_DWORD, _DWORD); weak
// void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection);
// unsigned int __cdecl UnloadAHPe(void *); idb
// unsigned int __cdecl LoadAHPe(void *, void **, struct AHPE_ExportFunction_T *); idb
// void __thiscall CFileMapping::~CFileMapping(CFileMapping *__hidden this); idb
// void __thiscall CFileMapping::OpenRead(CFileMapping *__hidden this, const char *, unsigned int *, unsigned int); idb
// CFileMapping *__thiscall CFileMapping::CFileMapping(CFileMapping *__hidden this); idb
// char *__cdecl strrchr(const char *Str, int Ch);
// DWORD __stdcall GetModuleFileNameA(HMODULE hModule, LPSTR lpFilename, DWORD nSize);
// void (__cdecl *__cdecl _set_se_translator(void (__cdecl *)(unsigned int, struct _EXCEPTION_POINTERS *)))(unsigned int, struct _EXCEPTION_POINTERS *); idb
// _DWORD __thiscall std::ios_base::Init::Init(std::ios_base::Init *__hidden this); idb
// void __thiscall std::ios_base::Init::~Init(std::ios_base::Init *__hidden this); idb
// _DWORD __thiscall std::_Winit::_Winit(std::_Winit *__hidden this); idb
// void __thiscall std::_Winit::~_Winit(std::_Winit *__hidden this); idb

//-------------------------------------------------------------------------
// Data declarations

int (*_S35[6])() = { &_E34, &_E39, &_E44, &_E49, &_E54, &_E61 }; // weak
_UNKNOWN lpziplib; // weak
void *off_24 = (void *)3; // weak
_UNKNOWN unk_12010; // weak
_UNKNOWN pcodedata_Protected; // weak
struct _RTL_CRITICAL_SECTION g_muextBuffer; // idb
int dword_12044; // weak
int dword_12048; // weak
_UNKNOWN ncodedatalen_Protected; // weak
_UNKNOWN _Wios_init; // weak
_UNKNOWN _Ios_init; // weak
_UNKNOWN lpImageDll_Protected; // weak
_UNKNOWN g_client_Protected; // weak
int init; // weak
int g_sh_init; // weak
int g_sh_set_info; // weak
int g_sh_done; // weak
int g_set_db_buf; // weak
int g_set_base; // weak
int g_set_func; // weak
_UNKNOWN _L31384; // weak
_UNKNOWN `string'; // weak
char `string'[8] = { '\x87', 'v', '9', '\x1D', '\xFB', '\xA1', '\x99', '\0' }; // idb
const _ThrowInfo _TI1I = { 0u, &_S18, &_S18, &_CTA1I }; // idb
_UNKNOWN _L31427; // weak
_UNKNOWN _L31439; // weak
_UNKNOWN _L31493; // weak
_UNKNOWN _L31580; // weak
_UNKNOWN `string'; // weak
_UNKNOWN _L31639; // weak
// extern _UNKNOWN _except_list; weak
// extern _UNKNOWN ___B_1___id___ctype_G_std___D__9_51; weak


//----- (0000103E) --------------------------------------------------------
int __thiscall sub_103E(_DWORD *this, int a2, int a3)
{
  int v5; // eax
  _DWORD *v6; // ebx
  int v7; // edi
  unsigned __int8 *v8; // eax
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  if ( !a2 )
    return 0;
  v5 = a3 + this[1];
  if ( v5 > this[259] )
  {
    v6 = (_DWORD *)*this;
    v7 = (v5 / 1024 + 1) << 10;
    sub_58A7((int)&savedregs, v7 + 1);
    *this = v8;
    this[259] = v7;
    sub_57A0(v8, 0, v7 + 1);
    sub_5460(*this, v6, this[1]);
    if ( v6 != this + 2 )
      sub_53E0((int)&savedregs);
  }
  sub_5460(*this + this[1], a2, a3);
  this[1] += a3;
  return a3;
}
// 1080: variable 'v8' is possibly undefined
// 5460: using guessed type _DWORD __cdecl sub_5460(_DWORD, _DWORD, _DWORD);

//----- (000010CD) --------------------------------------------------------
int __usercall sub_10CD@<eax>(_DWORD *a1@<ecx>, int a2@<ebp>)
{
  int v3; // edi

  v3 = 0;
  if ( a1[267] )
    v3 = sub_34D7(a1 + 260);
  if ( (int)a1[274] < 0 )
    v3 = a1[274];
  if ( a1[275] )
    sub_53E0(a2);
  return v3;
}

//----- (0000110C) --------------------------------------------------------
int __thiscall sub_110C(_DWORD *this, int a2, int a3)
{
  int v4; // ecx
  int v5; // eax
  int v6; // edi

  v4 = this[279];
  v5 = this[281];
  v6 = a3;
  if ( v4 + a3 >= v5 )
    v6 = v5 - v4;
  if ( v6 <= 0 )
    return 0;
  sub_5460(a2, v4 + this[280], v6);
  this[279] += v6;
  return v6;
}
// 5460: using guessed type _DWORD __cdecl sub_5460(_DWORD, _DWORD, _DWORD);

//----- (00001156) --------------------------------------------------------
int __usercall sub_1156@<eax>(_DWORD *a1@<ecx>, int a2@<ebp>)
{
  int v3; // eax
  int result; // eax
  unsigned __int8 *v5; // edx

  if ( a1[277] )
    return -1;
  if ( !a1[261] )
  {
    *sub_58B9(a2) = 0;
    v3 = sub_110C(a1, a1[275], 4096);
    a1[261] = v3;
    if ( !v3 )
    {
      a1[277] = 1;
      return -1;
    }
    a1[260] = a1[275];
  }
  --a1[261];
  v5 = (unsigned __int8 *)a1[260];
  result = *v5;
  a1[260] = v5 + 1;
  return result;
}

//----- (000011C0) --------------------------------------------------------
int __usercall sub_11C0@<eax>(_DWORD *a1@<ecx>, int a2@<ebp>)
{
  int v3; // edi
  int v4; // edi
  int v5; // edi
  int v6; // eax

  v3 = sub_1156(a1, a2);
  v4 = (sub_1156(a1, a2) << 8) + v3;
  v5 = (sub_1156(a1, a2) << 16) + v4;
  v6 = sub_1156(a1, a2);
  if ( v6 == -1 )
    a1[274] = -3;
  return v5 + (v6 << 24);
}

//----- (00001201) --------------------------------------------------------
unsigned int __usercall sub_1201@<eax>(_DWORD *this@<ecx>, int a2@<ebp>)
{
  int v3; // edi
  int v4; // eax
  int v5; // edi
  unsigned int result; // eax
  char v7; // bl
  int v8; // edi
  int v9; // edi
  int v10; // edi
  int v11; // eax
  int v12; // eax
  int v13; // eax
  int v14; // edi

  v3 = 0;
  while ( 1 )
  {
    v4 = sub_1156(this, a2);
    if ( v4 != *(_DWORD *)(4 * v3 + 0x1000B11C) )
      break;
    if ( (unsigned int)++v3 >= 2 )
    {
      v5 = sub_1156(this, a2);
      result = sub_1156(this, a2);
      v7 = result;
      if ( v5 != 8 || (result & 0xE0) != 0 )
      {
        this[274] = -3;
      }
      else
      {
        v8 = 6;
        do
        {
          sub_1156(this, a2);
          --v8;
        }
        while ( v8 );
        if ( (v7 & 4) != 0 )
        {
          v9 = sub_1156(this, a2);
          v10 = (sub_1156(this, a2) << 8) + v9;
          do
            v11 = v10--;
          while ( v11 && sub_1156(this, a2) != -1 );
        }
        if ( (v7 & 8) != 0 )
        {
          do
            v12 = sub_1156(this, a2);
          while ( v12 && v12 != -1 );
        }
        if ( (v7 & 0x10) != 0 )
        {
          do
            v13 = sub_1156(this, a2);
          while ( v13 && v13 != -1 );
        }
        if ( (v7 & 2) != 0 )
        {
          v14 = 2;
          do
          {
            sub_1156(this, a2);
            --v14;
          }
          while ( v14 );
        }
        result = this[277] != 0 ? 0xFFFFFFFD : 0;
        this[274] = result;
      }
      return result;
    }
  }
  if ( v3 )
  {
    ++this[261];
    --this[260];
  }
  if ( v4 != -1 )
  {
    ++this[261];
    --this[260];
    this[278] = 1;
  }
  result = this[261] == 0;
  this[274] = result;
  return result;
}

//----- (0000131D) --------------------------------------------------------
int __thiscall sub_131D(_DWORD *this, _BYTE *a2, int a3)
{
  int v4; // eax
  int result; // eax
  int v6; // ebx
  int v7; // eax
  int v8; // eax
  unsigned int v9; // edi
  int v10; // ebx
  int v11; // [esp+Ch] [ebp-10h]
  int v12; // [esp+10h] [ebp-Ch]
  int v13; // [esp+14h] [ebp-8h]
  _BYTE *v14; // [esp+18h] [ebp-4h]
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  v4 = this[274];
  v14 = a2;
  if ( v4 == -3 || v4 == -1 )
    return -1;
  if ( v4 == 1 )
    return 0;
  v6 = a3;
  v13 = (int)a2;
  this[263] = a2;
  this[264] = a3;
  if ( a3 )
  {
    while ( !this[278] )
    {
      if ( !this[261] && !this[277] )
      {
        *sub_58B9((int)&savedregs) = 0;
        v7 = sub_110C(this, this[275], 4096);
        this[261] = v7;
        if ( !v7 )
          this[277] = 1;
        this[260] = this[275];
      }
      v8 = sub_35FA(this + 260, 0);
      this[274] = v8;
      if ( v8 == 1 )
      {
        this[276] = sub_1860(this[276], v14, this[263] - (_DWORD)v14);
        v14 = (_BYTE *)this[263];
        if ( sub_11C0(this, (int)&savedregs) != this[276] )
        {
          this[274] = -3;
          goto LABEL_19;
        }
        sub_11C0(this, (int)&savedregs);
        sub_1201(this, (int)&savedregs);
        if ( this[274] )
          goto LABEL_19;
        v12 = this[262];
        v11 = this[265];
        sub_3498(this + 260);
        this[262] = v12;
        this[265] = v11;
        v6 = a3;
        this[276] = sub_1860(0, 0, 0);
      }
      if ( this[274] || this[277] || !this[264] )
        goto LABEL_19;
    }
    v9 = this[261];
    if ( v9 > this[264] )
      v9 = this[264];
    if ( v9 )
    {
      sub_5460(this[263], this[260], v9);
      this[260] += v9;
      this[264] -= v9;
      v6 = a3;
      this[261] -= v9;
      v13 = (int)&a2[v9];
      this[263] = &a2[v9];
    }
    if ( this[264] )
      this[264] -= sub_110C(this, v13, this[264]);
    v10 = v6 - this[264];
    this[262] += v10;
    this[265] += v10;
    if ( !v10 )
      this[277] = 1;
    result = v10;
  }
  else
  {
LABEL_19:
    this[276] = sub_1860(this[276], v14, this[263] - (_DWORD)v14);
    result = v6 - this[264];
  }
  return result;
}
// 35FA: using guessed type _DWORD __cdecl sub_35FA(_DWORD, _DWORD);
// 5460: using guessed type _DWORD __cdecl sub_5460(_DWORD, _DWORD, _DWORD);

//----- (00001562) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_1562@<eax>(int a1@<esi>)
{
  int v1; // ecx
  int result; // eax
  _DWORD *v3; // esi
  bool v4; // zf
  int v5; // eax
  int v6; // eax
  _DWORD *v7; // ecx
  char v8[4044]; // [esp+0h] [ebp-1004h] BYREF
  _DWORD *v9; // [esp+FCCh] [ebp-38h]
  int v10; // [esp+FD0h] [ebp-34h]
  int v11; // [esp+FD4h] [ebp-30h]
  int v12; // [esp+FD8h] [ebp-2Ch]
  unsigned int v13; // [esp+FDCh] [ebp-28h]
  int v14; // [esp+FE0h] [ebp-24h]
  _BYTE *v15; // [esp+FE4h] [ebp-20h]
  unsigned int v16; // [esp+FE8h] [ebp-1Ch]
  unsigned __int8 *v17; // [esp+FECh] [ebp-18h]
  unsigned __int8 v18; // [esp+FF0h] [ebp-14h]
  unsigned int v19; // [esp+FF4h] [ebp-10h]
  int v20; // [esp+1000h] [ebp-4h]
  int savedregs; // [esp+1004h] [ebp+0h] BYREF

  sub_5980(0x1004u, savedregs);
  result = MEMORY[0x1000F368];
  v20 = a1;
  v3 = (_DWORD *)v1;
  v4 = *(_DWORD *)(v1 + 1120) == 0;
  v20 = MEMORY[0x1000F368];
  if ( v4 )
  {
    *(_DWORD *)v1 = 0;
    *(_DWORD *)(v1 + 4) = 0;
  }
  else
  {
    v19 = 1025;
    v18 = 0;
    v17 = (unsigned __int8 *)(v1 + 8);
    *(_DWORD *)(v1 + 1036) = 1024;
    *(_DWORD *)v1 = v1 + 8;
    sub_57A0(v17, v18, v19);
    v16 = 0;
    v15 = 0;
    v14 = 0;
    v3[268] = 0;
    v3[269] = 0;
    v3[270] = 0;
    v3[275] = 0;
    v3[260] = 0;
    v3[263] = 0;
    v3[264] = 0;
    v3[261] = 0;
    v3[274] = 0;
    v3[277] = 0;
    v3[278] = 0;
    v13 = 4096;
    v3[276] = sub_1860(v14, v15, v16);
    sub_58A7((int)&savedregs, v13);
    v12 = 56;
    v11 = 268480804;
    v10 = -15;
    v9 = v3 + 260;
    v3[275] = v5;
    v3[260] = v5;
    if ( sub_3515(v9, v10, (_BYTE *)v11, v12) || !v3[275] )
    {
      v7 = v3;
    }
    else
    {
      v3[264] = 4096;
      sub_1201(v3, (int)&savedregs);
      while ( 1 )
      {
        v6 = sub_131D(v3, v8, 4096);
        v7 = v3;
        if ( v6 <= 0 )
          break;
        sub_103E(v3, (int)v8, v6);
      }
    }
    result = sub_10CD(v7, (int)&savedregs);
  }
  return result;
}
// 1562: could not find valid save-restore pair for esi
// 1649: bad sp value at call
// 1658: bad sp value at call
// 1576: variable 'v1' is possibly undefined
// 1616: variable 'v5' is possibly undefined

//----- (00001679) --------------------------------------------------------
_DWORD *__thiscall sub_1679(_DWORD *this, int a2, int a3)
{
  *this = 0;
  this[1] = 0;
  this[279] = 0;
  this[280] = a2;
  this[281] = a3;
  sub_1562((int)this);
  return this;
}

//----- (00001747) --------------------------------------------------------
int __cdecl sub_1747(unsigned int a1, unsigned __int8 *a2, unsigned int a3)
{
  unsigned __int8 *v3; // ecx
  unsigned int v4; // esi
  unsigned int v5; // edi
  int v7; // edx
  unsigned int v8; // eax
  int v9; // esi
  int v10; // edi
  int v11; // esi
  int v12; // edi
  int v13; // esi
  int v14; // edi
  int v15; // esi
  int v16; // edi
  int v17; // esi
  int v18; // edi
  int v19; // esi
  int v20; // edi
  int v21; // esi
  int v22; // edi
  int v23; // esi
  int v24; // edi
  int v25; // esi
  int v26; // edi
  int v27; // esi
  int v28; // edi
  int v29; // esi
  int v30; // edi
  int v31; // esi
  int v32; // edi
  int v33; // esi
  int v34; // edi
  int v35; // esi
  int v36; // edi
  int v37; // esi
  int v38; // edi

  v3 = a2;
  v4 = (unsigned __int16)a1;
  v5 = HIWORD(a1);
  if ( !a2 )
    return 1;
  for ( ; a3; v5 %= 0xFFF1u )
  {
    v7 = 5552;
    if ( a3 < 0x15B0 )
      v7 = a3;
    a3 -= v7;
    if ( v7 >= 16 )
    {
      v8 = (unsigned int)v7 >> 4;
      v7 += -16 * ((unsigned int)v7 >> 4);
      do
      {
        v9 = *v3 + v4;
        v10 = v9 + v5;
        v11 = v3[1] + v9;
        v12 = v11 + v10;
        v13 = v3[2] + v11;
        v14 = v13 + v12;
        v15 = v3[3] + v13;
        v16 = v15 + v14;
        v17 = v3[4] + v15;
        v18 = v17 + v16;
        v19 = v3[5] + v17;
        v20 = v19 + v18;
        v21 = v3[6] + v19;
        v22 = v21 + v20;
        v23 = v3[7] + v21;
        v24 = v23 + v22;
        v25 = v3[8] + v23;
        v26 = v25 + v24;
        v27 = v3[9] + v25;
        v28 = v27 + v26;
        v29 = v3[10] + v27;
        v30 = v29 + v28;
        v31 = v3[11] + v29;
        v32 = v31 + v30;
        v33 = v3[12] + v31;
        v34 = v33 + v32;
        v35 = v3[13] + v33;
        v36 = v35 + v34;
        v37 = v3[14] + v35;
        v38 = v37 + v36;
        v4 = v3[15] + v37;
        v5 = v4 + v38;
        v3 += 16;
        --v8;
      }
      while ( v8 );
    }
    for ( ; v7; --v7 )
    {
      v4 += *v3++;
      v5 += v4;
    }
    v4 %= 0xFFF1u;
  }
  return v4 | (v5 << 16);
}

//----- (00001860) --------------------------------------------------------
int __cdecl sub_1860(int a1, _BYTE *a2, unsigned int a3)
{
  _BYTE *v3; // edx
  unsigned int v5; // eax
  unsigned int v6; // esi
  unsigned int v7; // edi
  unsigned int v8; // esi
  _BYTE *v9; // edx
  unsigned int v10; // esi
  unsigned int v11; // esi
  unsigned int v12; // esi
  unsigned int v13; // esi
  unsigned int v14; // esi
  unsigned int v15; // esi

  v3 = a2;
  if ( !a2 )
    return 0;
  v5 = a3;
  v6 = ~a1;
  if ( a3 >= 8 )
  {
    v7 = a3 >> 3;
    do
    {
      v5 -= 8;
      v8 = *(_DWORD *)(4 * (unsigned __int8)(v6 ^ *v3) + 0x1000B130) ^ (v6 >> 8);
      v9 = v3 + 1;
      v10 = *(_DWORD *)(4 * (unsigned __int8)(v8 ^ *v9++) + 0x1000B130) ^ (v8 >> 8);
      v11 = *(_DWORD *)(4 * (unsigned __int8)(v10 ^ *v9++) + 0x1000B130) ^ (v10 >> 8);
      v12 = *(_DWORD *)(4 * (unsigned __int8)(v11 ^ *v9++) + 0x1000B130) ^ (v11 >> 8);
      v13 = *(_DWORD *)(4 * (unsigned __int8)(v12 ^ *v9++) + 0x1000B130) ^ (v12 >> 8);
      v14 = *(_DWORD *)(4 * (unsigned __int8)(v13 ^ *v9++) + 0x1000B130) ^ (v13 >> 8);
      v15 = *(_DWORD *)(4 * (unsigned __int8)(v14 ^ *v9++) + 0x1000B130) ^ (v14 >> 8);
      v6 = *(_DWORD *)(4 * (unsigned __int8)(v15 ^ *v9) + 0x1000B130) ^ (v15 >> 8);
      v3 = v9 + 1;
      --v7;
    }
    while ( v7 );
  }
  for ( ; v5; --v5 )
    v6 = *(_DWORD *)(4 * (unsigned __int8)(v6 ^ *v3++) + 0x1000B130) ^ (v6 >> 8);
  return ~v6;
}

//----- (0000238B) --------------------------------------------------------
int (__cdecl *__cdecl sub_238B(_DWORD *a1, int a2, _DWORD *a3))(_DWORD, _DWORD, _DWORD)
{
  int v3; // eax
  int (__cdecl *result)(_DWORD, _DWORD, _DWORD); // eax

  if ( a3 )
    *a3 = a1[15];
  if ( *a1 == 4 || *a1 == 5 )
    (*(void (__cdecl **)(_DWORD, _DWORD))((char *)&off_24 + a2))(*(_DWORD *)(a2 + 40), a1[3]);
  if ( *a1 == 6 )
    sub_31C7(a1[1], a2);
  v3 = a1[10];
  a1[13] = v3;
  a1[12] = v3;
  result = (int (__cdecl *)(_DWORD, _DWORD, _DWORD))a1[14];
  *a1 = 0;
  a1[7] = 0;
  a1[8] = 0;
  if ( result )
  {
    result = (int (__cdecl *)(_DWORD, _DWORD, _DWORD))result(0, 0, 0);
    a1[15] = result;
    *(_DWORD *)(a2 + 48) = result;
  }
  return result;
}
// 24: using guessed type void *off_24;

//----- (000023F6) --------------------------------------------------------
_DWORD *__cdecl sub_23F6(int a1, int a2, int a3)
{
  _DWORD *v3; // edi
  int v4; // eax
  _DWORD *result; // eax
  int v6; // eax

  v3 = (_DWORD *)(*(int (__cdecl **)(_DWORD, int, int))(a1 + 32))(*(_DWORD *)(a1 + 40), 1, 64);
  if ( !v3 )
    return 0;
  v4 = (*(int (__cdecl **)(_DWORD, int, int))(a1 + 32))(*(_DWORD *)(a1 + 40), 8, 1440);
  v3[9] = v4;
  if ( !v4 )
  {
    (*(void (__cdecl **)(_DWORD, _DWORD *))((char *)&off_24 + a1))(*(_DWORD *)(a1 + 40), v3);
    return 0;
  }
  v6 = (*(int (__cdecl **)(_DWORD, int, int))(a1 + 32))(*(_DWORD *)(a1 + 40), 1, a3);
  v3[10] = v6;
  if ( v6 )
  {
    *v3 = 0;
    v3[11] = a3 + v6;
    v3[14] = a2;
    sub_238B(v3, a1, 0);
    result = v3;
  }
  else
  {
    (*(void (__cdecl **)(_DWORD, _DWORD))((char *)&off_24 + a1))(*(_DWORD *)(a1 + 40), v3[9]);
    (*(void (__cdecl **)(_DWORD, _DWORD *))((char *)&off_24 + a1))(*(_DWORD *)(a1 + 40), v3);
    result = 0;
  }
  return result;
}
// 24: using guessed type void *off_24;

//----- (00002BFB) --------------------------------------------------------
int __cdecl sub_2BFB(_DWORD *a1, int a2)
{
  sub_238B(a1, a2, 0);
  (*(void (__cdecl **)(_DWORD, _DWORD))((char *)&off_24 + a2))(*(_DWORD *)(a2 + 40), a1[10]);
  (*(void (__cdecl **)(_DWORD, _DWORD))((char *)&off_24 + a2))(*(_DWORD *)(a2 + 40), a1[9]);
  (*(void (__cdecl **)(_DWORD, _DWORD *))((char *)&off_24 + a2))(*(_DWORD *)(a2 + 40), a1);
  return 0;
}
// 24: using guessed type void *off_24;

//----- (000031C7) --------------------------------------------------------
int __cdecl sub_31C7(int a1, int a2)
{
  return (*(int (__cdecl **)(_DWORD, int))((char *)&off_24 + a2))(*(_DWORD *)(a2 + 40), a1);
}
// 24: using guessed type void *off_24;

//----- (00003498) --------------------------------------------------------
int __cdecl sub_3498(_DWORD *a1)
{
  _DWORD *v1; // ecx

  if ( !a1 )
    return -2;
  v1 = (_DWORD *)a1[7];
  if ( !v1 )
    return -2;
  a1[5] = 0;
  a1[2] = 0;
  a1[6] = 0;
  *v1 = v1[3] != 0 ? 7 : 0;
  sub_238B(*(_DWORD **)(a1[7] + 20), (int)a1, 0);
  return 0;
}

//----- (000034D7) --------------------------------------------------------
int __cdecl sub_34D7(_DWORD *a1)
{
  int v1; // eax
  _DWORD *v2; // eax

  if ( !a1 )
    return -2;
  v1 = a1[7];
  if ( !v1 || !a1[9] )
    return -2;
  v2 = *(_DWORD **)(v1 + 20);
  if ( v2 )
    sub_2BFB(v2, (int)a1);
  (*(void (__cdecl **)(_DWORD, _DWORD))((char *)&off_24 + (_DWORD)a1))(a1[10], a1[7]);
  a1[7] = 0;
  return 0;
}
// 24: using guessed type void *off_24;

//----- (00003515) --------------------------------------------------------
int __cdecl sub_3515(_DWORD *a1, int a2, _BYTE *a3, int a4)
{
  bool v4; // zf
  int v5; // eax
  int v6; // ecx
  int v7; // edi
  int v10; // [esp-4h] [ebp-10h]

  if ( !a3 || *a3 != 49 || a4 != 56 )
    return -6;
  if ( !a1 )
    return -2;
  v4 = a1[8] == 0;
  a1[6] = 0;
  if ( v4 )
  {
    a1[8] = 268456864;
    a1[10] = 0;
  }
  if ( !a1[9] )
    a1[9] = 268456880;
  v5 = ((int (__cdecl *)(_DWORD, int, int))a1[8])(a1[10], 1, 24);
  a1[7] = v5;
  if ( v5 )
  {
    v6 = a2;
    *(_DWORD *)(v5 + 20) = 0;
    *(_DWORD *)(a1[7] + 12) = 0;
    if ( a2 < 0 )
    {
      v6 = -a2;
      *(_DWORD *)(a1[7] + 12) = 1;
    }
    if ( v6 < 8 || v6 > 15 )
    {
      v10 = -2;
    }
    else
    {
      *(_DWORD *)(a1[7] + 16) = v6;
      *(_DWORD *)(a1[7] + 20) = sub_23F6((int)a1, *(_DWORD *)(a1[7] + 12) == 0 ? 0x10001727 : 0, 1 << v6);
      if ( *(_DWORD *)(a1[7] + 20) )
      {
        sub_3498(a1);
        return 0;
      }
      v10 = -4;
    }
    v7 = v10;
    sub_34D7(a1);
    return v7;
  }
  return -4;
}

//----- (000035FA) --------------------------------------------------------
#error "3637: switch analysis failed: switch information is incomplete or incorrect (funcsize=33)"

//----- (00003961) --------------------------------------------------------
int __usercall sub_3961@<eax>(unsigned int *a1@<eax>, _DWORD *a2, unsigned int a3, unsigned int a4, int a5, int a6, _DWORD *a7, int a8, unsigned int *a9, unsigned int *a10)
{
  _DWORD *v10; // ecx
  unsigned int v12; // edx
  unsigned int v14; // ebx
  unsigned int v15; // ecx
  unsigned int v16; // eax
  int v17; // edx
  int v18; // edx
  int v19; // esi
  int *v20; // ecx
  int v21; // ebx
  int v22; // edx
  int v23; // ecx
  unsigned int v24; // eax
  int v25; // ebx
  int *v26; // ecx
  unsigned int v27; // ebx
  int v28; // eax
  int *v29; // eax
  int v30; // ecx
  int v31; // eax
  int v32; // ebx
  int v33; // eax
  int j; // ecx
  unsigned int v35; // esi
  unsigned int v36; // ecx
  unsigned int v37; // eax
  unsigned int v38; // eax
  int *v39; // edx
  unsigned int v40; // edx
  unsigned int v41; // eax
  unsigned int v42; // eax
  unsigned int v43; // esi
  int *v44; // edx
  unsigned int v45; // esi
  unsigned int v46; // eax
  int v47; // ecx
  int v48; // edx
  unsigned int v49; // eax
  int v50; // eax
  int v51; // esi
  unsigned int v52; // eax
  _DWORD *v53; // ecx
  unsigned int v54; // esi
  unsigned int i; // eax
  int v56; // ecx
  int v57; // eax
  int v59[15]; // [esp+Ch] [ebp-A4h] BYREF
  int v60; // [esp+48h] [ebp-68h] BYREF
  int v61[15]; // [esp+4Ch] [ebp-64h]
  int v62; // [esp+88h] [ebp-28h] BYREF
  int v63[15]; // [esp+8Ch] [ebp-24h]
  int v64; // [esp+C8h] [ebp+18h]
  int v65; // [esp+CCh] [ebp+1Ch]
  int v66; // [esp+D0h] [ebp+20h]
  int v67; // [esp+D4h] [ebp+24h]
  int v68; // [esp+D8h] [ebp+28h]
  int v69; // [esp+DCh] [ebp+2Ch]
  int *v70; // [esp+E0h] [ebp+30h]
  unsigned int v71; // [esp+E4h] [ebp+34h]
  int v72; // [esp+E8h] [ebp+38h]
  int v73; // [esp+ECh] [ebp+3Ch]
  unsigned int v74; // [esp+F0h] [ebp+40h]
  unsigned int v75; // [esp+F4h] [ebp+44h]
  int v76; // [esp+F8h] [ebp+48h]
  int v77; // [esp+FCh] [ebp+4Ch]
  unsigned int v78; // [esp+100h] [ebp+50h]
  int *v79; // [esp+10Ch] [ebp+5Ch]
  unsigned int *v80; // [esp+10Ch] [ebp+5Ch]
  int v81; // [esp+110h] [ebp+60h]

  v10 = a2;
  v62 = 0;
  v63[0] = 0;
  v63[1] = 0;
  v63[2] = 0;
  v63[3] = 0;
  v63[4] = 0;
  v63[5] = 0;
  v63[6] = 0;
  v63[7] = 0;
  v63[8] = 0;
  v63[9] = 0;
  v63[10] = 0;
  v63[11] = 0;
  v63[12] = 0;
  v63[13] = 0;
  v63[14] = 0;
  v12 = a3;
  do
  {
    ++*(&v62 + *v10++);
    --v12;
  }
  while ( v12 );
  if ( v62 != a3 )
  {
    v14 = *a1;
    v78 = *a1;
    v15 = 1;
    v16 = 15;
    do
    {
      if ( *(&v62 + v15) )
        break;
      ++v15;
    }
    while ( v15 <= 0xF );
    v77 = v15;
    if ( v14 < v15 )
      v78 = v15;
    do
    {
      if ( *(&v62 + v16) )
        break;
      --v16;
    }
    while ( v16 );
    v68 = v16;
    if ( v78 > v16 )
      v78 = v16;
    *a1 = v78;
    v17 = 1 << v15;
    while ( v15 < v16 )
    {
      v18 = v17 - *(&v62 + v15);
      if ( v18 < 0 )
        return -3;
      ++v15;
      v17 = 2 * v18;
    }
    v19 = 4 * v16;
    v20 = &v62 + v16;
    v21 = *v20;
    v22 = v17 - *v20;
    v66 = v22;
    if ( v22 >= 0 )
    {
      *v20 = v22 + v21;
      v23 = 0;
      v24 = v16 - 1;
      v61[0] = 0;
      if ( v24 )
      {
        v25 = 0;
        do
        {
          v23 += v63[v25++];
          --v24;
          v61[v25] = v23;
        }
        while ( v24 );
      }
      v26 = a2;
      v27 = 0;
      do
      {
        v28 = *v26++;
        v79 = v26;
        if ( v28 )
        {
          v29 = &v60 + v28;
          v30 = *v29;
          a10[v30] = v27;
          v22 = v66;
          *v29 = v30 + 1;
          v26 = v79;
        }
        ++v27;
      }
      while ( v27 < a3 );
      v31 = *(int *)((char *)&v60 + v19);
      v76 = -1;
      v81 = v31;
      v80 = a10;
      v32 = -v78;
      v71 = 0;
      v60 = 0;
      v59[0] = 0;
      v69 = 0;
      v75 = 0;
      if ( v77 > v68 )
      {
LABEL_68:
        if ( !v22 || v68 == 1 )
          return 0;
        return -5;
      }
      v67 = v77 - 1;
      v70 = &v62 + v77;
      while ( 1 )
      {
        v72 = *v70;
        if ( v72 )
          break;
LABEL_67:
        ++v77;
        ++v70;
        ++v67;
        if ( v77 > v68 )
          goto LABEL_68;
      }
      while ( 1 )
      {
        --v72;
        v33 = v32 + v78;
        if ( v77 > (int)(v32 + v78) )
          break;
LABEL_50:
        BYTE1(v73) = v77 - v32;
        if ( v80 < &a10[v81] )
        {
          v49 = *v80;
          if ( *v80 >= a4 )
          {
            v50 = 4 * (v49 - a4);
            LOBYTE(v73) = *(_BYTE *)(v50 + a6) + 80;
            v49 = *(_DWORD *)(v50 + a5);
          }
          else
          {
            LOBYTE(v73) = v49 < 0x100 ? 0 : 0x60;
          }
          ++v80;
          v74 = v49;
        }
        else
        {
          LOBYTE(v73) = -64;
        }
        v51 = 1 << (v77 - v32);
        v52 = v71 >> v32;
        if ( v71 >> v32 < v75 )
        {
          v53 = (_DWORD *)(v69 + 8 * v52);
          do
          {
            *v53 = v73;
            v53[1] = v74;
            v52 += v51;
            v53 += 2 * v51;
          }
          while ( v52 < v75 );
          v22 = v66;
        }
        v54 = v71;
        for ( i = 1 << v67; (i & v54) != 0; i >>= 1 )
          v54 ^= i;
        v71 = i ^ v54;
        v56 = (i ^ v54) & ((1 << v32) - 1);
        v57 = v76;
        if ( v56 != *(&v60 + v76) )
        {
          do
          {
            v32 -= v78;
            --v57;
          }
          while ( (v71 & ((1 << v32) - 1)) != *(&v60 + v57) );
          v76 = v57;
        }
        if ( !v72 )
          goto LABEL_67;
      }
      for ( j = v32 - v78; ; j = v64 )
      {
        ++v76;
        v32 += v78;
        v35 = v68 - v32;
        v64 = v78 + j;
        v65 = v78 + v33;
        if ( v68 - v32 > v78 )
          v35 = v78;
        v36 = v77 - v32;
        v37 = 1 << (v77 - v32);
        if ( v37 > v72 + 1 )
        {
          v38 = -1 - v72 + v37;
          v39 = v70;
          if ( v36 < v35 && ++v36 < v35 )
          {
            while ( 1 )
            {
              v75 = (unsigned int)(v39 + 1);
              v40 = v39[1];
              v41 = 2 * v38;
              if ( v41 <= v40 )
                break;
              v38 = v41 - v40;
              if ( ++v36 >= v35 )
                break;
              v39 = (int *)v75;
            }
          }
        }
        v42 = *a9;
        v43 = *a9 + (1 << v36);
        v75 = 1 << v36;
        if ( v43 > 0x5A0 )
          break;
        v44 = &v59[v76];
        v69 = a8 + 8 * v42;
        *v44 = v69;
        *a9 = v43;
        if ( v76 )
        {
          v45 = v71;
          *(&v60 + v76) = v71;
          BYTE1(v73) = v78;
          LOBYTE(v73) = v36;
          v46 = v45 >> v64;
          v47 = *(v44 - 1);
          v48 = ((v69 - v47) >> 3) - (v45 >> v64);
          *(_DWORD *)(v47 + 8 * v46) = v73;
          v74 = v48;
          *(_DWORD *)(v47 + 8 * v46 + 4) = v48;
        }
        else
        {
          *a7 = v69;
        }
        v33 = v65;
        if ( v77 <= v65 )
        {
          v22 = v66;
          goto LABEL_50;
        }
      }
    }
    return -3;
  }
  *a7 = 0;
  *a1 = 0;
  return 0;
}

//----- (00003E8F) --------------------------------------------------------
int __cdecl sub_3E8F(_DWORD *a1, _DWORD *a2, int a3)
{
  unsigned int v3; // ecx
  unsigned int v4; // ebx
  unsigned int v6; // eax
  unsigned int v7; // ebx
  int (__cdecl *v8)(_DWORD, unsigned int, unsigned int); // eax
  int v9; // eax
  int v10; // eax
  int v11; // ecx
  unsigned int v12; // eax
  unsigned int v13; // ebx
  int (__cdecl *v14)(_DWORD, int, unsigned int); // eax
  int v15; // eax
  int v17; // [esp+Ch] [ebp-4h]
  int v18; // [esp+Ch] [ebp-4h]
  unsigned int v19; // [esp+1Ch] [ebp+Ch]
  unsigned int v20; // [esp+1Ch] [ebp+Ch]
  int v21; // [esp+1Ch] [ebp+Ch]

  v3 = a1[12];
  v4 = a1[13];
  v17 = a2[3];
  v19 = v3;
  if ( v3 > v4 )
    v4 = a1[11];
  v6 = a2[4];
  v7 = v4 - v3;
  if ( v7 > v6 )
    v7 = a2[4];
  if ( v7 && a3 == -5 )
    a3 = 0;
  a2[5] += v7;
  a2[4] = v6 - v7;
  v8 = (int (__cdecl *)(_DWORD, unsigned int, unsigned int))a1[14];
  if ( v8 )
  {
    v9 = v8(a1[15], v3, v7);
    v3 = v19;
    a1[15] = v9;
    a2[12] = v9;
  }
  sub_5460(v17, v3, v7);
  v20 = v7 + v19;
  v10 = a1[11];
  v18 = v7 + v17;
  if ( v20 == v10 )
  {
    v11 = a1[10];
    v21 = v11;
    if ( a1[13] == v10 )
      a1[13] = v11;
    v12 = a2[4];
    v13 = a1[13] - v11;
    if ( v13 > v12 )
      v13 = a2[4];
    if ( v13 && a3 == -5 )
      a3 = 0;
    a2[5] += v13;
    a2[4] = v12 - v13;
    v14 = (int (__cdecl *)(_DWORD, int, unsigned int))a1[14];
    if ( v14 )
    {
      v15 = v14(a1[15], v11, v13);
      v11 = v21;
      a1[15] = v15;
      a2[12] = v15;
    }
    sub_5460(v18, v11, v13);
    v18 += v13;
    v20 = v13 + v21;
  }
  a2[3] = v18;
  a1[12] = v20;
  return a3;
}
// 5460: using guessed type _DWORD __cdecl sub_5460(_DWORD, _DWORD, _DWORD);

//----- (00003F7B) --------------------------------------------------------
int __usercall sub_3F7B@<eax>(int result@<eax>)
{
  _WORD *v1; // ecx
  int v2; // edx
  _WORD *v3; // ecx
  int v4; // edx
  _WORD *v5; // ecx
  int v6; // edx

  v1 = (_WORD *)(result + 140);
  v2 = 286;
  do
  {
    *v1 = 0;
    v1 += 2;
    --v2;
  }
  while ( v2 );
  v3 = (_WORD *)(result + 2432);
  v4 = 30;
  do
  {
    *v3 = 0;
    v3 += 2;
    --v4;
  }
  while ( v4 );
  v5 = (_WORD *)(result + 2676);
  v6 = 19;
  do
  {
    *v5 = 0;
    v5 += 2;
    --v6;
  }
  while ( v6 );
  *(_DWORD *)(result + 5796) = 0;
  *(_DWORD *)(result + 5792) = 0;
  *(_DWORD *)(result + 5800) = 0;
  *(_DWORD *)(result + 5784) = 0;
  *(_WORD *)(result + 1164) = 1;
  return result;
}

//----- (00003FD9) --------------------------------------------------------
int __usercall sub_3FD9@<eax>(int result@<eax>, int a2@<edi>, int a3)
{
  int v3; // edx
  int v4; // ecx
  bool v5; // cc
  int v6; // esi
  unsigned __int16 v7; // bx
  unsigned __int16 v8; // dx
  int v9; // esi
  unsigned __int16 v10; // dx
  unsigned __int16 v11; // bx
  int v12; // edx
  int v13; // [esp+0h] [ebp-4h]

  v13 = *(_DWORD *)(result + 4 * a3 + 2900);
  v3 = *(_DWORD *)(result + 5192);
  v4 = 2 * a3;
  v5 = 2 * a3 < v3;
  if ( 2 * a3 <= v3 )
  {
    do
    {
      if ( v5 )
      {
        v6 = *(_DWORD *)(result + 4 * v4 + 2904);
        v7 = *(_WORD *)(a2 + 4 * v6);
        v8 = *(_WORD *)(a2 + 4 * *(_DWORD *)(result + 4 * v4 + 2900));
        if ( v7 < v8
          || v7 == v8
          && *(_BYTE *)(v6 + result + 5200) <= *(_BYTE *)(*(_DWORD *)(result + 4 * v4 + 2900) + result + 5200) )
        {
          ++v4;
        }
      }
      v9 = *(_DWORD *)(result + 4 * v4 + 2900);
      v10 = *(_WORD *)(a2 + 4 * v13);
      v11 = *(_WORD *)(a2 + 4 * v9);
      if ( v10 < v11 || v10 == v11 && *(_BYTE *)(v13 + result + 5200) <= *(_BYTE *)(v9 + result + 5200) )
        break;
      *(_DWORD *)(result + 4 * a3 + 2900) = v9;
      v12 = *(_DWORD *)(result + 5192);
      a3 = v4;
      v4 *= 2;
      v5 = v4 < v12;
    }
    while ( v4 <= v12 );
  }
  *(_DWORD *)(result + 4 * a3 + 2900) = v13;
  return result;
}

//----- (00004089) --------------------------------------------------------
int __usercall sub_4089@<eax>(int *a1@<eax>, _DWORD *a2@<edx>)
{
  int v2; // ebx
  int *v3; // eax
  int result; // eax
  int v5; // esi
  int v6; // ecx
  int v7; // edi
  int v8; // ecx
  _WORD *i; // edi
  _DWORD *v10; // esi
  unsigned __int16 *v11; // ecx
  int v12; // esi
  int v13; // [esp+8h] [ebp-28h]
  _DWORD *v14; // [esp+8h] [ebp-28h]
  int v15; // [esp+Ch] [ebp-24h]
  int v16; // [esp+10h] [ebp-20h]
  int v17; // [esp+14h] [ebp-1Ch]
  int v18; // [esp+18h] [ebp-18h]
  int *v19; // [esp+1Ch] [ebp-14h]
  int v20; // [esp+1Ch] [ebp-14h]
  int v21; // [esp+20h] [ebp-10h]
  _WORD *v22; // [esp+20h] [ebp-10h]
  int v23; // [esp+24h] [ebp-Ch]
  int v24; // [esp+28h] [ebp-8h]
  int v25; // [esp+2Ch] [ebp-4h]
  int v26; // [esp+2Ch] [ebp-4h]

  v25 = 0;
  v16 = a1[1];
  v2 = *a1;
  v3 = (int *)a1[2];
  v13 = *v3;
  v15 = v3[1];
  v18 = v3[2];
  v24 = v3[4];
  memset(a2 + 717, 0, 0x20u);
  *(_WORD *)(v2 + 4 * a2[a2[1299] + 725] + 2) = 0;
  result = a2[1299] + 1;
  if ( result < 573 )
  {
    v19 = &a2[result + 725];
    v17 = 573 - result;
    result = 573;
    do
    {
      v5 = *v19;
      v23 = 4 * *v19;
      v6 = *(unsigned __int16 *)(v2 + 4 * *(unsigned __int16 *)(v23 + v2 + 2) + 2) + 1;
      if ( v6 > v24 )
      {
        v6 = v24;
        ++v25;
      }
      *(_WORD *)(v23 + v2 + 2) = v6;
      if ( v5 <= v16 )
      {
        ++*((_WORD *)a2 + v6 + 1434);
        v21 = 0;
        if ( v5 >= v18 )
          v21 = *(_DWORD *)(v15 + 4 * (v5 - v18));
        v7 = *(unsigned __int16 *)(v23 + v2);
        a2[1448] += v7 * (v6 + v21);
        if ( v13 )
          a2[1449] += v7 * (v21 + *(unsigned __int16 *)(v23 + v13 + 2));
      }
      ++v19;
      --v17;
    }
    while ( v17 );
    if ( v25 )
    {
      do
      {
        v8 = v24 - 1;
        for ( i = (_WORD *)a2 + v24 + 1433; !*i; --i )
          --v8;
        --*((_WORD *)a2 + v8 + 1434);
        v25 -= 2;
        *((_WORD *)a2 + v8 + 1435) += 2;
        --*((_WORD *)a2 + v24 + 1434);
      }
      while ( v25 > 0 );
      v26 = v24;
      if ( v24 )
      {
        v22 = (_WORD *)a2 + v24 + 1434;
        do
        {
          v20 = (unsigned __int16)*v22;
          if ( *v22 )
          {
            v10 = &a2[result + 725];
            do
            {
              --v10;
              --result;
              v14 = v10;
              if ( *v10 <= v16 )
              {
                v11 = (unsigned __int16 *)(v2 + 4 * *v10);
                v12 = v11[1];
                if ( v12 != v26 )
                {
                  a2[1448] += *v11 * (v26 - v12);
                  v11[1] = v26;
                }
                --v20;
                v10 = v14;
              }
            }
            while ( v20 );
          }
          --v26;
          --v22;
        }
        while ( v26 );
      }
    }
  }
  return result;
}

//----- (00004241) --------------------------------------------------------
int __usercall sub_4241@<eax>(int result@<eax>, int a2@<ecx>, _WORD *a3)
{
  int v4; // ecx
  int v5; // edx
  int v6; // ebx
  int v7; // edi
  int i; // esi
  int v9; // [esp-4h] [ebp-18h]
  int v10; // [esp+Ch] [ebp-8h]
  unsigned __int16 *v11; // [esp+10h] [ebp-4h]

  v10 = -1;
  v4 = *(unsigned __int16 *)(result + 2);
  v5 = 7;
  v6 = 0;
  v7 = 4;
  if ( !*(_WORD *)(result + 2) )
  {
    v5 = 138;
    v7 = 3;
  }
  *(_WORD *)(result + 4 * a2 + 6) = -1;
  if ( a2 >= 0 )
  {
    v11 = (unsigned __int16 *)(result + 6);
    for ( i = a2 + 1; i; --i )
    {
      result = v4;
      v4 = *v11;
      if ( ++v6 < v5 && result == v4 )
        goto LABEL_23;
      if ( v6 >= v7 )
      {
        if ( result )
        {
          if ( result != v10 )
            ++a3[2 * result + 1338];
          ++a3[1370];
        }
        else if ( v6 > 10 )
        {
          ++a3[1374];
        }
        else
        {
          ++a3[1372];
        }
      }
      else
      {
        a3[2 * result + 1338] += v6;
      }
      v6 = 0;
      v10 = result;
      if ( v4 )
      {
        if ( result != v4 )
        {
          v5 = 7;
          v9 = 4;
          goto LABEL_22;
        }
        v5 = 6;
      }
      else
      {
        v5 = 138;
      }
      v9 = 3;
LABEL_22:
      v7 = v9;
LABEL_23:
      v11 += 2;
    }
  }
  return result;
}

//----- (000042FD) --------------------------------------------------------
int __usercall sub_42FD@<eax>(int result@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v3; // edi
  int v4; // esi
  int v5; // ebx
  int v6; // edx
  int v7; // edi
  int v8; // ecx
  unsigned __int16 v9; // si
  int v10; // edx
  int v11; // ecx
  int v12; // edx
  __int16 v13; // si
  int v14; // ecx
  __int16 v15; // bx
  int v16; // ecx
  int v17; // edi
  int v18; // ecx
  unsigned __int16 v19; // si
  int v20; // edx
  int v21; // ecx
  int v22; // edx
  __int16 v23; // si
  int v24; // ecx
  __int16 v25; // bx
  int v26; // ecx
  int v27; // ecx
  unsigned __int16 v28; // si
  int v29; // edi
  int v30; // ecx
  int v31; // ebx
  int v32; // ecx
  int v33; // esi
  int v34; // edi
  int v35; // ecx
  int v36; // ebx
  __int16 v37; // si
  int v38; // ebx
  int v39; // ecx
  int v40; // ecx
  unsigned __int16 v41; // si
  int v42; // edi
  int v43; // ecx
  int v44; // ebx
  int v45; // ecx
  int v46; // esi
  int v47; // edi
  int v48; // ecx
  int v49; // ebx
  unsigned __int16 v50; // si
  int v51; // edi
  int v52; // ecx
  int v53; // ebx
  int v54; // ecx
  int v55; // esi
  int v56; // edi
  int v57; // ecx
  int v58; // ebx
  int v59; // [esp-4h] [ebp-28h]
  int i; // [esp+Ch] [ebp-18h]
  int v61; // [esp+10h] [ebp-14h]
  int v62; // [esp+14h] [ebp-10h]
  int v63; // [esp+14h] [ebp-10h]
  int v64; // [esp+14h] [ebp-10h]
  int v65; // [esp+14h] [ebp-10h]
  unsigned __int16 *v66; // [esp+18h] [ebp-Ch]
  int v67; // [esp+1Ch] [ebp-8h]
  int v68; // [esp+20h] [ebp-4h]

  v61 = -1;
  v67 = *(unsigned __int16 *)(a3 + 2);
  v3 = 7;
  v4 = 0;
  v5 = 4;
  if ( !*(_WORD *)(a3 + 2) )
  {
    v3 = 138;
    v5 = 3;
  }
  if ( a2 >= 0 )
  {
    v66 = (unsigned __int16 *)(a3 + 6);
    for ( i = a2 + 1; i; --i )
    {
      v6 = v67;
      ++v4;
      v62 = v67;
      v67 = *v66;
      v68 = v4;
      if ( v4 < v3 && v6 == *v66 )
        goto LABEL_47;
      if ( v4 >= v5 )
      {
        if ( v6 )
        {
          if ( v6 != v61 )
          {
            v17 = *(unsigned __int16 *)(result + 4 * v6 + 2678);
            v18 = *(_DWORD *)(result + 5812);
            if ( v18 <= 16 - v17 )
            {
              v25 = *(_WORD *)(result + 4 * v6 + 2676) << v18;
              v26 = *(_DWORD *)(result + 5812);
              *(_WORD *)(result + 5808) |= v25;
              v24 = v17 + v26;
            }
            else
            {
              v19 = *(_WORD *)(result + 4 * v6 + 2676);
              v20 = v19 << v18;
              v21 = *(_DWORD *)(result + 8);
              *(_WORD *)(result + 5808) |= v20;
              *(_BYTE *)(v21 + (*(_DWORD *)(result + 20))++) = *(_BYTE *)(result + 5808);
              *(_BYTE *)(*(_DWORD *)(result + 20) + *(_DWORD *)(result + 8)) = *(_BYTE *)(result + 5809);
              v22 = *(_DWORD *)(result + 5812);
              ++*(_DWORD *)(result + 20);
              v23 = v19 >> (16 - v22);
              v24 = v22 + v17 - 16;
              v6 = v62;
              *(_WORD *)(result + 5808) = v23;
              v4 = v68;
            }
            --v4;
            *(_DWORD *)(result + 5812) = v24;
            v68 = v4;
          }
          v27 = *(_DWORD *)(result + 5812);
          v63 = *(unsigned __int16 *)(result + 2742);
          if ( v27 <= 16 - v63 )
          {
            *(_WORD *)(result + 5808) |= *(_WORD *)(result + 2740) << v27;
            v32 = v63 + v27;
          }
          else
          {
            v28 = *(_WORD *)(result + 2740);
            v29 = v28 << v27;
            v30 = *(_DWORD *)(result + 8);
            *(_WORD *)(result + 5808) |= v29;
            *(_BYTE *)(v30 + (*(_DWORD *)(result + 20))++) = *(_BYTE *)(result + 5808);
            *(_BYTE *)(*(_DWORD *)(result + 20) + *(_DWORD *)(result + 8)) = *(_BYTE *)(result + 5809);
            v31 = *(_DWORD *)(result + 5812);
            ++*(_DWORD *)(result + 20);
            v32 = v31 + v63 - 16;
            *(_WORD *)(result + 5808) = v28 >> (16 - v31);
            v4 = v68;
          }
          v33 = v4 - 3;
          *(_DWORD *)(result + 5812) = v32;
          if ( v32 > 14 )
          {
            v34 = v33 << v32;
            v35 = *(_DWORD *)(result + 8);
            *(_WORD *)(result + 5808) |= v34;
            *(_BYTE *)(v35 + (*(_DWORD *)(result + 20))++) = *(_BYTE *)(result + 5808);
            *(_BYTE *)(*(_DWORD *)(result + 20) + *(_DWORD *)(result + 8)) = *(_BYTE *)(result + 5809);
            v36 = *(_DWORD *)(result + 5812);
            ++*(_DWORD *)(result + 20);
            v37 = (unsigned __int16)v33 >> (16 - v36);
            v38 = v36 - 14;
LABEL_31:
            *(_WORD *)(result + 5808) = v37;
            *(_DWORD *)(result + 5812) = v38;
            goto LABEL_40;
          }
          *(_WORD *)(result + 5808) |= v33 << v32;
          v39 = v32 + 2;
        }
        else
        {
          v40 = *(_DWORD *)(result + 5812);
          if ( v4 > 10 )
          {
            v65 = *(unsigned __int16 *)(result + 2750);
            if ( v40 <= 16 - v65 )
            {
              *(_WORD *)(result + 5808) |= *(_WORD *)(result + 2748) << v40;
              v54 = v65 + v40;
            }
            else
            {
              v50 = *(_WORD *)(result + 2748);
              v51 = v50 << v40;
              v52 = *(_DWORD *)(result + 8);
              *(_WORD *)(result + 5808) |= v51;
              *(_BYTE *)(v52 + (*(_DWORD *)(result + 20))++) = *(_BYTE *)(result + 5808);
              *(_BYTE *)(*(_DWORD *)(result + 20) + *(_DWORD *)(result + 8)) = *(_BYTE *)(result + 5809);
              v53 = *(_DWORD *)(result + 5812);
              ++*(_DWORD *)(result + 20);
              v54 = v53 + v65 - 16;
              *(_WORD *)(result + 5808) = v50 >> (16 - v53);
              v4 = v68;
            }
            v55 = v4 - 11;
            *(_DWORD *)(result + 5812) = v54;
            if ( v54 > 9 )
            {
              v56 = v55 << v54;
              v57 = *(_DWORD *)(result + 8);
              *(_WORD *)(result + 5808) |= v56;
              *(_BYTE *)(v57 + (*(_DWORD *)(result + 20))++) = *(_BYTE *)(result + 5808);
              *(_BYTE *)(*(_DWORD *)(result + 20) + *(_DWORD *)(result + 8)) = *(_BYTE *)(result + 5809);
              v58 = *(_DWORD *)(result + 5812);
              ++*(_DWORD *)(result + 20);
              v37 = (unsigned __int16)v55 >> (16 - v58);
              v38 = v58 - 9;
              goto LABEL_31;
            }
            *(_WORD *)(result + 5808) |= v55 << v54;
            v39 = v54 + 7;
          }
          else
          {
            v64 = *(unsigned __int16 *)(result + 2746);
            if ( v40 <= 16 - v64 )
            {
              *(_WORD *)(result + 5808) |= *(_WORD *)(result + 2744) << v40;
              v45 = v64 + v40;
            }
            else
            {
              v41 = *(_WORD *)(result + 2744);
              v42 = v41 << v40;
              v43 = *(_DWORD *)(result + 8);
              *(_WORD *)(result + 5808) |= v42;
              *(_BYTE *)(v43 + (*(_DWORD *)(result + 20))++) = *(_BYTE *)(result + 5808);
              *(_BYTE *)(*(_DWORD *)(result + 20) + *(_DWORD *)(result + 8)) = *(_BYTE *)(result + 5809);
              v44 = *(_DWORD *)(result + 5812);
              ++*(_DWORD *)(result + 20);
              v45 = v44 + v64 - 16;
              *(_WORD *)(result + 5808) = v41 >> (16 - v44);
              v4 = v68;
            }
            v46 = v4 - 3;
            *(_DWORD *)(result + 5812) = v45;
            if ( v45 > 13 )
            {
              v47 = v46 << v45;
              v48 = *(_DWORD *)(result + 8);
              *(_WORD *)(result + 5808) |= v47;
              *(_BYTE *)(v48 + (*(_DWORD *)(result + 20))++) = *(_BYTE *)(result + 5808);
              *(_BYTE *)(*(_DWORD *)(result + 20) + *(_DWORD *)(result + 8)) = *(_BYTE *)(result + 5809);
              v49 = *(_DWORD *)(result + 5812);
              ++*(_DWORD *)(result + 20);
              v37 = (unsigned __int16)v46 >> (16 - v49);
              v38 = v49 - 13;
              goto LABEL_31;
            }
            *(_WORD *)(result + 5808) |= v46 << v45;
            v39 = v45 + 3;
          }
        }
        *(_DWORD *)(result + 5812) = v39;
      }
      else
      {
        do
        {
          v7 = *(unsigned __int16 *)(result + 4 * v6 + 2678);
          v8 = *(_DWORD *)(result + 5812);
          if ( v8 <= 16 - v7 )
          {
            v15 = *(_WORD *)(result + 4 * v6 + 2676) << v8;
            v16 = *(_DWORD *)(result + 5812);
            *(_WORD *)(result + 5808) |= v15;
            v14 = v7 + v16;
          }
          else
          {
            v9 = *(_WORD *)(result + 4 * v6 + 2676);
            v10 = v9 << v8;
            v11 = *(_DWORD *)(result + 8);
            *(_WORD *)(result + 5808) |= v10;
            *(_BYTE *)(v11 + (*(_DWORD *)(result + 20))++) = *(_BYTE *)(result + 5808);
            *(_BYTE *)(*(_DWORD *)(result + 20) + *(_DWORD *)(result + 8)) = *(_BYTE *)(result + 5809);
            v12 = *(_DWORD *)(result + 5812);
            ++*(_DWORD *)(result + 20);
            v13 = v9 >> (16 - v12);
            v14 = v12 + v7 - 16;
            v6 = v62;
            *(_WORD *)(result + 5808) = v13;
            v4 = v68;
          }
          --v4;
          *(_DWORD *)(result + 5812) = v14;
          v68 = v4;
        }
        while ( v4 );
      }
LABEL_40:
      v4 = 0;
      v61 = v6;
      if ( v67 )
      {
        if ( v6 != v67 )
        {
          v3 = 7;
          v59 = 4;
          goto LABEL_46;
        }
        v3 = 6;
      }
      else
      {
        v3 = 138;
      }
      v59 = 3;
LABEL_46:
      v5 = v59;
LABEL_47:
      v66 += 2;
    }
  }
  return result;
}

//----- (0000479A) --------------------------------------------------------
int __usercall sub_479A@<eax>(int a1@<eax>, int a2, int a3, int a4)
{
  int v4; // ecx
  int v5; // ebx
  int v6; // edx
  int v7; // ecx
  int v8; // edx
  int v9; // ecx
  int v10; // edx
  int v11; // ecx
  int v12; // edx
  int v13; // ecx
  int v14; // edx
  int v15; // ecx
  int v16; // edx
  int i; // edi
  int v18; // ecx
  int v19; // edx
  unsigned __int16 v20; // si
  int v21; // edx
  int v22; // ecx
  int v23; // edx
  int v24; // eax

  v4 = *(_DWORD *)(a1 + 5812);
  v5 = a4;
  if ( v4 <= 11 )
  {
    *(_WORD *)(a1 + 5808) |= (a2 - 257) << v4;
    *(_DWORD *)(a1 + 5812) = v4 + 5;
  }
  else
  {
    v6 = (a2 - 257) << v4;
    v7 = *(_DWORD *)(a1 + 20);
    *(_WORD *)(a1 + 5808) |= v6;
    *(_BYTE *)(v7 + *(_DWORD *)(a1 + 8)) = *(_BYTE *)(a1 + 5808);
    *(_BYTE *)(++*(_DWORD *)(a1 + 20) + *(_DWORD *)(a1 + 8)) = *(_BYTE *)(a1 + 5809);
    v8 = *(_DWORD *)(a1 + 5812);
    ++*(_DWORD *)(a1 + 20);
    v5 = a4;
    *(_DWORD *)(a1 + 5812) = v8 - 11;
    *(_WORD *)(a1 + 5808) = (unsigned __int16)(a2 - 257) >> (16 - v8);
  }
  v9 = *(_DWORD *)(a1 + 5812);
  if ( v9 <= 11 )
  {
    *(_WORD *)(a1 + 5808) |= (a3 - 1) << v9;
    *(_DWORD *)(a1 + 5812) = v9 + 5;
  }
  else
  {
    v10 = (a3 - 1) << v9;
    v11 = *(_DWORD *)(a1 + 20);
    *(_WORD *)(a1 + 5808) |= v10;
    *(_BYTE *)(v11 + *(_DWORD *)(a1 + 8)) = *(_BYTE *)(a1 + 5808);
    *(_BYTE *)(++*(_DWORD *)(a1 + 20) + *(_DWORD *)(a1 + 8)) = *(_BYTE *)(a1 + 5809);
    v12 = *(_DWORD *)(a1 + 5812);
    ++*(_DWORD *)(a1 + 20);
    *(_DWORD *)(a1 + 5812) = v12 - 11;
    *(_WORD *)(a1 + 5808) = (unsigned __int16)(a3 - 1) >> (16 - v12);
  }
  v13 = *(_DWORD *)(a1 + 5812);
  if ( v13 <= 12 )
  {
    *(_WORD *)(a1 + 5808) |= (v5 - 4) << v13;
    *(_DWORD *)(a1 + 5812) = v13 + 4;
  }
  else
  {
    v14 = (v5 - 4) << v13;
    v15 = *(_DWORD *)(a1 + 20);
    *(_WORD *)(a1 + 5808) |= v14;
    *(_BYTE *)(v15 + *(_DWORD *)(a1 + 8)) = *(_BYTE *)(a1 + 5808);
    *(_BYTE *)(++*(_DWORD *)(a1 + 20) + *(_DWORD *)(a1 + 8)) = *(_BYTE *)(a1 + 5809);
    v16 = *(_DWORD *)(a1 + 5812);
    ++*(_DWORD *)(a1 + 20);
    *(_DWORD *)(a1 + 5812) = v16 - 12;
    *(_WORD *)(a1 + 5808) = (unsigned __int16)(v5 - 4) >> (16 - v16);
  }
  for ( i = 0; i < v5; ++i )
  {
    v18 = *(_DWORD *)(a1 + 5812);
    v19 = *(unsigned __int8 *)(i + 268483484);
    if ( v18 <= 13 )
    {
      *(_WORD *)(a1 + 5808) |= *(_WORD *)(a1 + 4 * v19 + 2678) << v18;
      *(_DWORD *)(a1 + 5812) = v18 + 3;
    }
    else
    {
      v20 = *(_WORD *)(a1 + 4 * v19 + 2678);
      v21 = v20 << v18;
      v22 = *(_DWORD *)(a1 + 20);
      *(_WORD *)(a1 + 5808) |= v21;
      *(_BYTE *)(v22 + *(_DWORD *)(a1 + 8)) = *(_BYTE *)(a1 + 5808);
      *(_BYTE *)(++*(_DWORD *)(a1 + 20) + *(_DWORD *)(a1 + 8)) = *(_BYTE *)(a1 + 5809);
      v23 = *(_DWORD *)(a1 + 5812);
      ++*(_DWORD *)(a1 + 20);
      v5 = a4;
      *(_DWORD *)(a1 + 5812) = v23 - 13;
      *(_WORD *)(a1 + 5808) = v20 >> (16 - v23);
    }
  }
  v24 = sub_42FD(a1, a2 - 1, a1 + 140);
  return sub_42FD(v24, a3 - 1, v24 + 2432);
}

//----- (000049D3) --------------------------------------------------------
int __usercall sub_49D3@<eax>(int result@<eax>, int a2, int a3)
{
  int v3; // ebx
  unsigned int v4; // ecx
  int v5; // edi
  int v6; // esi
  int v7; // ecx
  unsigned __int16 *v8; // esi
  int v9; // edi
  int v10; // esi
  int v11; // edx
  int v12; // ecx
  int v13; // edx
  int v14; // ecx
  int v15; // edx
  int v16; // ecx
  int v17; // ebx
  int v18; // ecx
  unsigned __int16 v19; // di
  int v20; // edx
  int v21; // ecx
  int v22; // edx
  int v23; // ecx
  int v24; // ecx
  int v25; // esi
  int v26; // ecx
  int v27; // edx
  int v28; // ecx
  int v29; // edx
  int v30; // ecx
  unsigned int v31; // edi
  int v32; // ecx
  int v33; // esi
  unsigned __int16 *v34; // edx
  int v35; // ecx
  unsigned __int16 v36; // si
  int v37; // edx
  int v38; // ecx
  int v39; // edx
  int v40; // ecx
  int v41; // edx
  unsigned int v42; // edi
  unsigned int v43; // edx
  int v44; // ecx
  int v45; // edx
  int v46; // edx
  int v47; // ecx
  unsigned __int16 v48; // si
  int v49; // edx
  int v50; // ecx
  int v51; // edx
  int v52; // ecx
  unsigned int v53; // [esp+Ch] [ebp-10h]
  int v54; // [esp+10h] [ebp-Ch]
  int v55; // [esp+14h] [ebp-8h]
  int v56; // [esp+14h] [ebp-8h]
  int v57; // [esp+18h] [ebp-4h]
  int v58; // [esp+18h] [ebp-4h]
  int v59; // [esp+18h] [ebp-4h]
  int v60; // [esp+18h] [ebp-4h]
  int v61; // [esp+24h] [ebp+8h]

  v3 = a2;
  v4 = 0;
  if ( *(_DWORD *)(result + 5784) )
  {
    do
    {
      v5 = *(unsigned __int16 *)(*(_DWORD *)(result + 5788) + 2 * v4);
      v6 = *(unsigned __int8 *)(v4 + *(_DWORD *)(result + 5776));
      v54 = v5;
      v53 = v4 + 1;
      if ( *(_WORD *)(*(_DWORD *)(result + 5788) + 2 * v4) )
      {
        v15 = *(unsigned __int8 *)(*(unsigned __int8 *)(v4 + *(_DWORD *)(result + 5776)) + 0x1000C2A8);
        v57 = 4 * v15;
        v16 = *(unsigned __int16 *)(4 * v15 + v3 + 1030);
        v17 = 16 - v16;
        v55 = v16;
        v18 = *(_DWORD *)(result + 5812);
        if ( v18 <= v17 )
        {
          *(_WORD *)(result + 5808) |= *(_WORD *)(a2 + 4 * v15 + 1028) << v18;
          v23 = v55 + v18;
        }
        else
        {
          v19 = *(_WORD *)(a2 + 4 * v15 + 1028);
          v20 = v19 << v18;
          v21 = *(_DWORD *)(result + 8);
          *(_WORD *)(result + 5808) |= v20;
          *(_BYTE *)(v21 + (*(_DWORD *)(result + 20))++) = *(_BYTE *)(result + 5808);
          *(_BYTE *)(*(_DWORD *)(result + 20) + *(_DWORD *)(result + 8)) = *(_BYTE *)(result + 5809);
          v22 = *(_DWORD *)(result + 5812);
          ++*(_DWORD *)(result + 20);
          v23 = v22 + v55 - 16;
          *(_WORD *)(result + 5808) = v19 >> (16 - v22);
          v5 = v54;
        }
        *(_DWORD *)(result + 5812) = v23;
        v24 = v57;
        v58 = *(_DWORD *)(v57 + 268483168);
        if ( v58 )
        {
          v25 = v6 - *(_DWORD *)(v24 + 268485544);
          v26 = *(_DWORD *)(result + 5812);
          if ( v26 <= 16 - v58 )
          {
            *(_WORD *)(result + 5808) |= v25 << v26;
            v30 = v58 + v26;
          }
          else
          {
            v27 = v25 << v26;
            v28 = *(_DWORD *)(result + 8);
            *(_WORD *)(result + 5808) |= v27;
            *(_BYTE *)(v28 + (*(_DWORD *)(result + 20))++) = *(_BYTE *)(result + 5808);
            *(_BYTE *)(*(_DWORD *)(result + 20) + *(_DWORD *)(result + 8)) = *(_BYTE *)(result + 5809);
            v29 = *(_DWORD *)(result + 5812);
            ++*(_DWORD *)(result + 20);
            v30 = v29 + v58 - 16;
            *(_WORD *)(result + 5808) = (unsigned __int16)v25 >> (16 - v29);
          }
          *(_DWORD *)(result + 5812) = v30;
        }
        v31 = v5 - 1;
        if ( v31 >= 0x100 )
          v32 = *(unsigned __int8 *)((v31 >> 7) + 0x1000C1A8);
        else
          v32 = *(unsigned __int8 *)(v31 + 268484776);
        v33 = 4 * v32;
        v34 = (unsigned __int16 *)(4 * v32 + a3);
        v56 = v34[1];
        v35 = *(_DWORD *)(result + 5812);
        v59 = v33;
        if ( v35 <= 16 - v56 )
        {
          *(_WORD *)(result + 5808) |= *v34 << v35;
          v40 = v56 + v35;
        }
        else
        {
          v36 = *v34;
          v37 = *v34 << v35;
          v38 = *(_DWORD *)(result + 8);
          *(_WORD *)(result + 5808) |= v37;
          *(_BYTE *)(v38 + (*(_DWORD *)(result + 20))++) = *(_BYTE *)(result + 5808);
          *(_BYTE *)(*(_DWORD *)(result + 20) + *(_DWORD *)(result + 8)) = *(_BYTE *)(result + 5809);
          v39 = *(_DWORD *)(result + 5812);
          ++*(_DWORD *)(result + 20);
          v40 = v39 + v56 - 16;
          *(_WORD *)(result + 5808) = v36 >> (16 - v39);
          v33 = v59;
        }
        v3 = a2;
        *(_DWORD *)(result + 5812) = v40;
        v41 = *(_DWORD *)(v33 + 268483288);
        v60 = v41;
        if ( !v41 )
          goto LABEL_25;
        v42 = v31 - *(_DWORD *)(v33 + 268485664);
        if ( v40 <= 16 - v41 )
        {
          *(_WORD *)(result + 5808) |= v42 << v40;
          v14 = v41 + v40;
        }
        else
        {
          v43 = v42 << v40;
          v44 = *(_DWORD *)(result + 8);
          *(_WORD *)(result + 5808) |= v43;
          *(_BYTE *)(v44 + (*(_DWORD *)(result + 20))++) = *(_BYTE *)(result + 5808);
          *(_BYTE *)(*(_DWORD *)(result + 20) + *(_DWORD *)(result + 8)) = *(_BYTE *)(result + 5809);
          v45 = *(_DWORD *)(result + 5812);
          ++*(_DWORD *)(result + 20);
          v14 = v45 + v60 - 16;
          *(_WORD *)(result + 5808) = (unsigned __int16)v42 >> (16 - v45);
        }
      }
      else
      {
        v7 = *(_DWORD *)(result + 5812);
        v8 = (unsigned __int16 *)(v3 + 4 * v6);
        v9 = v8[1];
        if ( v7 <= 16 - v9 )
        {
          *(_WORD *)(result + 5808) |= *v8 << v7;
          v14 = v9 + v7;
        }
        else
        {
          v10 = *v8;
          v11 = v10 << v7;
          v12 = *(_DWORD *)(result + 8);
          *(_WORD *)(result + 5808) |= v11;
          *(_BYTE *)(v12 + (*(_DWORD *)(result + 20))++) = *(_BYTE *)(result + 5808);
          *(_BYTE *)(*(_DWORD *)(result + 20) + *(_DWORD *)(result + 8)) = *(_BYTE *)(result + 5809);
          v13 = *(_DWORD *)(result + 5812);
          ++*(_DWORD *)(result + 20);
          v3 = a2;
          v14 = v13 + v9 - 16;
          *(_WORD *)(result + 5808) = (unsigned __int16)v10 >> (16 - v13);
        }
      }
      *(_DWORD *)(result + 5812) = v14;
LABEL_25:
      v4 = v53;
    }
    while ( v53 < *(_DWORD *)(result + 5784) );
  }
  v46 = *(unsigned __int16 *)(v3 + 1026);
  v47 = *(_DWORD *)(result + 5812);
  v61 = v46;
  if ( v47 <= 16 - v46 )
  {
    *(_WORD *)(result + 5808) |= *(_WORD *)(v3 + 1024) << v47;
    v52 = v46 + v47;
  }
  else
  {
    v48 = *(_WORD *)(v3 + 1024);
    v49 = v48 << v47;
    v50 = *(_DWORD *)(result + 8);
    *(_WORD *)(result + 5808) |= v49;
    *(_BYTE *)(v50 + (*(_DWORD *)(result + 20))++) = *(_BYTE *)(result + 5808);
    *(_BYTE *)(*(_DWORD *)(result + 20) + *(_DWORD *)(result + 8)) = *(_BYTE *)(result + 5809);
    v51 = *(_DWORD *)(result + 5812);
    ++*(_DWORD *)(result + 20);
    v52 = v51 + v61 - 16;
    *(_WORD *)(result + 5808) = v48 >> (16 - v51);
  }
  *(_DWORD *)(result + 5812) = v52;
  *(_DWORD *)(result + 5804) = *(unsigned __int16 *)(v3 + 1026);
  return result;
}

//----- (00004D85) --------------------------------------------------------
bool __thiscall sub_4D85(unsigned __int16 *this)
{
  unsigned int v1; // edx
  unsigned int v2; // edi
  unsigned __int16 *v3; // eax
  int v4; // esi
  unsigned __int16 *v5; // eax
  int v6; // esi
  unsigned __int16 *v7; // eax
  int v8; // esi
  bool result; // al

  v1 = 0;
  v2 = 0;
  v3 = this + 70;
  v4 = 7;
  do
  {
    v2 += *v3;
    v3 += 2;
    --v4;
  }
  while ( v4 );
  v5 = this + 84;
  v6 = 121;
  do
  {
    v1 += *v5;
    v5 += 2;
    --v6;
  }
  while ( v6 );
  v7 = this + 326;
  v8 = 128;
  do
  {
    v2 += *v7;
    v7 += 2;
    --v8;
  }
  while ( v8 );
  result = v1 >> 2 >= v2;
  *((_BYTE *)this + 28) = result;
  return result;
}

//----- (00004DDA) --------------------------------------------------------
int __usercall sub_4DDA@<eax>(int result@<eax>)
{
  int v1; // ecx

  v1 = *(_DWORD *)(result + 5812);
  if ( v1 > 8 )
  {
    *(_BYTE *)(*(_DWORD *)(result + 8) + (*(_DWORD *)(result + 20))++) = *(_BYTE *)(result + 5808);
    *(_BYTE *)(*(_DWORD *)(result + 20) + *(_DWORD *)(result + 8)) = *(_BYTE *)(result + 5809);
LABEL_5:
    ++*(_DWORD *)(result + 20);
    goto LABEL_6;
  }
  if ( v1 > 0 )
  {
    *(_BYTE *)(*(_DWORD *)(result + 8) + *(_DWORD *)(result + 20)) = *(_BYTE *)(result + 5808);
    goto LABEL_5;
  }
LABEL_6:
  *(_WORD *)(result + 5808) = 0;
  *(_DWORD *)(result + 5812) = 0;
  return result;
}

//----- (00004E31) --------------------------------------------------------
_DWORD *__usercall sub_4E31@<eax>(int a1@<eax>, _BYTE *a2@<edx>, int a3@<ecx>, int a4)
{
  _DWORD *result; // eax
  int v7; // [esp+10h] [ebp+8h]

  result = (_DWORD *)sub_4DDA(a1);
  result[1451] = 8;
  if ( a4 )
  {
    *(_BYTE *)(result[5] + result[2]) = a3;
    *(_BYTE *)(++result[5] + result[2]) = BYTE1(a3);
    *(_BYTE *)(++result[5] + result[2]) = ~(_BYTE)a3;
    *(_BYTE *)(++result[5] + result[2]) = (unsigned __int16)~(_WORD)a3 >> 8;
    ++result[5];
  }
  if ( a3 )
  {
    do
    {
      v7 = a3;
      *(_BYTE *)(result[5] + result[2]) = *a2;
      ++result[5];
      ++a2;
      --a3;
    }
    while ( v7 != 1 );
  }
  return result;
}

//----- (00004EA9) --------------------------------------------------------
int __usercall sub_4EA9@<eax>(int a1@<edx>, int a2@<ebx>, int a3)
{
  int v3; // edi
  int result; // eax
  int v5; // ecx
  int v6; // edx
  int v7; // esi
  int v8; // edx
  __int16 *v9; // eax
  unsigned int v10; // esi
  unsigned int v11; // eax
  int v12; // ecx
  __int16 v13; // [esp+8h] [ebp-24h] BYREF
  char v14; // [esp+Ah] [ebp-22h] BYREF
  int v15; // [esp+28h] [ebp-4h]

  v15 = MEMORY[0x1000F368];
  v3 = 0;
  LOWORD(result) = 0;
  v5 = 1;
  v6 = a1 - (_DWORD)&v14;
  do
  {
    v7 = *(unsigned __int16 *)((char *)&v13 + 2 * v5 + v6);
    LOWORD(v7) = result + v7;
    result = 2 * v7;
    *(&v13 + v5++) = 2 * v7;
  }
  while ( v5 <= 15 );
  if ( a3 >= 0 )
  {
    do
    {
      v8 = *(unsigned __int16 *)(a2 + 4 * v3 + 2);
      if ( *(_WORD *)(a2 + 4 * v3 + 2) )
      {
        v9 = &v13 + v8;
        v10 = (unsigned __int16)(*v9)++;
        v11 = 0;
        do
        {
          v12 = v10 & 1;
          v10 >>= 1;
          v11 = 2 * (v12 | v11);
          --v8;
        }
        while ( v8 > 0 );
        result = v11 >> 1;
        *(_WORD *)(a2 + 4 * v3) = result;
      }
      ++v3;
    }
    while ( v3 <= a3 );
  }
  return result;
}

//----- (00004F27) --------------------------------------------------------
int __usercall sub_4F27@<eax>(_DWORD *a1@<esi>, int *a2)
{
  int *v2; // eax
  int v3; // ecx
  int v4; // ebx
  int v5; // eax
  int v6; // edi
  int v7; // eax
  int i; // ebx
  int v9; // eax
  int v10; // ecx
  int v11; // ebx
  int v12; // eax
  unsigned __int8 v13; // bl
  unsigned __int8 v14; // al
  _WORD *v16; // [esp+8h] [ebp-14h]
  _WORD *v17; // [esp+Ch] [ebp-10h]
  int v18; // [esp+10h] [ebp-Ch]
  int v19; // [esp+14h] [ebp-8h]
  int v20; // [esp+18h] [ebp-4h]

  v2 = (int *)a2[2];
  v3 = v2[3];
  v19 = -1;
  v4 = *v2;
  v5 = 0;
  v6 = *a2;
  v20 = v3;
  a1[1298] = 0;
  for ( a1[1299] = 573; v5 < v3; ++v5 )
  {
    if ( *(_WORD *)(v6 + 4 * v5) )
    {
      a1[++a1[1298] + 725] = v5;
      v19 = v5;
      *((_BYTE *)a1 + v5 + 5200) = 0;
    }
    else
    {
      *(_WORD *)(v6 + 4 * v5 + 2) = 0;
    }
  }
  while ( (int)a1[1298] < 2 )
  {
    if ( v19 >= 2 )
      v7 = 0;
    else
      v7 = ++v19;
    a1[++a1[1298] + 725] = v7;
    *(_WORD *)(4 * v7 + v6) = 1;
    *((_BYTE *)a1 + v7 + 5200) = 0;
    --a1[1448];
    if ( v4 )
      a1[1449] -= *(unsigned __int16 *)(4 * v7 + v4 + 2);
  }
  a2[1] = v19;
  for ( i = a1[1298] / 2; i >= 1; --i )
    sub_3FD9((int)a1, v6, i);
  v18 = v20;
  do
  {
    v9 = a1[1298];
    v10 = a1[v9 + 725];
    v11 = a1[726];
    a1[1298] = v9 - 1;
    a1[726] = v10;
    sub_3FD9((int)a1, v6, 1);
    --a1[1299];
    v12 = a1[726];
    a1[a1[1299]-- + 725] = v11;
    a1[a1[1299] + 725] = v12;
    v17 = (_WORD *)(v6 + 4 * v12);
    v16 = (_WORD *)(v6 + 4 * v11);
    *(_WORD *)(v6 + 4 * v18) = *v16 + *v17;
    v13 = *((_BYTE *)a1 + v11 + 5200);
    v14 = *((_BYTE *)a1 + v12 + 5200);
    if ( v13 >= v14 )
      v14 = v13;
    *((_BYTE *)a1 + v18 + 5200) = v14 + 1;
    v17[1] = v18;
    v16[1] = v18;
    a1[726] = v18++;
    sub_3FD9((int)a1, v6, 1);
  }
  while ( (int)a1[1298] >= 2 );
  a1[--a1[1299] + 725] = a1[726];
  sub_4089(a2, a1);
  return sub_4EA9((int)(a1 + 717), v6, v19);
}

//----- (0000510C) --------------------------------------------------------
int __usercall sub_510C@<eax>(int a1@<eax>)
{
  int result; // eax

  sub_4241(a1 + 140, *(_DWORD *)(a1 + 2836), (_WORD *)a1);
  sub_4241(a1 + 2432, *(_DWORD *)(a1 + 2848), (_WORD *)a1);
  sub_4F27((_DWORD *)a1, (int *)(a1 + 2856));
  for ( result = 18; result >= 3; --result )
  {
    if ( *(_WORD *)(a1 + 4 * *(unsigned __int8 *)(result + 268483484) + 2678) )
      break;
  }
  *(_DWORD *)(a1 + 5792) += 3 * result + 17;
  return result;
}

//----- (00005169) --------------------------------------------------------
_DWORD *__cdecl sub_5169(int a1, _BYTE *a2, int a3, int a4)
{
  int v4; // ecx
  int v5; // edx
  int v6; // ecx
  int v7; // edx

  v4 = *(_DWORD *)(a1 + 5812);
  if ( v4 <= 13 )
  {
    *(_WORD *)(a1 + 5808) |= a4 << v4;
    *(_DWORD *)(a1 + 5812) = v4 + 3;
  }
  else
  {
    v5 = a4 << v4;
    v6 = *(_DWORD *)(a1 + 8);
    *(_WORD *)(a1 + 5808) |= v5;
    *(_BYTE *)(v6 + (*(_DWORD *)(a1 + 20))++) = *(_BYTE *)(a1 + 5808);
    *(_BYTE *)(*(_DWORD *)(a1 + 20) + *(_DWORD *)(a1 + 8)) = *(_BYTE *)(a1 + 5809);
    v7 = *(_DWORD *)(a1 + 5812);
    ++*(_DWORD *)(a1 + 20);
    *(_DWORD *)(a1 + 5812) = v7 - 13;
    *(_WORD *)(a1 + 5808) = (unsigned __int16)a4 >> (16 - v7);
  }
  return sub_4E31(a1, a2, a3, 1);
}

//----- (000053E0) --------------------------------------------------------
void __usercall sub_53E0(int a1@<ebp>)
{
  int v1; // esi
  _DWORD *v2; // eax

  sub_7154(268485896, 12);
  v1 = *(_DWORD *)(a1 + 8);
  if ( v1 )
  {
    if ( MEMORY[0x100105C0] != 3 )
      goto LABEL_6;
    sub_6600(4);
    *(_DWORD *)(a1 - 4) = 0;
    v2 = (_DWORD *)sub_6679(v1);
    *(_DWORD *)(a1 - 28) = v2;
    if ( v2 )
      sub_66A4(v2, v1);
    *(_DWORD *)(a1 - 4) = -1;
    sub_5433();
    if ( !*(_DWORD *)(a1 - 28) )
LABEL_6:
      MEMORY[0x1000B000](MEMORY[0x100105BC], 0, *(_DWORD *)(a1 + 8));
  }
  sub_718F();
}
// 1000B000: using guessed type int (__stdcall *)(_DWORD, _DWORD, _DWORD);

//----- (00005433) --------------------------------------------------------
int sub_5433()
{
  return sub_654B(4);
}

//----- (00005460) --------------------------------------------------------
#error "54BC: switch analysis failed: switch information is incomplete or incorrect (funcsize=53)"

//----- (000057A0) --------------------------------------------------------
unsigned __int8 *__cdecl sub_57A0(unsigned __int8 *a1, unsigned __int8 a2, unsigned int a3)
{
  unsigned int v3; // edx
  int v4; // eax
  unsigned __int8 *v5; // edi
  int v6; // ecx
  unsigned int v7; // ecx
  unsigned int v8; // ecx

  v3 = a3;
  if ( !a3 )
    return a1;
  LOBYTE(v4) = a2;
  v5 = a1;
  if ( a3 < 4 )
    goto LABEL_13;
  v6 = -(int)a1 & 3;
  if ( v6 )
  {
    v3 = a3 - v6;
    do
    {
      *v5++ = a2;
      --v6;
    }
    while ( v6 );
  }
  v4 = 16843009 * a2;
  v7 = v3;
  v3 &= 3u;
  v8 = v7 >> 2;
  if ( !v8 || (memset32(v5, v4, v8), v5 += 4 * v8, v3) )
  {
LABEL_13:
    do
    {
      *v5++ = v4;
      --v3;
    }
    while ( v3 );
  }
  return a1;
}

//----- (00005800) --------------------------------------------------------
void __usercall sub_5800(int a1@<ebp>)
{
  unsigned int v1; // esi

  sub_7154(268485912, 12);
  v1 = *(_DWORD *)(a1 + 8);
  if ( MEMORY[0x100105C0] != 3
    || v1 > MEMORY[0x100105AC]
    || (sub_6600(4),
        *(_DWORD *)(a1 - 4) = 0,
        *(_DWORD *)(a1 - 28) = sub_6E58(v1),
        *(_DWORD *)(a1 - 4) = -1,
        sub_5872(),
        !*(_DWORD *)(a1 - 28)) )
  {
    if ( !v1 )
      v1 = 1;
    if ( MEMORY[0x100105C0] != 1 )
      v1 = (v1 + 15) & 0xFFFFFFF0;
    MEMORY[0x1000B004](MEMORY[0x100105BC], 0, v1);
  }
  sub_718F();
}
// 6600: using guessed type _DWORD __cdecl sub_6600(_DWORD);
// 1000B004: using guessed type int (__stdcall *)(_DWORD, _DWORD, _DWORD);

//----- (00005872) --------------------------------------------------------
int sub_5872()
{
  return sub_654B(4);
}

//----- (0000587B) --------------------------------------------------------
void __usercall sub_587B(int a1@<ebp>, unsigned int a2, int a3)
{
  int v3; // eax

  if ( a2 <= 0xFFFFFFE0 )
  {
    do
      sub_5800(a1);
    while ( !v3 && a3 && sub_72A9(a2) );
  }
}
// 588E: variable 'v3' is possibly undefined

//----- (000058A7) --------------------------------------------------------
void __usercall sub_58A7(int a1@<ebp>, unsigned int a2)
{
  sub_587B(a1, a2, MEMORY[0x1000FF3C]);
}

//----- (000058B9) --------------------------------------------------------
int *__usercall sub_58B9@<eax>(int a1@<ebp>)
{
  return sub_72FD(a1) + 2;
}

//----- (000058C2) --------------------------------------------------------
int *__usercall sub_58C2@<eax>(int a1@<ebp>)
{
  return sub_72FD(a1) + 3;
}

//----- (000058CB) --------------------------------------------------------
int *__usercall sub_58CB@<eax>(int a1@<ebp>, unsigned int a2)
{
  unsigned int i; // esi
  int *result; // eax

  sub_72FD(a1)[3] = a2;
  for ( i = 0; i < 0x2D; ++i )
  {
    if ( a2 == *(_DWORD *)(8 * i + 0x1000F200) )
    {
      result = sub_72FD(a1);
      result[2] = *(_DWORD *)(8 * i + 0x1000F204);
      return result;
    }
  }
  if ( a2 < 0x13 || a2 > 0x24 )
  {
    if ( a2 < 0xBC || a2 > 0xCA )
    {
      result = sub_72FD(a1);
      result[2] = 22;
    }
    else
    {
      result = sub_72FD(a1);
      result[2] = 8;
    }
  }
  else
  {
    result = sub_72FD(a1);
    result[2] = 13;
  }
  return result;
}

//----- (0000596F) --------------------------------------------------------
void __usercall sub_596F(int a1@<ecx>, int a2@<ebp>)
{
  if ( a1 != MEMORY[0x1000F368] )
  {
    sub_7154(268485928, 8);
    *(_DWORD *)(a2 - 4) = 0;
    sub_7639(1, 0);
  }
}
// 7639: using guessed type int __cdecl sub_7639(_DWORD, _DWORD);

//----- (00005980) --------------------------------------------------------
void __usercall sub_5980(unsigned int a1@<eax>, char a2)
{
  char *v2; // ecx

  if ( a1 < 0x1000 )
    __asm { retn }
  v2 = &a2;
  do
  {
    v2 -= 4096;
    a1 -= 4096;
  }
  while ( a1 >= 0x1000 );
  __asm { retn }
}

//----- (000059BD) --------------------------------------------------------
void __usercall sub_59BD(int a1@<ebp>, unsigned int a2)
{
  sub_587B(a1, a2, 1);
}

//----- (00005A70) --------------------------------------------------------
char *__cdecl sub_5A70(_DWORD *a1)
{
  _DWORD *v1; // ecx
  char v2; // al
  int v3; // eax
  int v4; // eax

  v1 = a1;
  if ( ((unsigned __int8)a1 & 3) == 0 )
    goto LABEL_4;
  do
  {
    v2 = *(_BYTE *)v1;
    v1 = (_DWORD *)((char *)v1 + 1);
    if ( !v2 )
      return (char *)((char *)v1 - 1 - (char *)a1);
  }
  while ( ((unsigned __int8)v1 & 3) != 0 );
  while ( 1 )
  {
    do
    {
LABEL_4:
      v3 = (*v1 + 2130640639) ^ ~*v1;
      ++v1;
    }
    while ( (v3 & 0x81010100) == 0 );
    v4 = *(v1 - 1);
    if ( !(_BYTE)v4 )
      break;
    if ( !BYTE1(v4) )
      return (char *)((char *)v1 - 3 - (char *)a1);
    if ( (v4 & 0xFF0000) == 0 )
      return (char *)((char *)v1 - 2 - (char *)a1);
    if ( (v4 & 0xFF000000) == 0 )
      return (char *)((char *)v1 - 1 - (char *)a1);
  }
  return (char *)((char *)(v1 - 1) - (char *)a1);
}

//----- (00005C70) --------------------------------------------------------
void sub_5C70()
{
  JUMPOUT(0x5CE5);
}
// 5C75: control flows out of bounds to 5CE5

//----- (00005C80) --------------------------------------------------------
_DWORD *__cdecl sub_5C80(_DWORD *a1, _BYTE *a2)
{
  _DWORD *v2; // ecx
  char v3; // al
  int v4; // eax
  int v5; // eax
  _BYTE *v6; // edi
  _BYTE *v7; // ecx
  int v8; // edx
  int v9; // eax
  _DWORD *result; // eax

  v2 = a1;
  if ( ((unsigned __int8)a1 & 3) == 0 )
    goto LABEL_4;
  do
  {
    v3 = *(_BYTE *)v2;
    v2 = (_DWORD *)((char *)v2 + 1);
    if ( !v3 )
    {
LABEL_9:
      v6 = (char *)v2 - 1;
      goto LABEL_13;
    }
  }
  while ( ((unsigned __int8)v2 & 3) != 0 );
  while ( 1 )
  {
    do
    {
LABEL_4:
      v4 = (*v2 + 2130640639) ^ ~*v2;
      ++v2;
    }
    while ( (v4 & 0x81010100) == 0 );
    v5 = *(v2 - 1);
    if ( !(_BYTE)v5 )
      break;
    if ( !BYTE1(v5) )
    {
      v6 = (char *)v2 - 3;
      goto LABEL_13;
    }
    if ( (v5 & 0xFF0000) == 0 )
    {
      v6 = (char *)v2 - 2;
      goto LABEL_13;
    }
    if ( (v5 & 0xFF000000) == 0 )
      goto LABEL_9;
  }
  v6 = v2 - 1;
LABEL_13:
  v7 = a2;
  if ( ((unsigned __int8)a2 & 3) == 0 )
    goto LABEL_18;
  while ( 1 )
  {
    LOBYTE(v8) = *v7++;
    if ( !(_BYTE)v8 )
      break;
    *v6++ = v8;
    if ( ((unsigned __int8)v7 & 3) == 0 )
    {
      while ( 1 )
      {
LABEL_18:
        v9 = (*(_DWORD *)v7 + 2130640639) ^ ~*(_DWORD *)v7;
        v8 = *(_DWORD *)v7;
        v7 += 4;
        if ( (v9 & 0x81010100) != 0 )
        {
          if ( !(_BYTE)v8 )
            goto LABEL_26;
          if ( !BYTE1(v8) )
          {
            *(_WORD *)v6 = (unsigned __int8)v8;
            return a1;
          }
          if ( (v8 & 0xFF0000) == 0 )
          {
            *(_WORD *)v6 = v8;
            result = a1;
            v6[2] = 0;
            return result;
          }
          if ( (v8 & 0xFF000000) == 0 )
          {
            *(_DWORD *)v6 = v8;
            return a1;
          }
        }
        *(_DWORD *)v6 = v8;
        v6 += 4;
      }
    }
  }
LABEL_26:
  *v6 = v8;
  return a1;
}

//----- (00005D68) --------------------------------------------------------
void __cdecl __noreturn sub_5D68(int a1)
{
  int v1; // eax
  void (__stdcall *v2)(int); // eax

  v1 = MEMORY[0x1000B010](268486000);
  if ( v1 )
  {
    v2 = (void (__stdcall *)(int))MEMORY[0x1000B00C](v1, 268485984);
    if ( v2 )
      v2(a1);
  }
  MEMORY[0x1000B008](a1);
}
// 1000B008: using guessed type int (__stdcall *)(_DWORD);
// 1000B00C: using guessed type int (__stdcall *)(_DWORD, _DWORD);
// 1000B010: using guessed type int (__stdcall *)(_DWORD);

//----- (00005D98) --------------------------------------------------------
int sub_5D98()
{
  return sub_6600(8);
}

//----- (00005DA1) --------------------------------------------------------
int sub_5DA1()
{
  return sub_654B(8);
}

//----- (00005DAA) --------------------------------------------------------
int (*__usercall sub_5DAA@<eax>(int (*result)(void)@<eax>, unsigned int a2))(void)
{
  int (**i)(void); // esi

  for ( i = (int (**)(void))result; (unsigned int)i < a2; ++i )
  {
    result = *i;
    if ( *i )
      result = (int (*)(void))result();
  }
  return result;
}

//----- (00005DC2) --------------------------------------------------------
int __usercall sub_5DC2@<eax>(int a1@<ebp>, int a2)
{
  int result; // eax
  unsigned int v3; // esi
  unsigned int i; // esi

  if ( MEMORY[0x100115F4] )
    MEMORY[0x100115F4](a2);
  result = 0;
  v3 = 268492812;
  while ( !result )
  {
    if ( *(_DWORD *)v3 )
      result = (*(int (**)(void))v3)();
    v3 += 4;
    if ( v3 >= 0x1000E01C )
    {
      if ( !result )
      {
        sub_7F29(a1);
        for ( i = 268492800; i < 0x1000E008; i += 4 )
        {
          if ( *(_DWORD *)i )
            (*(void (**)(void))i)();
        }
        result = 0;
      }
      return result;
    }
  }
  return result;
}
// 100115F4: using guessed type int (__cdecl *)(_DWORD);

//----- (00005E2C) --------------------------------------------------------
void __usercall sub_5E2C(int a1@<ebp>)
{
  int v1; // eax
  void (**v2)(void); // eax
  void (*v3)(void); // eax

  sub_7154(268486016, 8);
  sub_6600(8);
  *(_DWORD *)(a1 - 4) = 0;
  if ( MEMORY[0x1000FDC8] == 1 )
  {
    v1 = MEMORY[0x1000B018](*(_DWORD *)(a1 + 8));
    MEMORY[0x1000B014](v1);
  }
  MEMORY[0x1000FDC4] = 1;
  MEMORY[0x1000FDC0] = *(_BYTE *)(a1 + 16);
  if ( !*(_DWORD *)(a1 + 12) )
  {
    if ( MEMORY[0x100115EC] )
    {
      while ( 1 )
      {
        v2 = (void (**)(void))(MEMORY[0x100115E8] - 4);
        MEMORY[0x100115E8] = v2;
        if ( (unsigned int)v2 < MEMORY[0x100115EC] )
          break;
        v3 = *v2;
        if ( v3 )
          v3();
      }
    }
    sub_5DAA((int (*)(void))0x1000E020, 0x1000E028u);
  }
  sub_5DAA((int (*)(void))0x1000E02C, 0x1000E030u);
  *(_DWORD *)(a1 - 4) = -1;
  sub_5EDB(a1, 0);
  if ( !*(_DWORD *)(a1 + 16) )
  {
    MEMORY[0x1000FDC8] = 1;
    sub_5D68(*(_DWORD *)(a1 + 8));
  }
  sub_718F();
}
// 6600: using guessed type _DWORD __cdecl sub_6600(_DWORD);
// 1000B014: using guessed type int (__cdecl *)(_DWORD);
// 1000B018: using guessed type int (__cdecl *)(_DWORD);

//----- (00005EDB) --------------------------------------------------------
int __usercall sub_5EDB@<eax>(int a1@<ebp>, int a2@<edi>)
{
  int result; // eax

  if ( *(_DWORD *)(a1 + 16) != a2 )
    result = sub_654B(8);
  return result;
}

//----- (00005EEF) --------------------------------------------------------
void __usercall sub_5EEF(int a1@<ebp>)
{
  sub_5E2C(a1);
}

//----- (00005F00) --------------------------------------------------------
void __usercall sub_5F00(int a1@<ebp>)
{
  sub_5E2C(a1);
}

//----- (00006070) --------------------------------------------------------
void __usercall sub_6070(int a1@<ebp>)
{
  unsigned int v1; // esi
  unsigned __int8 *v2; // edi
  unsigned int v3; // ebx

  sub_7154(268486032, 16);
  v1 = *(_DWORD *)(a1 + 12) * *(_DWORD *)(a1 + 8);
  *(_DWORD *)(a1 - 32) = v1;
  if ( !v1 )
    v1 = 1;
  do
  {
    v2 = 0;
    *(_DWORD *)(a1 - 28) = 0;
    if ( v1 <= 0xFFFFFFE0 )
    {
      if ( MEMORY[0x100105C0] == 3 )
      {
        v1 = (v1 + 15) & 0xFFFFFFF0;
        *(_DWORD *)(a1 + 12) = v1;
        v3 = *(_DWORD *)(a1 - 32);
        if ( v3 <= MEMORY[0x100105AC] )
        {
          sub_6600(4);
          *(_DWORD *)(a1 - 4) = 0;
          *(_DWORD *)(a1 - 28) = sub_6E58(v3);
          *(_DWORD *)(a1 - 4) = -1;
          sub_611A();
          v2 = *(unsigned __int8 **)(a1 - 28);
          if ( !v2 )
          {
LABEL_9:
            v2 = (unsigned __int8 *)MEMORY[0x1000B004](MEMORY[0x100105BC], 8, v1);
            continue;
          }
          sub_57A0(v2, 0, *(_DWORD *)(a1 - 32));
        }
      }
      if ( v2 )
        break;
      goto LABEL_9;
    }
  }
  while ( !v2 && MEMORY[0x1000FF3C] && sub_72A9(v1) );
  sub_718F();
}
// 6600: using guessed type _DWORD __cdecl sub_6600(_DWORD);
// 1000B004: using guessed type int (__stdcall *)(_DWORD, _DWORD, _DWORD);

//----- (0000611A) --------------------------------------------------------
int sub_611A()
{
  return sub_654B(4);
}

//----- (00006390) --------------------------------------------------------
int __cdecl sub_6390(int a1)
{
  if ( MEMORY[0x1000FDDC] == 1 || !MEMORY[0x1000FDDC] && MEMORY[0x1000FDE0] == 1 )
    sub_874B();
  sub_85D4(a1);
  return MEMORY[0x1000F5F0](255);
}
// 1000F5F0: using guessed type int (__cdecl *)(_DWORD);

//----- (000063C3) --------------------------------------------------------
int sub_63C3()
{
  int result; // eax

  if ( MEMORY[0x1000FD88] == 2 && MEMORY[0x1000FD94] >= 5u )
    result = 1;
  else
    result = 3;
  return result;
}

//----- (000063DD) --------------------------------------------------------
int __cdecl sub_63DD(int a1)
{
  MEMORY[0x100105BC] = MEMORY[0x1000B034](a1 == 0, 4096, 0);
  if ( !MEMORY[0x100105BC] )
    return 0;
  MEMORY[0x100105C0] = sub_63C3();
  if ( MEMORY[0x100105C0] == 3 && !sub_6631(1016) )
  {
    MEMORY[0x1000B030](MEMORY[0x100105BC]);
    return 0;
  }
  return 1;
}
// 1000B030: using guessed type int (__stdcall *)(_DWORD);
// 1000B034: using guessed type int (__stdcall *)(_DWORD, _DWORD, _DWORD);

//----- (0000642E) --------------------------------------------------------
int sub_642E()
{
  int v0; // ebx
  void (__stdcall *v1)(_DWORD, _DWORD, _DWORD); // ebp
  void (__stdcall *v2)(_DWORD, int, int); // edi
  _DWORD *v3; // esi

  if ( MEMORY[0x100105C0] == 3 )
  {
    v0 = 0;
    v1 = (void (__stdcall *)(_DWORD, _DWORD, _DWORD))MEMORY[0x1000B000];
    if ( MEMORY[0x100105A4] > 0 )
    {
      v2 = (void (__stdcall *)(_DWORD, int, int))MEMORY[0x1000B038];
      v3 = (_DWORD *)(MEMORY[0x100105A8] + 12);
      do
      {
        v2(*v3, 0x100000, 0x4000);
        v2(*v3, 0, 0x8000);
        v1(MEMORY[0x100105BC], 0, v3[1]);
        v3 += 5;
        ++v0;
      }
      while ( v0 < MEMORY[0x100105A4] );
    }
    v1(MEMORY[0x100105BC], 0, MEMORY[0x100105A8]);
  }
  return MEMORY[0x1000B030](MEMORY[0x100105BC]);
}
// 1000B030: using guessed type int (__stdcall *)(_DWORD);

//----- (000064AD) --------------------------------------------------------
int __usercall sub_64AD@<eax>(int a1@<ebp>)
{
  int v1; // esi
  int v2; // edi
  int v3; // eax

  v1 = 0;
  v2 = 268500456;
  while ( 1 )
  {
    if ( *(_DWORD *)(8 * v1 + 0x1000F5FC) == 1 )
    {
      *(_DWORD *)(8 * v1 + 0x1000F5F8) = v2;
      v2 += 24;
      sub_8794(a1);
      if ( !v3 )
        break;
    }
    if ( ++v1 >= 36 )
      return 1;
  }
  *(_DWORD *)(8 * v1 + 0x1000F5F8) = 0;
  return 0;
}
// 64DC: variable 'v3' is possibly undefined

//----- (0000654B) --------------------------------------------------------
int __cdecl sub_654B(int a1)
{
  return MEMORY[0x1000B020](*(_DWORD *)(8 * a1 + 0x1000F5F8));
}
// 1000B020: using guessed type int (__stdcall *)(_DWORD);

//----- (00006560) --------------------------------------------------------
void __usercall sub_6560(int a1@<ebp>)
{
  _DWORD *v1; // esi
  int v2; // eax
  int v3; // edi
  int v4; // eax

  sub_7154(268486064, 8);
  v1 = (_DWORD *)(8 * *(_DWORD *)(a1 + 8) + 268498424);
  if ( !*(_DWORD *)(8 * *(_DWORD *)(a1 + 8) + 0x1000F5F8) )
  {
    sub_58A7(a1, 0x18u);
    v3 = v2;
    if ( v2 )
    {
      sub_6600(10);
      *(_DWORD *)(a1 - 4) = 0;
      if ( *v1 )
      {
        sub_53E0(v3);
      }
      else
      {
        sub_8794(a1);
        if ( !v4 )
        {
          sub_53E0(v3);
          *sub_58B9(a1) = 12;
          sub_8862(a1, a1 - 16, -1);
          goto LABEL_11;
        }
        *v1 = v3;
      }
      *(_DWORD *)(a1 - 4) = -1;
      sub_65F7();
    }
    else
    {
      *sub_58B9(a1) = 12;
    }
  }
LABEL_11:
  sub_718F();
}
// 6584: variable 'v2' is possibly undefined
// 65B5: variable 'v4' is possibly undefined
// 53E0: using guessed type int __cdecl sub_53E0(_DWORD);
// 6600: using guessed type _DWORD __cdecl sub_6600(_DWORD);

//----- (000065F7) --------------------------------------------------------
int sub_65F7()
{
  return sub_654B(10);
}

//----- (00006600) --------------------------------------------------------
int __cdecl sub_6600(int a1)
{
  int v1; // eax
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  if ( !*(_DWORD *)(8 * a1 + 0x1000F5F8) )
  {
    sub_6560((int)&savedregs);
    if ( !v1 )
      sub_6390(17);
  }
  return MEMORY[0x1000B01C](*(_DWORD *)(8 * a1 + 0x1000F5F8));
}
// 661C: variable 'v1' is possibly undefined
// 1000B01C: using guessed type int (__stdcall *)(_DWORD);

//----- (00006631) --------------------------------------------------------
int __cdecl sub_6631(int a1)
{
  int result; // eax

  result = MEMORY[0x1000B004](MEMORY[0x100105BC], 0, 320);
  MEMORY[0x100105A8] = result;
  if ( result )
  {
    MEMORY[0x100105A0] = 0;
    MEMORY[0x100105A4] = 0;
    MEMORY[0x100105B0] = result;
    MEMORY[0x100105AC] = a1;
    MEMORY[0x100105B4] = 16;
    result = 1;
  }
  return result;
}
// 1000B004: using guessed type int (__stdcall *)(_DWORD, _DWORD, _DWORD);

//----- (00006679) --------------------------------------------------------
unsigned int __cdecl sub_6679(int a1)
{
  unsigned int result; // eax

  for ( result = MEMORY[0x100105A8]; result < MEMORY[0x100105A8] + 20 * MEMORY[0x100105A4]; result += 20 )
  {
    if ( (unsigned int)(a1 - *(_DWORD *)(result + 12)) < 0x100000 )
      return result;
  }
  return 0;
}

//----- (000066A4) --------------------------------------------------------
_DWORD *__cdecl sub_66A4(_DWORD *a1, int a2)
{
  _DWORD *result; // eax
  int *v3; // esi
  unsigned int v4; // edi
  int v5; // ecx
  char *v6; // ebx
  unsigned int v7; // edx
  _BYTE *v8; // ecx
  unsigned int v9; // ebx
  bool v10; // zf
  _BYTE *v11; // ecx
  unsigned int v12; // ebx
  unsigned int v13; // edx
  unsigned int v14; // ebx
  int v15; // ecx
  unsigned int v16; // esi
  unsigned int v17; // esi
  _DWORD *v18; // ecx
  int v19; // ebx
  void (__stdcall *v20)(_DWORD, _DWORD, int); // esi
  int v21; // eax
  _DWORD *v22; // [esp+8h] [ebp-10h]
  int v23; // [esp+Ch] [ebp-Ch]
  int v24; // [esp+10h] [ebp-8h]
  int v25; // [esp+14h] [ebp-4h]
  char *v26; // [esp+24h] [ebp+Ch]
  int *v27; // [esp+24h] [ebp+Ch]
  char v28; // [esp+27h] [ebp+Fh]

  result = (_DWORD *)a1[4];
  v3 = (int *)(a2 - 4);
  v4 = (unsigned int)(a2 - a1[3]) >> 15;
  v22 = &result[129 * v4 + 81];
  v5 = *(_DWORD *)(a2 - 4) - 1;
  v25 = v5;
  if ( (v5 & 1) == 0 )
  {
    v6 = (char *)v3 + v5;
    v23 = *(int *)((char *)v3 + v5);
    v24 = *(_DWORD *)(a2 - 8);
    v26 = (char *)v3 + v5;
    if ( (v23 & 1) == 0 )
    {
      v7 = (v23 >> 4) - 1;
      if ( v7 > 0x3F )
        v7 = 63;
      if ( *((_DWORD *)v6 + 1) == *((_DWORD *)v6 + 2) )
      {
        if ( v7 >= 0x20 )
        {
          v11 = (char *)result + v7 + 4;
          v12 = ~(0x80000000 >> (v7 - 32));
          result[v4 + 49] &= v12;
          v10 = (*v11)-- == 1;
          if ( v10 )
            a1[1] &= v12;
        }
        else
        {
          v8 = (char *)result + v7 + 4;
          v9 = ~(0x80000000 >> v7);
          result[v4 + 17] &= v9;
          v10 = (*v8)-- == 1;
          if ( v10 )
            *a1 &= v9;
        }
        v6 = v26;
      }
      v5 = v23 + v25;
      *(_DWORD *)(*((_DWORD *)v6 + 2) + 4) = *((_DWORD *)v6 + 1);
      *(_DWORD *)(*((_DWORD *)v26 + 1) + 8) = *((_DWORD *)v26 + 2);
      v25 += v23;
    }
    v13 = (v5 >> 4) - 1;
    if ( v13 > 0x3F )
      v13 = 63;
    if ( (v24 & 1) != 0 )
    {
      v14 = (unsigned int)a1;
    }
    else
    {
      v27 = (int *)((char *)v3 - v24);
      v14 = (v24 >> 4) - 1;
      if ( v14 > 0x3F )
        v14 = 63;
      v15 = v24 + v5;
      v13 = (v15 >> 4) - 1;
      v25 = v15;
      if ( v13 > 0x3F )
        v13 = 63;
      if ( v14 != v13 )
      {
        if ( v27[1] == v27[2] )
        {
          if ( v14 >= 0x20 )
          {
            v17 = ~(0x80000000 >> (v14 - 32));
            result[v4 + 49] &= v17;
            v10 = (*((_BYTE *)result + v14 + 4))-- == 1;
            if ( v10 )
              a1[1] &= v17;
          }
          else
          {
            v16 = ~(0x80000000 >> v14);
            result[v4 + 17] &= v16;
            v10 = (*((_BYTE *)result + v14 + 4))-- == 1;
            if ( v10 )
              *a1 &= v16;
          }
        }
        *(_DWORD *)(v27[2] + 4) = v27[1];
        *(_DWORD *)(v27[1] + 8) = v27[2];
      }
      v3 = v27;
    }
    if ( (v24 & 1) != 0 || v14 != v13 )
    {
      v18 = &v22[2 * v13];
      v19 = v18[1];
      v3[2] = (int)v18;
      v3[1] = v19;
      v18[1] = v3;
      *(_DWORD *)(v3[1] + 8) = v3;
      if ( v3[1] == v3[2] )
      {
        v28 = *((_BYTE *)result + v13 + 4);
        *((_BYTE *)result + v13 + 4) = v28 + 1;
        if ( v13 >= 0x20 )
        {
          if ( !v28 )
            a1[1] |= 0x80000000 >> (v13 - 32);
          result[v4 + 49] |= 0x80000000 >> (v13 - 32);
        }
        else
        {
          if ( !v28 )
            *a1 |= 0x80000000 >> v13;
          result[v4 + 17] |= 0x80000000 >> v13;
        }
      }
    }
    *v3 = v25;
    *(int *)((char *)v3 + v25 - 4) = v25;
    result += 129 * v4 + 81;
    v10 = (*v22)-- == 1;
    if ( v10 )
    {
      if ( MEMORY[0x100105A0] )
      {
        v20 = (void (__stdcall *)(_DWORD, _DWORD, int))MEMORY[0x1000B038];
        MEMORY[0x1000B038](*(_DWORD *)(MEMORY[0x100105A0] + 12) + (MEMORY[0x100105B8] << 15), 0x8000, 0x4000);
        *(_DWORD *)(MEMORY[0x100105A0] + 8) |= 0x80000000 >> MEMORY[0x100105B8];
        *(_DWORD *)(*(_DWORD *)(MEMORY[0x100105A0] + 16) + 4 * MEMORY[0x100105B8] + 196) = 0;
        --*(_BYTE *)(*(_DWORD *)(MEMORY[0x100105A0] + 16) + 67);
        v21 = MEMORY[0x100105A0];
        if ( !*(_BYTE *)(*(_DWORD *)(MEMORY[0x100105A0] + 16) + 67) )
        {
          *(_DWORD *)(MEMORY[0x100105A0] + 4) &= 0xFFFFFFFE;
          v21 = MEMORY[0x100105A0];
        }
        if ( *(_DWORD *)(v21 + 8) == -1 )
        {
          v20(*(_DWORD *)(v21 + 12), 0, 0x8000);
          MEMORY[0x1000B000](MEMORY[0x100105BC], 0, *(_DWORD *)(MEMORY[0x100105A0] + 16));
          sub_8910(
            MEMORY[0x100105A0],
            MEMORY[0x100105A0] + 20,
            20 * MEMORY[0x100105A4] - MEMORY[0x100105A0] + MEMORY[0x100105A8] - 20);
          --MEMORY[0x100105A4];
          if ( (unsigned int)a1 > MEMORY[0x100105A0] )
            a1 -= 5;
          MEMORY[0x100105B0] = MEMORY[0x100105A8];
        }
      }
      result = a1;
      MEMORY[0x100105A0] = a1;
      MEMORY[0x100105B8] = v4;
    }
  }
  return result;
}
// 8910: using guessed type _DWORD __cdecl sub_8910(_DWORD, _DWORD, _DWORD);
// 1000B000: using guessed type int (__stdcall *)(_DWORD, _DWORD, _DWORD);
// 1000B038: using guessed type int (__stdcall *)(_DWORD, _DWORD, _DWORD);

//----- (000069BC) --------------------------------------------------------
_DWORD *sub_69BC()
{
  int v0; // eax
  int v1; // eax
  _DWORD *v3; // esi
  int v4; // eax
  int v5; // eax

  v0 = MEMORY[0x100105A4];
  if ( MEMORY[0x100105A4] == MEMORY[0x100105B4] )
  {
    v1 = MEMORY[0x1000B044](MEMORY[0x100105BC], 0, MEMORY[0x100105A8], 4 * (5 * MEMORY[0x100105B4] + 80));
    if ( !v1 )
      return 0;
    MEMORY[0x100105B4] += 16;
    MEMORY[0x100105A8] = v1;
    v0 = MEMORY[0x100105A4];
  }
  v3 = (_DWORD *)(MEMORY[0x100105A8] + 20 * v0);
  v4 = MEMORY[0x1000B004](MEMORY[0x100105BC], 8, 16836);
  v3[4] = v4;
  if ( !v4 )
    return 0;
  v5 = MEMORY[0x1000B040](0, 0x100000, 0x2000, 4);
  v3[3] = v5;
  if ( !v5 )
  {
    MEMORY[0x1000B000](MEMORY[0x100105BC], 0, v3[4]);
    return 0;
  }
  v3[2] = -1;
  *v3 = 0;
  v3[1] = 0;
  ++MEMORY[0x100105A4];
  *(_DWORD *)v3[4] = -1;
  return v3;
}
// 1000B000: using guessed type int (__stdcall *)(_DWORD, _DWORD, _DWORD);
// 1000B004: using guessed type int (__stdcall *)(_DWORD, _DWORD, _DWORD);
// 1000B040: using guessed type int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD);
// 1000B044: using guessed type int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00006A73) --------------------------------------------------------
int __cdecl sub_6A73(_DWORD *a1)
{
  int v1; // eax
  int v2; // esi
  int v3; // ebx
  int v4; // eax
  int v5; // edx
  unsigned int v6; // edi
  unsigned int v8; // edx
  _DWORD *v9; // eax
  int v10; // ecx

  v1 = a1[2];
  v2 = a1[4];
  v3 = 0;
  while ( v1 >= 0 )
  {
    v1 *= 2;
    ++v3;
  }
  v4 = 516 * v3 + v2 + 324;
  v5 = 63;
  do
  {
    *(_DWORD *)(v4 + 8) = v4;
    *(_DWORD *)(v4 + 4) = v4;
    v4 += 8;
    --v5;
  }
  while ( v5 );
  v6 = a1[3] + (v3 << 15);
  if ( !MEMORY[0x1000B040](v6, 0x8000, 4096, 4) )
    return -1;
  v8 = v6 + 28672;
  if ( v6 <= v6 + 28672 )
  {
    v9 = (_DWORD *)(v6 + 16);
    v10 = 8;
    do
    {
      *(v9 - 2) = -1;
      v9[1019] = -1;
      *v9 = v9 + 1023;
      *(v9 - 1) = 4080;
      v9[1] = v9 - 1025;
      v9[1018] = 4080;
      v9 += 1024;
      --v10;
    }
    while ( v10 );
    v8 = v6 + 28672;
  }
  *(_DWORD *)(516 * v3 + v2 + 832) = v6 + 12;
  *(_DWORD *)(v6 + 20) = 516 * v3 + v2 + 828;
  *(_DWORD *)(516 * v3 + v2 + 836) = v8 + 12;
  *(_DWORD *)(v8 + 16) = 516 * v3 + v2 + 828;
  *(_DWORD *)(v2 + 4 * v3 + 68) = 0;
  *(_DWORD *)(v2 + 4 * v3 + 196) = 1;
  if ( (*(_BYTE *)(v2 + 67))++ == 0 )
    a1[1] |= 1u;
  a1[2] &= ~(0x80000000 >> v3);
  return v3;
}
// 1000B040: using guessed type int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00006B79) --------------------------------------------------------
int __cdecl sub_6B79(_DWORD *a1, int a2, int a3)
{
  int v3; // eax
  unsigned int v4; // edx
  signed int v5; // esi
  int v6; // ecx
  int *v7; // edi
  int v8; // ebx
  unsigned int v9; // ecx
  unsigned int v10; // ebx
  _BYTE *v11; // ecx
  int v12; // ebx
  bool v13; // zf
  unsigned int v14; // ebx
  _BYTE *v15; // ecx
  int v16; // ebx
  unsigned int v17; // edi
  int v18; // ecx
  _DWORD *v19; // eax
  char v20; // cl
  int v21; // edx
  int *v22; // eax
  int v24; // ecx
  int *v25; // ebx
  unsigned int v26; // esi
  unsigned int v27; // esi
  unsigned int v28; // ebx
  _BYTE *v29; // esi
  int v30; // ebx
  _BYTE *v31; // ecx
  unsigned int v32; // ebx
  unsigned int v33; // ecx
  int v34; // edi
  _DWORD *v35; // eax
  char v36; // cl
  int v37; // [esp+Ch] [ebp-Ch]
  int v38; // [esp+10h] [ebp-8h]
  int v39; // [esp+14h] [ebp-4h]
  int v40; // [esp+14h] [ebp-4h]
  int *v41; // [esp+24h] [ebp+Ch]
  char v42; // [esp+27h] [ebp+Fh]
  int v43; // [esp+28h] [ebp+10h]
  unsigned int v44; // [esp+28h] [ebp+10h]
  int v45; // [esp+28h] [ebp+10h]
  char v46; // [esp+2Bh] [ebp+13h]

  v3 = a1[4];
  v4 = (unsigned int)(a2 - a1[3]) >> 15;
  v37 = 516 * v4 + v3 + 324;
  v5 = (a3 + 23) & 0xFFFFFFF0;
  v6 = *(_DWORD *)(a2 - 4) - 1;
  v7 = (int *)(v6 + a2 - 4);
  v8 = *v7;
  v43 = v6;
  v39 = *v7;
  if ( v5 <= v6 )
  {
    if ( v5 < v6 )
    {
      v45 = v6 - v5;
      v24 = v5 + 1;
      *(_DWORD *)(a2 - 4) = v5 + 1;
      v25 = (int *)(a2 + v5 - 4);
      v26 = (v45 >> 4) - 1;
      v41 = v25;
      *(v25 - 1) = v24;
      if ( v26 > 0x3F )
        v26 = 63;
      if ( (v39 & 1) == 0 )
      {
        v27 = (v39 >> 4) - 1;
        if ( v27 > 0x3F )
          v27 = 63;
        if ( v7[1] == v7[2] )
        {
          if ( v27 >= 0x20 )
          {
            v31 = (_BYTE *)(v27 + v3 + 4);
            v32 = ~(0x80000000 >> (v27 - 32));
            *(_DWORD *)(v3 + 4 * v4 + 196) &= v32;
            v13 = (*v31)-- == 1;
            if ( v13 )
              a1[1] &= v32;
          }
          else
          {
            v28 = 0x80000000 >> v27;
            v29 = (_BYTE *)(v27 + v3 + 4);
            v30 = ~v28;
            *(_DWORD *)(v3 + 4 * v4 + 68) &= v30;
            v13 = (*v29)-- == 1;
            if ( v13 )
              *a1 &= v30;
          }
          v25 = v41;
        }
        *(_DWORD *)(v7[2] + 4) = v7[1];
        *(_DWORD *)(v7[1] + 8) = v7[2];
        v45 += v39;
        v26 = (v45 >> 4) - 1;
        if ( v26 > 0x3F )
          v26 = 63;
      }
      v33 = v37 + 8 * v26;
      v34 = *(_DWORD *)(v33 + 4);
      v25[2] = v33;
      v25[1] = v34;
      *(_DWORD *)(v33 + 4) = v25;
      *(_DWORD *)(v25[1] + 8) = v25;
      if ( v25[1] == v25[2] )
      {
        v42 = *(_BYTE *)(v26 + v3 + 4);
        *(_BYTE *)(v26 + v3 + 4) = v42 + 1;
        if ( v26 >= 0x20 )
        {
          if ( !v42 )
            a1[1] |= 0x80000000 >> (v26 - 32);
          v35 = (_DWORD *)(v3 + 4 * v4 + 196);
          v36 = v26 - 32;
        }
        else
        {
          if ( !v42 )
            *a1 |= 0x80000000 >> v26;
          v35 = (_DWORD *)(v3 + 4 * v4 + 68);
          v36 = v26;
        }
        *v35 |= 0x80000000 >> v36;
      }
      *v25 = v45;
      *(int *)((char *)v25 + v45 - 4) = v45;
    }
  }
  else
  {
    if ( (v8 & 1) != 0 || v5 > v6 + v8 )
      return 0;
    v9 = (v39 >> 4) - 1;
    v38 = v9;
    if ( v9 > 0x3F )
    {
      v9 = 63;
      v38 = 63;
    }
    if ( v7[1] == v7[2] )
    {
      if ( v9 >= 0x20 )
      {
        v14 = 0x80000000 >> (v9 - 32);
        v15 = (_BYTE *)(v38 + v3 + 4);
        v16 = ~v14;
        *(_DWORD *)(v3 + 4 * v4 + 196) &= v16;
        v13 = (*v15)-- == 1;
        if ( v13 )
          a1[1] &= v16;
      }
      else
      {
        v10 = 0x80000000 >> v9;
        v11 = (_BYTE *)(v38 + v3 + 4);
        v12 = ~v10;
        *(_DWORD *)(v3 + 4 * v4 + 68) &= v12;
        v13 = (*v11)-- == 1;
        if ( v13 )
          *a1 &= v12;
      }
    }
    *(_DWORD *)(v7[2] + 4) = v7[1];
    *(_DWORD *)(v7[1] + 8) = v7[2];
    v40 = v43 - v5 + v39;
    if ( v40 <= 0 )
    {
      v21 = a2;
    }
    else
    {
      v17 = (v40 >> 4) - 1;
      v18 = a2 + v5 - 4;
      if ( v17 > 0x3F )
        v17 = 63;
      v44 = v37 + 8 * v17;
      *(_DWORD *)(a2 + v5) = *(_DWORD *)(v44 + 4);
      *(_DWORD *)(v18 + 8) = v44;
      *(_DWORD *)(v44 + 4) = v18;
      *(_DWORD *)(*(_DWORD *)(a2 + v5) + 8) = a2 + v5 - 4;
      if ( *(_DWORD *)(a2 + v5) == *(_DWORD *)(a2 + v5 - 4 + 8) )
      {
        v46 = *(_BYTE *)(v17 + v3 + 4);
        *(_BYTE *)(v17 + v3 + 4) = v46 + 1;
        if ( v17 >= 0x20 )
        {
          if ( !v46 )
            a1[1] |= 0x80000000 >> (v17 - 32);
          v19 = (_DWORD *)(v3 + 4 * v4 + 196);
          v20 = v17 - 32;
        }
        else
        {
          if ( !v46 )
            *a1 |= 0x80000000 >> v17;
          v19 = (_DWORD *)(v3 + 4 * v4 + 68);
          v20 = v17;
        }
        *v19 |= 0x80000000 >> v20;
      }
      v21 = a2;
      v22 = (int *)(a2 + v5 - 4);
      *v22 = v40;
      *(int *)((char *)v22 + v40 - 4) = v40;
    }
    *(_DWORD *)(v21 - 4) = v5 + 1;
    *(_DWORD *)(v21 + v5 - 8) = v5 + 1;
  }
  return 1;
}

//----- (00006E58) --------------------------------------------------------
_DWORD *__cdecl sub_6E58(int a1)
{
  int v1; // ecx
  unsigned int v2; // esi
  _DWORD *j; // ebx
  bool i; // cf
  _DWORD *v5; // eax
  int v6; // edx
  _DWORD *v7; // ecx
  int v8; // edx
  int v9; // edi
  int v10; // ecx
  int *v12; // edx
  int v13; // ecx
  int v14; // esi
  unsigned int v15; // ebx
  _BYTE *v16; // edi
  bool v17; // zf
  unsigned int v18; // ebx
  _BYTE *v19; // edi
  int v20; // ebx
  _DWORD *v21; // ecx
  int v22; // edi
  _DWORD *v23; // edx
  int v24; // [esp+Ch] [ebp-14h]
  int v25; // [esp+Ch] [ebp-14h]
  signed int v26; // [esp+10h] [ebp-10h]
  _DWORD *v27; // [esp+14h] [ebp-Ch]
  unsigned int v28; // [esp+18h] [ebp-8h]
  int v29; // [esp+18h] [ebp-8h]
  unsigned int v30; // [esp+1Ch] [ebp-4h]
  int v31; // [esp+1Ch] [ebp-4h]
  _DWORD *v32; // [esp+28h] [ebp+8h]
  char v33; // [esp+2Bh] [ebp+Bh]

  v26 = (a1 + 23) & 0xFFFFFFF0;
  v1 = (v26 >> 4) - 1;
  v30 = MEMORY[0x100105A8] + 20 * MEMORY[0x100105A4];
  if ( v1 >= 32 )
  {
    v2 = 0;
    v28 = 0xFFFFFFFF >> ((v26 >> 4) - 33);
  }
  else
  {
    v2 = 0xFFFFFFFF >> v1;
    v28 = -1;
  }
  j = (_DWORD *)MEMORY[0x100105B0];
  for ( i = MEMORY[0x100105B0] < (unsigned int)(MEMORY[0x100105A8] + 20 * MEMORY[0x100105A4]); ; i = (unsigned int)j < v30 )
  {
    v32 = j;
    if ( !i || v2 & *j | v28 & j[1] )
      break;
    j += 5;
  }
  if ( j == (_DWORD *)v30 )
  {
    for ( j = (_DWORD *)MEMORY[0x100105A8]; ; j += 5 )
    {
      v32 = j;
      if ( (unsigned int)j >= MEMORY[0x100105B0] || v2 & *j | v28 & j[1] )
        break;
    }
    if ( j == (_DWORD *)MEMORY[0x100105B0] )
    {
      while ( (unsigned int)j < v30 && !j[2] )
      {
        j += 5;
        v32 = j;
      }
      if ( j == (_DWORD *)v30 )
      {
        for ( j = (_DWORD *)MEMORY[0x100105A8]; ; j += 5 )
        {
          v32 = j;
          if ( (unsigned int)j >= MEMORY[0x100105B0] || j[2] )
            break;
        }
        if ( j == (_DWORD *)MEMORY[0x100105B0] )
        {
          j = sub_69BC();
          v32 = j;
          if ( !j )
            return 0;
        }
      }
      *(_DWORD *)j[4] = sub_6A73(j);
      if ( *(_DWORD *)j[4] == -1 )
        return 0;
    }
  }
  MEMORY[0x100105B0] = j;
  v5 = (_DWORD *)j[4];
  v6 = *v5;
  v31 = *v5;
  if ( *v5 == -1 || !(v2 & v5[v6 + 17] | v28 & v5[v6 + 49]) )
  {
    v31 = 0;
    v7 = v5 + 17;
    if ( !(v2 & v5[17] | v28 & v5[49]) )
    {
      do
      {
        v8 = v28 & v7[33];
        ++v31;
        ++v7;
      }
      while ( !(v2 & *v7 | v8) );
    }
    v6 = v31;
  }
  v27 = &v5[129 * v6 + 81];
  v9 = 0;
  v10 = v2 & v5[v6 + 17];
  if ( !v10 )
  {
    v10 = v28 & v5[v6 + 49];
    v9 = 32;
  }
  while ( v10 >= 0 )
  {
    v10 *= 2;
    ++v9;
  }
  v12 = (int *)v27[2 * v9 + 1];
  v13 = *v12 - v26;
  v14 = (v13 >> 4) - 1;
  v29 = v13;
  if ( v14 > 63 )
    v14 = 63;
  if ( v14 == v9 )
    goto LABEL_55;
  if ( v12[1] != v12[2] )
    goto LABEL_45;
  if ( v9 >= 32 )
  {
    v18 = 0x80000000 >> (v9 - 32);
    v19 = (char *)v5 + v9 + 4;
    v20 = ~v18;
    v5[v31 + 49] &= v20;
    v17 = (*v19)-- == 1;
    v25 = v20;
    if ( v17 )
    {
      j = v32;
      v32[1] &= v25;
      goto LABEL_45;
    }
  }
  else
  {
    v15 = 0x80000000 >> v9;
    v16 = (char *)v5 + v9 + 4;
    v24 = ~v15;
    v5[v31 + 17] &= ~v15;
    v17 = (*v16)-- == 1;
    if ( v17 )
    {
      j = v32;
      *v32 &= v24;
      goto LABEL_45;
    }
  }
  j = v32;
LABEL_45:
  *(_DWORD *)(v12[2] + 4) = v12[1];
  *(_DWORD *)(v12[1] + 8) = v12[2];
  if ( v13 )
  {
    v21 = &v27[2 * v14];
    v22 = v21[1];
    v12[2] = (int)v21;
    v12[1] = v22;
    v21[1] = v12;
    *(_DWORD *)(v12[1] + 8) = v12;
    if ( v12[1] == v12[2] )
    {
      v33 = *((_BYTE *)v5 + v14 + 4);
      *((_BYTE *)v5 + v14 + 4) = v33 + 1;
      if ( v14 >= 32 )
      {
        if ( !v33 )
          j[1] |= 0x80000000 >> (v14 - 32);
        v5[v31 + 49] |= 0x80000000 >> (v14 - 32);
      }
      else
      {
        if ( !v33 )
          *j |= 0x80000000 >> v14;
        v5[v31 + 17] |= 0x80000000 >> v14;
      }
    }
    v13 = v29;
LABEL_55:
    if ( v13 )
    {
      *v12 = v13;
      *(int *)((char *)v12 + v13 - 4) = v13;
    }
    goto LABEL_58;
  }
  v13 = 0;
LABEL_58:
  v23 = (int *)((char *)v12 + v13);
  *v23 = v26 + 1;
  *(_DWORD *)((char *)v23 + v26 - 4) = v26 + 1;
  v17 = (*v27)++ == 0;
  if ( v17 && j == (_DWORD *)MEMORY[0x100105A0] && v31 == MEMORY[0x100105B8] )
    MEMORY[0x100105A0] = 0;
  *v5 = v31;
  return v23 + 1;
}

//----- (00007154) --------------------------------------------------------
_DWORD *__cdecl sub_7154(int a1, int a2)
{
  void *v4; // esp
  _DWORD v6[2]; // [esp-8h] [ebp-8h] BYREF
  int v7; // [esp+4h] [ebp+4h]

  v6[1] = 268464520;
  v6[0] = NtCurrentTeb()->NtTib.ExceptionList;
  v4 = alloca(a2);
  v7 = -1;
  return v6;
}
// 7185: returning address of temporary local variable '%0x10'

//----- (0000718F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_718F()
{
  __asm { retn }
}
// 719E: positive sp value 14 has been found

//----- (000072A9) --------------------------------------------------------
BOOL __cdecl sub_72A9(int a1)
{
  return MEMORY[0x1000FF38] && MEMORY[0x1000FF38](a1);
}
// 1000FF38: using guessed type int (__cdecl *)(_DWORD);

//----- (000072CD) --------------------------------------------------------
int __usercall sub_72CD@<eax>(int a1@<ebp>)
{
  void (__stdcall *v1)(_DWORD); // ebx
  int i; // esi
  int j; // esi
  int result; // eax

  if ( MEMORY[0x1000F718] != -1 )
  {
    MEMORY[0x1000FF4C](MEMORY[0x1000F718]);
    MEMORY[0x1000F718] = -1;
  }
  v1 = (void (__stdcall *)(_DWORD))MEMORY[0x1000B03C];
  for ( i = 268498424; i < 268498712; i += 8 )
  {
    if ( *(_DWORD *)i && *(_DWORD *)(i + 4) != 1 )
    {
      v1(*(_DWORD *)i);
      sub_53E0(a1);
      *(_DWORD *)i = 0;
    }
  }
  for ( j = 268498424; j < 268498712; j += 8 )
  {
    result = *(_DWORD *)j;
    if ( *(_DWORD *)j )
    {
      if ( *(_DWORD *)(j + 4) == 1 )
        result = ((int (__stdcall *)(_DWORD))v1)(*(_DWORD *)j);
    }
  }
  return result;
}
// 1000FF4C: using guessed type int (__stdcall *)(_DWORD);

//----- (000072EA) --------------------------------------------------------
int __cdecl sub_72EA(int a1)
{
  int result; // eax

  result = a1;
  *(_DWORD *)(a1 + 84) = 268498760;
  *(_DWORD *)(a1 + 20) = 1;
  return result;
}

//----- (000072FD) --------------------------------------------------------
int *__usercall sub_72FD@<eax>(int a1@<ebp>)
{
  int v1; // ebx
  int *v2; // esi
  int *v3; // eax
  int v4; // eax

  v1 = MEMORY[0x1000B050]();
  v2 = (int *)MEMORY[0x1000FF44](MEMORY[0x1000F718]);
  if ( !v2 )
  {
    sub_6070(a1);
    v2 = v3;
    if ( v3 && MEMORY[0x1000FF48](MEMORY[0x1000F718], v3) )
    {
      v2[21] = 268498760;
      v2[5] = 1;
      v4 = MEMORY[0x1000B024]();
      v2[1] = -1;
      *v2 = v4;
    }
    else
    {
      sub_6390(16);
    }
  }
  MEMORY[0x1000B04C](v1);
  return v2;
}
// 7325: variable 'v3' is possibly undefined
// 1000B024: using guessed type int (*)(void);
// 1000B04C: using guessed type int (__stdcall *)(_DWORD);
// 1000B050: using guessed type int (*)(void);
// 1000FF44: using guessed type int (__stdcall *)(_DWORD);
// 1000FF48: using guessed type int (__stdcall *)(_DWORD, _DWORD);

//----- (0000736E) --------------------------------------------------------
void __userpurge sub_736E(int a1@<ebp>, int a2)
{
  _DWORD *v2; // esi
  _DWORD *v3; // eax
  int v5; // eax

  sub_7154(268486080, 16);
  v2 = *(_DWORD **)(a1 + 8);
  if ( v2 )
  {
    if ( v2[9] )
      sub_53E0(a1);
    if ( v2[11] )
      sub_53E0(a1);
    if ( v2[13] )
      sub_53E0(a1);
    if ( v2[15] )
      sub_53E0(a1);
    if ( v2[17] )
      sub_53E0(a1);
    if ( v2[18] )
      sub_53E0(a1);
    if ( v2[21] != 268498760 )
      sub_53E0(a1);
    sub_6600(13);
    *(_DWORD *)(a1 - 4) = 0;
    v3 = (_DWORD *)v2[24];
    *(_DWORD *)(a1 - 28) = v3;
    if ( v3 )
    {
      if ( (*v3)-- == 1 && v3 != (_DWORD *)MEMORY[0x10010244] )
        sub_53E0(a1);
    }
    *(_DWORD *)(a1 - 4) = -1;
    sub_74A0();
    sub_6600(12);
    *(_DWORD *)(a1 - 4) = 1;
    v5 = v2[25];
    *(_DWORD *)(a1 - 32) = v5;
    if ( v5 )
    {
      --*(_DWORD *)v5;
      if ( *(_DWORD *)(v5 + 44) )
        --**(_DWORD **)(v5 + 44);
      if ( *(_DWORD *)(v5 + 52) )
        --**(_DWORD **)(v5 + 52);
      if ( *(_DWORD *)(v5 + 48) )
        --**(_DWORD **)(v5 + 48);
      if ( *(_DWORD *)(v5 + 64) )
        --**(_DWORD **)(v5 + 64);
      --*(_DWORD *)(*(_DWORD *)(v5 + 76) + 180);
      if ( v5 != MEMORY[0x1000F8DC] && v5 != 268499080 && !*(_DWORD *)v5 )
        sub_8E76(a1, v5);
    }
    *(_DWORD *)(a1 - 4) = -1;
    sub_74AC();
    sub_53E0(a1);
  }
  sub_718F();
}

//----- (000074A0) --------------------------------------------------------
int sub_74A0()
{
  return sub_654B(13);
}

//----- (000074AC) --------------------------------------------------------
int sub_74AC()
{
  return sub_654B(12);
}

//----- (000074B5) --------------------------------------------------------
void __usercall sub_74B5(int a1@<ebp>, int a2)
{
  int v2; // eax

  if ( MEMORY[0x1000F718] != -1 )
  {
    v2 = a2;
    if ( !a2 )
      v2 = MEMORY[0x1000FF44](MEMORY[0x1000F718]);
    sub_736E(a1, v2);
    MEMORY[0x1000FF48](MEMORY[0x1000F718], 0);
  }
}
// 1000FF44: using guessed type int (__stdcall *)(_DWORD);
// 1000FF48: using guessed type int (__stdcall *)(_DWORD, _DWORD);

//----- (000074E4) --------------------------------------------------------
int __usercall sub_74E4@<eax>(int a1@<ebp>)
{
  int v1; // eax
  int v2; // edi
  int (__stdcall *v3)(int, int); // esi
  int *v4; // eax
  int *v5; // esi
  int v6; // eax
  int result; // eax

  if ( !sub_64AD(a1) )
    goto LABEL_9;
  v1 = MEMORY[0x1000B010](268486148);
  v2 = v1;
  if ( v1 )
  {
    v3 = MEMORY[0x1000B00C];
    MEMORY[0x1000FF40] = (int (__cdecl *)(_DWORD))MEMORY[0x1000B00C](v1, 268486136);
    MEMORY[0x1000FF44] = (int (__stdcall *)(_DWORD))v3(v2, 268486124);
    MEMORY[0x1000FF48] = (int (__stdcall *)(_DWORD, _DWORD))v3(v2, 268486112);
    MEMORY[0x1000FF4C] = (int (__stdcall *)(_DWORD))v3(v2, 268486104);
    if ( !MEMORY[0x1000FF44] )
    {
      MEMORY[0x1000FF44] = (int (__stdcall *)(_DWORD))MEMORY[0x1000B05C];
      MEMORY[0x1000FF48] = (int (__stdcall *)(_DWORD, _DWORD))MEMORY[0x1000B058];
      MEMORY[0x1000FF40] = (int (__cdecl *)(_DWORD))268464804;
      MEMORY[0x1000FF4C] = (int (__stdcall *)(_DWORD))MEMORY[0x1000B054];
    }
  }
  MEMORY[0x1000F718] = MEMORY[0x1000FF40](268464974);
  if ( MEMORY[0x1000F718] != -1 && (sub_6070(a1), (v5 = v4) != 0) && MEMORY[0x1000FF48](MEMORY[0x1000F718], v4) )
  {
    v5[21] = 268498760;
    v5[5] = 1;
    v6 = MEMORY[0x1000B024]();
    v5[1] = -1;
    *v5 = v6;
    result = 1;
  }
  else
  {
LABEL_9:
    sub_72CD(a1);
    result = 0;
  }
  return result;
}
// 7596: variable 'v4' is possibly undefined
// 1000B00C: using guessed type int (__stdcall *)(_DWORD, _DWORD);
// 1000B010: using guessed type int (__stdcall *)(_DWORD);
// 1000B024: using guessed type int (*)(void);
// 1000FF40: using guessed type int (__cdecl *)(_DWORD);
// 1000FF44: using guessed type int (__stdcall *)(_DWORD);
// 1000FF48: using guessed type int (__stdcall *)(_DWORD, _DWORD);
// 1000FF4C: using guessed type int (__stdcall *)(_DWORD);

//----- (00007639) --------------------------------------------------------
#error "7724: call analysis failed (funcsize=97)"

//----- (00007BFF) --------------------------------------------------------
int __usercall sub_7BFF@<eax>(_BYTE *a1@<ebp>, int a2@<edi>, int a3@<esi>)
{
  unsigned int v3; // eax
  unsigned int i; // ecx
  int v6; // edi
  int v7; // esi
  unsigned int v8; // eax
  unsigned int j; // ecx
  int k; // ebx
  int v11; // esi
  int v12; // eax
  int l; // ebx
  int v14; // esi
  int v15; // eax
  int v16; // eax
  int v17; // edi
  int v18; // eax
  int v19; // eax
  _BYTE *v22; // [esp+0h] [ebp-50h]
  int v23; // [esp+4h] [ebp-4Ch]
  _DWORD *v24; // [esp+8h] [ebp-48h]
  char v25[48]; // [esp+Ch] [ebp-44h] BYREF
  int v26; // [esp+3Ch] [ebp-14h]
  _DWORD *v27; // [esp+40h] [ebp-10h]

  sub_58A7((int)a1, 0x480u);
  if ( !v3 )
    return -1;
  MEMORY[0x100104A0] = v3;
  MEMORY[0x10010480] = 32;
  for ( i = v3 + 1152; v3 < i; i = MEMORY[0x100104A0] + 1152 )
  {
    *(_DWORD *)v3 = -1;
    *(_DWORD *)(v3 + 8) = 0;
    *(_BYTE *)(v3 + 4) = 0;
    *(_BYTE *)(v3 + 5) = 10;
    v3 += 36;
  }
  v22 = a1;
  MEMORY[0x1000B090](v25);
  if ( HIWORD(v26) && v27 )
  {
    v6 = *v27;
    a1 = v27 + 1;
    v24 = (_DWORD *)((char *)v27 + *v27 + 4);
    if ( (int)*v27 >= 2048 )
      v6 = 2048;
    if ( MEMORY[0x10010480] < v6 )
    {
      v7 = 268502180;
      while ( 1 )
      {
        sub_58A7((int)a1, 0x480u);
        if ( !v8 )
          break;
        MEMORY[0x10010480] += 32;
        *(_DWORD *)v7 = v8;
        for ( j = v8 + 1152; v8 < j; j = *(_DWORD *)v7 + 1152 )
        {
          *(_DWORD *)v8 = -1;
          *(_DWORD *)(v8 + 8) = 0;
          *(_BYTE *)(v8 + 4) = 0;
          *(_BYTE *)(v8 + 5) = 10;
          v8 += 36;
        }
        v7 += 4;
        if ( MEMORY[0x10010480] >= v6 )
          goto LABEL_19;
      }
      v6 = MEMORY[0x10010480];
    }
LABEL_19:
    for ( k = 0; k < v6; ++a1 )
    {
      if ( *v24 != -1 && (*a1 & 1) != 0 && ((*a1 & 8) != 0 || MEMORY[0x1000B08C](*v24)) )
      {
        v11 = *(_DWORD *)(4 * (k >> 5) + 0x100104A0) + 36 * (k & 0x1F);
        *(_DWORD *)v11 = *v24;
        *(_BYTE *)(v11 + 4) = *a1;
        sub_8794((int)a1);
        if ( !v12 )
          return -1;
        ++*(_DWORD *)(v11 + 8);
      }
      ++v24;
      ++k;
    }
  }
  for ( l = 0; l < 3; ++l )
  {
    v14 = MEMORY[0x100104A0] + 36 * l;
    if ( *(_DWORD *)v14 == -1 )
    {
      *(_BYTE *)(v14 + 4) = -127;
      if ( l )
        v15 = -(l != 1) - 11;
      else
        v15 = -10;
      v16 = MEMORY[0x1000B088](v15, a2, a3, v22, v23);
      v17 = v16;
      if ( v16 == -1 || (v18 = MEMORY[0x1000B08C](v16)) == 0 )
      {
        *(_BYTE *)(v14 + 4) |= 0x40u;
      }
      else
      {
        *(_DWORD *)v14 = v17;
        if ( (unsigned __int8)v18 == 2 )
        {
          *(_BYTE *)(v14 + 4) |= 0x40u;
        }
        else if ( (unsigned __int8)v18 == 3 )
        {
          *(_BYTE *)(v14 + 4) |= 8u;
        }
        sub_8794((int)a1);
        if ( !v19 )
          return -1;
        ++*(_DWORD *)(v14 + 8);
      }
    }
    else
    {
      *(_BYTE *)(v14 + 4) |= 0x80u;
    }
  }
  MEMORY[0x1000B084](MEMORY[0x10010480]);
  return 0;
}
// 7BFF: could not find valid save-restore pair for edi
// 7BFF: could not find valid save-restore pair for esi
// 7C11: variable 'v3' is possibly undefined
// 7CA7: variable 'v8' is possibly undefined
// 7D47: variable 'v12' is possibly undefined
// 7D87: variable 'a2' is possibly undefined
// 7D87: variable 'a3' is possibly undefined
// 7D87: variable 'v22' is possibly undefined
// 7D87: variable 'v23' is possibly undefined
// 7DCC: variable 'v19' is possibly undefined
// 1000B084: using guessed type int (__stdcall *)(_DWORD);
// 1000B088: using guessed type int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 1000B08C: using guessed type int (__stdcall *)(_DWORD);
// 1000B090: using guessed type int (__stdcall *)(_DWORD);

//----- (00007DFD) --------------------------------------------------------
void __usercall sub_7DFD(int a1@<ebp>)
{
  int i; // esi
  unsigned int v2; // edi
  unsigned int j; // eax

  for ( i = 268502176; i < 268502432; i += 4 )
  {
    v2 = *(_DWORD *)i;
    if ( *(_DWORD *)i )
    {
      for ( j = v2 + 1152; v2 < j; j = *(_DWORD *)i + 1152 )
      {
        if ( *(_DWORD *)(v2 + 8) )
          MEMORY[0x1000B03C](v2 + 12);
        v2 += 36;
      }
      sub_53E0(a1);
      *(_DWORD *)i = 0;
    }
  }
}
// 1000B03C: using guessed type int (__stdcall *)(_DWORD);

//----- (00007E49) --------------------------------------------------------
void __usercall sub_7E49(int a1@<ebp>, int a2@<edi>)
{
  _DWORD *v2; // ecx
  unsigned int v3; // eax
  int v4; // eax
  int v5; // ecx

  sub_9B92(a1);
  v2 = (_DWORD *)MEMORY[0x100115E8];
  if ( v3 >= MEMORY[0x100115E8] - MEMORY[0x100115EC] + 4 )
    goto LABEL_5;
  sub_99E5(a1);
  if ( v4 || (sub_99E5(a1), v4) )
  {
    v5 = MEMORY[0x100115E8] - MEMORY[0x100115EC];
    MEMORY[0x100115EC] = v4;
    v2 = (_DWORD *)(v4 + 4 * (v5 >> 2));
    MEMORY[0x100115E8] = v2;
LABEL_5:
    *v2 = a2;
    MEMORY[0x100115E8] += 4;
  }
}
// 7E6C: variable 'v3' is possibly undefined
// 7E86: variable 'v4' is possibly undefined

//----- (00007EF1) --------------------------------------------------------
void __usercall sub_7EF1(int a1@<ebp>)
{
  int v1; // eax

  sub_7154(268486840, 12);
  sub_5D98();
  *(_DWORD *)(a1 - 4) = 0;
  sub_7E49(a1, *(_DWORD *)(a1 + 8));
  *(_DWORD *)(a1 - 28) = v1;
  *(_DWORD *)(a1 - 4) = -1;
  sub_7F23();
  sub_718F();
}
// 7F0E: variable 'v1' is possibly undefined

//----- (00007F23) --------------------------------------------------------
// attributes: thunk
int sub_7F23()
{
  return sub_5DA1();
}

//----- (00007F29) --------------------------------------------------------
int __usercall sub_7F29@<eax>(int a1@<ebp>)
{
  int v1; // eax

  sub_7EF1(a1);
  return (v1 != 0) - 1;
}
// 7F32: variable 'v1' is possibly undefined

//----- (00007F3B) --------------------------------------------------------
void __usercall sub_7F3B(int a1@<ebp>)
{
  void (*v1)(void); // eax

  sub_7154(268486856, 12);
  for ( *(_DWORD *)(a1 - 28) = 268490380; *(_DWORD *)(a1 - 28) < 0x1000D68Cu; *(_DWORD *)(a1 - 28) += 4 )
  {
    *(_DWORD *)(a1 - 4) = 0;
    v1 = **(void (***)(void))(a1 - 28);
    if ( v1 )
      v1();
    *(_DWORD *)(a1 - 4) = -1;
  }
  sub_718F();
}

//----- (0000805E) --------------------------------------------------------
int __usercall sub_805E@<eax>(int a1@<ebp>)
{
  char *v1; // esi
  int v2; // edi
  _DWORD *v3; // eax
  _DWORD *v4; // edi
  _DWORD *i; // esi
  char *v7; // eax
  int v8; // eax

  if ( !MEMORY[0x100115F0] )
    sub_9506(a1);
  v1 = (char *)MEMORY[0x1000FDD4];
  v2 = 0;
  if ( !MEMORY[0x1000FDD4] )
    return -1;
  while ( *v1 )
  {
    if ( *v1 != 61 )
      ++v2;
    v1 = &sub_5A70(v1)[(_DWORD)v1 + 1];
  }
  sub_58A7(a1, 4 * v2 + 4);
  v4 = v3;
  MEMORY[0x1000FDA8] = v3;
  if ( !v3 )
    return -1;
  for ( i = (_DWORD *)MEMORY[0x1000FDD4]; ; i = (_DWORD *)((char *)i + a1) )
  {
    if ( !*(_BYTE *)i )
    {
      sub_53E0(a1);
      MEMORY[0x1000FDD4] = 0;
      *v4 = 0;
      MEMORY[0x100115E4] = 1;
      return 0;
    }
    v7 = sub_5A70(i);
    a1 = (int)(v7 + 1);
    if ( *(_BYTE *)i != 61 )
      break;
LABEL_15:
    ;
  }
  sub_58A7(a1, (unsigned int)(v7 + 1));
  *v4 = v8;
  if ( v8 )
  {
    sub_5C70();
    ++v4;
    goto LABEL_15;
  }
  sub_53E0(a1);
  MEMORY[0x1000FDA8] = 0;
  return -1;
}
// 80A1: variable 'v3' is possibly undefined
// 80D4: variable 'v8' is possibly undefined

//----- (00008125) --------------------------------------------------------
char **__usercall sub_8125@<eax>(char *a1@<eax>, char *a2@<ecx>, _DWORD *a3@<esi>, char **a4, _DWORD *a5)
{
  _DWORD *v5; // ebx
  BOOL v6; // edx
  char **v8; // ecx
  char v9; // cl
  int v10; // ebx
  char **v11; // ecx
  int v12; // ebx
  unsigned int v13; // edx
  unsigned __int8 v14; // cl
  char **result; // eax
  BOOL v16; // [esp+8h] [ebp-4h]

  v5 = a5;
  v6 = 0;
  *a3 = 0;
  *a5 = 1;
  if ( a4 )
  {
    v8 = a4++;
    *v8 = a2;
  }
  do
  {
    if ( *a1 == 34 )
    {
      ++a1;
      v6 = !v6;
      v9 = 34;
    }
    else
    {
      ++*a3;
      if ( a2 )
        *a2++ = *a1;
      v9 = *a1;
      v10 = (unsigned __int8)*a1++;
      if ( (*(_BYTE *)(v10 + 268501601) & 4) != 0 )
      {
        ++*a3;
        if ( a2 )
          *a2++ = *a1;
        ++a1;
      }
      v5 = a5;
      if ( !v9 )
      {
        --a1;
        goto LABEL_17;
      }
    }
  }
  while ( v6 || v9 != 32 && v9 != 9 );
  if ( a2 )
    *(a2 - 1) = 0;
LABEL_17:
  v16 = 0;
  while ( *a1 )
  {
    while ( *a1 == 32 || *a1 == 9 )
      ++a1;
    if ( !*a1 )
      break;
    if ( a4 )
    {
      v11 = a4++;
      *v11 = a2;
    }
    ++*v5;
    while ( 1 )
    {
      v12 = 1;
      v13 = 0;
      while ( *a1 == 92 )
      {
        ++a1;
        ++v13;
      }
      if ( *a1 == 34 )
      {
        if ( (v13 & 1) == 0 )
        {
          if ( v16 && a1[1] == 34 )
            ++a1;
          else
            v12 = 0;
          v16 = !v16;
        }
        v13 >>= 1;
      }
      for ( ; v13; --v13 )
      {
        if ( a2 )
          *a2++ = 92;
        ++*a3;
      }
      v14 = *a1;
      if ( !*a1 || !v16 && (v14 == 32 || v14 == 9) )
        break;
      if ( v12 )
      {
        if ( a2 )
        {
          if ( (*(_BYTE *)(v14 + 0x10010261) & 4) != 0 )
          {
            *a2++ = v14;
            ++a1;
            ++*a3;
          }
          *a2++ = *a1;
        }
        else if ( (*(_BYTE *)(v14 + 0x10010261) & 4) != 0 )
        {
          ++a1;
          ++*a3;
        }
        ++*a3;
      }
      ++a1;
    }
    if ( a2 )
      *a2++ = 0;
    ++*a3;
    v5 = a5;
  }
  result = a4;
  if ( a4 )
    *a4 = 0;
  ++*v5;
  return result;
}

//----- (00008291) --------------------------------------------------------
int sub_8291()
{
  int v0; // ebx
  int v1; // esi
  char **v2; // eax
  char **v3; // edi
  int v5; // [esp+0h] [ebp-14h]
  int v6; // [esp+4h] [ebp-10h]
  int v7; // [esp+Ch] [ebp-8h] BYREF
  int v8; // [esp+10h] [ebp-4h] BYREF
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  if ( !MEMORY[0x100115F0] )
    sub_9506((int)&savedregs);
  MEMORY[0x10010064] = 0;
  MEMORY[0x1000B070](0, 268500832, 260, v5, v6);
  MEMORY[0x1000FDB8] = 268500832;
  if ( !MEMORY[0x100105C4] || (v0 = MEMORY[0x100105C4], !*MEMORY[0x100105C4]) )
    v0 = 268500832;
  sub_8125((char *)v0, 0, &v7, 0, &v8);
  v1 = v8;
  sub_58A7((int)&savedregs, 4 * v8 + v7);
  v3 = v2;
  if ( !v2 )
    return -1;
  sub_8125((char *)v0, (char *)&v2[v1], &v7, v2, &v8);
  MEMORY[0x1000FD9C] = v8 - 1;
  MEMORY[0x1000FDA0] = v3;
  return 0;
}
// 82BB: variable 'v5' is possibly undefined
// 82BB: variable 'v6' is possibly undefined
// 82FB: variable 'v2' is possibly undefined
// 1000B070: using guessed type int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (00008333) --------------------------------------------------------
int sub_8333()
{
  int v0; // eax
  int (*v1)(void); // edi
  int v2; // ebx
  int v3; // esi
  _WORD *i; // eax
  int (__stdcall *v5)(_DWORD, _DWORD, int, int, int, int, _DWORD, _DWORD); // edi
  int v6; // eax
  int v7; // ebp
  int v8; // eax
  _BYTE *v10; // eax
  _BYTE *v11; // esi
  int v12; // ebp
  int v13; // eax
  int v14; // edi
  int v15; // [esp+40h] [ebp-8h]
  int v16; // [esp+44h] [ebp-4h]

  v0 = MEMORY[0x10010068];
  v1 = (int (*)(void))MEMORY[0x1000B0A4];
  v2 = 0;
  v3 = 0;
  if ( !MEMORY[0x10010068] )
  {
    v3 = MEMORY[0x1000B0A4]();
    if ( v3 )
    {
      MEMORY[0x10010068] = 1;
LABEL_8:
      if ( v3 || (v3 = v1()) != 0 )
      {
        for ( i = (_WORD *)v3; *i; ++i )
        {
          do
            ++i;
          while ( *i );
        }
        v5 = MEMORY[0x1000B0A0];
        v16 = (((int)i - v3) >> 1) + 1;
        v6 = MEMORY[0x1000B0A0](0, 0, v3, v16, 0, 0, 0, 0);
        v7 = v6;
        if ( v6 )
        {
          sub_58A7(v6, v6);
          v15 = v8;
          if ( v8 )
          {
            if ( !v5(0, 0, v3, v16, v8, v7, 0, 0) )
            {
              sub_53E0(v7);
              v15 = 0;
            }
            v2 = v15;
          }
        }
        MEMORY[0x1000B09C](v3);
        return v2;
      }
      return 0;
    }
    if ( MEMORY[0x1000B050]() == 120 )
    {
      v0 = 2;
      MEMORY[0x10010068] = 2;
    }
    else
    {
      v0 = MEMORY[0x10010068];
    }
  }
  if ( v0 == 1 )
    goto LABEL_8;
  if ( v0 != 2 && v0 )
    return 0;
  v10 = (_BYTE *)MEMORY[0x1000B098]();
  v11 = v10;
  if ( !v10 )
    return 0;
  for ( ; *v10; ++v10 )
  {
    do
      ++v10;
    while ( *v10 );
  }
  v12 = v10 - v11 + 1;
  sub_58A7(v12, v12);
  v14 = v13;
  if ( v13 )
    sub_5460(v13, v11, v12);
  else
    v14 = 0;
  MEMORY[0x1000B094](v11);
  return v14;
}
// 83CA: variable 'v8' is possibly undefined
// 842F: variable 'v13' is possibly undefined
// 5460: using guessed type _DWORD __cdecl sub_5460(_DWORD, _DWORD, _DWORD);
// 1000B050: using guessed type int (*)(void);
// 1000B094: using guessed type int (__stdcall *)(_DWORD);
// 1000B098: using guessed type int (*)(void);
// 1000B09C: using guessed type int (__stdcall *)(_DWORD);
// 1000B0A0: using guessed type int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (000085D4) --------------------------------------------------------
unsigned int __cdecl sub_85D4(int a1)
{
  unsigned int result; // eax
  int v2; // esi
  _BYTE *v3; // edi
  char *v4; // ebx
  char *v5; // eax
  _DWORD **v6; // esi
  char *v7; // eax
  int v8; // eax
  int *v9; // [esp-8h] [ebp-94h]
  int v10; // [esp-4h] [ebp-90h]
  _DWORD v11[3]; // [esp+0h] [ebp-8Ch] BYREF
  _DWORD v12[32]; // [esp+Ch] [ebp-80h] BYREF
  _BYTE v13[136]; // [esp+8Ch] [ebp+0h] BYREF
  int v14; // [esp+114h] [ebp+88h]

  v14 = MEMORY[0x1000F368];
  for ( result = 0; result < 0x13; ++result )
  {
    if ( a1 == *(_DWORD *)(8 * result + 0x1000F7D0) )
      break;
  }
  v2 = 8 * result;
  if ( a1 == *(_DWORD *)(8 * result + 0x1000F7D0) )
  {
    result = MEMORY[0x1000FDDC];
    if ( MEMORY[0x1000FDDC] == 1 || !MEMORY[0x1000FDDC] && MEMORY[0x1000FDE0] == 1 )
    {
      v10 = 0;
      v9 = &a1;
      v6 = (_DWORD **)(v2 + 268498900);
      v7 = sub_5A70(*v6);
      v8 = MEMORY[0x1000B088](-12, *v6, v7, &a1, 0);
      result = MEMORY[0x1000B074](v8);
    }
    else if ( a1 != 252 )
    {
      v13[132] = 0;
      if ( !MEMORY[0x1000B070](0, v12, 260, v11[0], v11[1]) )
      {
        v10 = 268486224;
        v9 = v12;
        sub_5C70();
      }
      v3 = v12;
      if ( (unsigned int)(sub_5A70(v12) + 1) > 0x3C )
      {
        v3 = &v13[(_DWORD)sub_5A70(v12) - 187];
        sub_9620(v3, (char *)0x1000C64C, 3u);
      }
      v4 = sub_5A70(v3);
      v5 = sub_5A70(*(_DWORD **)(v2 + 268498900));
      sub_5980((int)&v5[(_DWORD)v4 + 31] & 0xFFFFFFFC, v11[0]);
      v10 = 268487832;
      v9 = v11;
      sub_5C70();
      sub_5C80(v11, v3);
      sub_5C80(v11, (_BYTE *)0x1000C648);
      sub_5C80(v11, *(_BYTE **)(v2 + 268498900));
      result = sub_9524((int)v11, 268486164, (int)&unk_12010);
    }
  }
  return result;
}
// 1000B070: using guessed type int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 1000B074: using guessed type int (__stdcall *)(_DWORD);
// 1000B088: using guessed type int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (0000874B) --------------------------------------------------------
unsigned int sub_874B()
{
  unsigned int result; // eax

  result = MEMORY[0x1000FDDC];
  if ( MEMORY[0x1000FDDC] == 1 || !MEMORY[0x1000FDDC] && MEMORY[0x1000FDE0] == 1 )
  {
    sub_85D4(252);
    if ( MEMORY[0x1001006C] )
      MEMORY[0x1001006C]();
    result = sub_85D4(255);
  }
  return result;
}
// 1001006C: using guessed type int (*)(void);

//----- (00008794) --------------------------------------------------------
void __usercall sub_8794(int a1@<ebp>)
{
  int v1; // eax
  int v2; // eax
  int v3; // [esp-8h] [ebp-8h]
  int v4; // [esp-4h] [ebp-4h]

  sub_7154(268487904, 16);
  v1 = MEMORY[0x10010070];
  if ( !MEMORY[0x10010070] )
  {
    if ( MEMORY[0x1000FD88] == 1
      || (v2 = MEMORY[0x1000B010](268486148)) == 0
      || (v1 = MEMORY[0x1000B00C](v2, 268487860), (MEMORY[0x10010070] = v1) == 0) )
    {
      v1 = 268470116;
      MEMORY[0x10010070] = 268470116;
    }
  }
  *(_DWORD *)(a1 - 4) = 0;
  *(_DWORD *)(a1 - 32) = ((int (__stdcall *)(_DWORD, _DWORD, int, int))v1)(
                           *(_DWORD *)(a1 + 8),
                           *(_DWORD *)(a1 + 12),
                           v3,
                           v4);
  *(_DWORD *)(a1 - 4) = -1;
  sub_718F();
}
// 87EA: variable 'v3' is possibly undefined
// 87EA: variable 'v4' is possibly undefined
// 1000B00C: using guessed type int (__stdcall *)(_DWORD, _DWORD);
// 1000B010: using guessed type int (__stdcall *)(_DWORD);

//----- (00008820) --------------------------------------------------------
int __cdecl sub_8820(int a1)
{
  return sub_AC3E(a1, 268470296, 0, 0);
}
// AC3E: using guessed type int __stdcall sub_AC3E(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00008862) --------------------------------------------------------
int __usercall sub_8862@<eax>(int a1@<ebp>, int a2, int a3)
{
  int result; // eax
  int v4; // ebx
  int v5; // esi
  int v6; // esi

  while ( 1 )
  {
    result = a2;
    v4 = *(_DWORD *)(a2 + 8);
    v5 = *(_DWORD *)(a2 + 12);
    if ( v5 == -1 || v5 == a3 )
      break;
    v6 = 3 * v5;
    *(_DWORD *)(a2 + 12) = *(_DWORD *)(v4 + 4 * v6);
    if ( !*(_DWORD *)(v4 + 4 * v6 + 4) )
    {
      sub_88F6(*(_DWORD *)(v4 + 4 * v6 + 8), a1, 257);
      (*(int (**)())((char *)&_S35[v6] + v4))();
    }
  }
  return result;
}
// 8: using guessed type int (*_S35[6])();

//----- (000088F6) --------------------------------------------------------
int __userpurge sub_88F6@<eax>(int result@<eax>, int a2@<ebp>, int a3)
{
  MEMORY[0x1000F870] = *(_DWORD *)(a2 + 8);
  MEMORY[0x1000F86C] = result;
  MEMORY[0x1000F874] = a2;
  return result;
}

//----- (00008910) --------------------------------------------------------
#error "896C: switch analysis failed: switch information is incomplete or incorrect (funcsize=53)"

//----- (00008C4D) --------------------------------------------------------
int __cdecl sub_8C4D(unsigned int a1)
{
  unsigned int v2; // ebx
  struct _TEB *v3; // eax
  unsigned int v5; // edi
  unsigned int v6; // edx
  unsigned int *v7; // eax
  unsigned int v8; // eax
  unsigned int v9; // edi
  int v10; // esi
  int v11; // eax
  unsigned int v12; // ebx
  int v13; // ecx
  unsigned int v14; // eax
  int v15; // ecx
  int v16; // edx
  _DWORD *v17; // eax
  int v18; // ebx
  int j; // edx
  unsigned int *v20; // eax
  unsigned int v21; // esi
  void (__thiscall *v22)(int, int, _DWORD); // ebx
  int i; // ecx
  int v24; // eax
  unsigned int *v25; // eax
  unsigned int v26; // edx
  char v27[4]; // [esp+8h] [ebp-20h] BYREF
  int v28; // [esp+Ch] [ebp-1Ch]
  char v29; // [esp+1Ch] [ebp-Ch]
  int v30; // [esp+20h] [ebp-8h]
  unsigned int v31; // [esp+24h] [ebp-4h]
  int v32; // [esp+30h] [ebp+8h]

  v2 = *(_DWORD *)(a1 + 8);
  if ( (v2 & 3) != 0 )
    return 0;
  v3 = NtCurrentTeb();
  v31 = (unsigned int)v3->NtTib.StackLimit;
  if ( v2 >= v31 && (PVOID)v2 < v3->NtTib.StackBase )
    return 0;
  v5 = *(_DWORD *)(a1 + 12);
  if ( v5 == -1 )
    return 1;
  v6 = 0;
  v32 = 0;
  v7 = (unsigned int *)v2;
  do
  {
    if ( *v7 != -1 && *v7 >= v6 )
      return 0;
    if ( v7[1] )
      ++v32;
    ++v6;
    v7 += 3;
  }
  while ( v6 <= v5 );
  if ( v32 )
  {
    v8 = *(_DWORD *)(a1 - 8);
    if ( v8 < v31 || v8 >= a1 )
      return 0;
  }
  v9 = v2 & 0xFFFFF000;
  v10 = 0;
  if ( MEMORY[0x10010078] > 0 )
  {
    while ( *(_DWORD *)(4 * v10 + 0x10010080) != v9 )
    {
      if ( ++v10 >= MEMORY[0x10010078] )
        goto LABEL_19;
    }
    if ( v10 <= 0 )
      return 1;
    v22 = (void (__thiscall *)(int, int, _DWORD))MEMORY[0x1000B0B4];
    if ( MEMORY[0x1000B0B4](268501184, 1) )
      return 1;
    if ( *(_DWORD *)(4 * v10 + 0x10010080) != v9 )
    {
      v24 = MEMORY[0x10010078];
      v10 = MEMORY[0x10010078] - 1;
      if ( MEMORY[0x10010078] - 1 < 0 )
        goto LABEL_50;
      do
      {
        if ( *(_DWORD *)(4 * v10 + 0x10010080) == v9 )
          break;
        --v10;
      }
      while ( v10 >= 0 );
      if ( v10 >= 0 )
      {
        if ( !v10 )
        {
LABEL_56:
          v22(i, 268501184, 0);
          return 1;
        }
      }
      else
      {
LABEL_50:
        if ( MEMORY[0x10010078] < 16 )
          v24 = ++MEMORY[0x10010078];
        v10 = v24 - 1;
      }
    }
    for ( i = 0; i <= v10; v9 = v26 )
    {
      v25 = (unsigned int *)(4 * i + 268501120);
      v26 = *(_DWORD *)(4 * i++ + 0x10010080);
      *v25 = v9;
    }
    goto LABEL_56;
  }
LABEL_19:
  if ( MEMORY[0x1000B0B8](v2, v27, 28) && v30 == 0x1000000 )
  {
    if ( (v29 & 0xCC) == 0 )
      goto LABEL_29;
    if ( *(_WORD *)v28 == 23117 )
    {
      v11 = v28 + *(_DWORD *)(v28 + 60);
      if ( *(_DWORD *)v11 == 17744 && *(_WORD *)(v11 + 24) == 267 )
      {
        v12 = v2 - v28;
        v13 = *(unsigned __int16 *)(v11 + 20) + v11 + 24;
        if ( *(_WORD *)(v11 + 6) )
        {
          v14 = *(_DWORD *)(*(unsigned __int16 *)(v11 + 20) + v11 + 36);
          if ( v12 < v14 || v12 >= v14 + *(_DWORD *)(v13 + 8) || *(char *)(v13 + 39) >= 0 )
          {
LABEL_29:
            if ( !MEMORY[0x1000B0B4](268501184, 1) )
            {
              v15 = MEMORY[0x10010078];
              v16 = MEMORY[0x10010078];
              if ( MEMORY[0x10010078] > 0 )
              {
                v17 = (_DWORD *)(4 * MEMORY[0x10010078] + 268501116);
                do
                {
                  if ( *v17 == v9 )
                    break;
                  --v16;
                  --v17;
                }
                while ( v16 > 0 );
              }
              if ( !v16 )
              {
                v18 = 15;
                if ( MEMORY[0x10010078] <= 15 )
                  v18 = MEMORY[0x10010078];
                for ( j = 0; j <= v18; v9 = v21 )
                {
                  v20 = (unsigned int *)(4 * j + 268501120);
                  v21 = *(_DWORD *)(4 * j++ + 0x10010080);
                  *v20 = v9;
                }
                if ( v15 < 16 )
                  MEMORY[0x10010078] = v15 + 1;
              }
              MEMORY[0x1000B0B4](268501184, 0);
            }
            return 1;
          }
          return 0;
        }
      }
    }
  }
  return -1;
}
// 8E67: variable 'i' is possibly undefined
// 1000B0B4: using guessed type int (__stdcall *)(_DWORD, _DWORD);
// 1000B0B8: using guessed type int (__stdcall *)(_DWORD, _DWORD, _DWORD);

//----- (00008E76) --------------------------------------------------------
void __usercall sub_8E76(int a1@<ebp>, int a2)
{
  int v2; // eax
  _DWORD *v3; // eax
  _DWORD *v4; // eax
  _DWORD *v5; // eax
  int v6; // eax

  v2 = *(_DWORD *)(a2 + 60);
  if ( v2 != MEMORY[0x100100F0] && v2 && !**(_DWORD **)(a2 + 44) )
  {
    v3 = *(_DWORD **)(a2 + 52);
    if ( v3 && !*v3 && v3 != (_DWORD *)MEMORY[0x10010238] )
    {
      sub_53E0(a1);
      sub_9DF7(a1, *(_DWORD **)(a2 + 60));
    }
    v4 = *(_DWORD **)(a2 + 48);
    if ( v4 && !*v4 && v4 != (_DWORD *)MEMORY[0x1001023C] )
    {
      sub_53E0(a1);
      sub_9D98(a1, *(_DWORD **)(a2 + 60));
    }
    sub_53E0(a1);
    sub_53E0(a1);
  }
  v5 = *(_DWORD **)(a2 + 64);
  if ( v5 != (_DWORD *)MEMORY[0x10010234] && v5 && !*v5 )
  {
    sub_53E0(a1);
    sub_53E0(a1);
  }
  v6 = *(_DWORD *)(a2 + 80);
  if ( v6 != MEMORY[0x100100EC] && v6 && !*(_DWORD *)(v6 + 180) )
  {
    sub_9C08(a1, *(_DWORD *)(a2 + 80));
    sub_53E0(a1);
  }
  sub_53E0(a1);
}

//----- (00008F46) --------------------------------------------------------
int __usercall sub_8F46@<eax>(int a1@<ebp>)
{
  int *v1; // esi
  _DWORD *v2; // ecx
  _DWORD *v3; // eax
  _DWORD *v4; // eax
  _DWORD *v5; // eax
  _DWORD *v6; // eax
  int v7; // eax

  v1 = sub_72FD(a1);
  v2 = (_DWORD *)v1[25];
  if ( v2 != (_DWORD *)MEMORY[0x1000F8DC] )
  {
    if ( v2 )
    {
      v3 = (_DWORD *)v2[11];
      --*v2;
      if ( v3 )
        --*v3;
      v4 = (_DWORD *)v2[13];
      if ( v4 )
        --*v4;
      v5 = (_DWORD *)v2[12];
      if ( v5 )
        --*v5;
      v6 = (_DWORD *)v2[16];
      if ( v6 )
        --*v6;
      --*(_DWORD *)(v2[19] + 180);
    }
    v1[25] = MEMORY[0x1000F8DC];
    ++*MEMORY[0x1000F8DC];
    v7 = MEMORY[0x1000F8DC];
    if ( *(_DWORD *)(MEMORY[0x1000F8DC] + 44) )
    {
      ++**(_DWORD **)(MEMORY[0x1000F8DC] + 44);
      v7 = MEMORY[0x1000F8DC];
    }
    if ( *(_DWORD *)(v7 + 52) )
    {
      ++**(_DWORD **)(v7 + 52);
      v7 = MEMORY[0x1000F8DC];
    }
    if ( *(_DWORD *)(v7 + 48) )
    {
      ++**(_DWORD **)(v7 + 48);
      v7 = MEMORY[0x1000F8DC];
    }
    if ( *(_DWORD *)(v7 + 64) )
    {
      ++**(_DWORD **)(v7 + 64);
      v7 = MEMORY[0x1000F8DC];
    }
    ++*(_DWORD *)(*(_DWORD *)(v7 + 76) + 180);
    if ( v2 && !*v2 && v2 != (_DWORD *)268499080 )
      sub_8E76(a1, (int)v2);
  }
  return v1[25];
}

//----- (00009007) --------------------------------------------------------
void __usercall sub_9007(int a1@<ebp>)
{
  sub_7154(268488304, 12);
  sub_6600(12);
  *(_DWORD *)(a1 - 4) = 0;
  *(_DWORD *)(a1 - 28) = sub_8F46(a1);
  *(_DWORD *)(a1 - 4) = -1;
  sub_9039();
  sub_718F();
}

//----- (00009039) --------------------------------------------------------
int sub_9039()
{
  return sub_654B(12);
}

//----- (00009042) --------------------------------------------------------
int __usercall sub_9042@<eax>(int a1@<eax>)
{
  int v1; // eax
  int v2; // eax
  int v3; // eax

  v1 = a1 - 932;
  if ( !v1 )
    return 1041;
  v2 = v1 - 4;
  if ( !v2 )
    return 2052;
  v3 = v2 - 13;
  if ( !v3 )
    return 1042;
  if ( v3 == 1 )
    return 1028;
  return 0;
}

//----- (00009071) --------------------------------------------------------
int sub_9071()
{
  int result; // eax

  memset((void *)0x10010260, 0, 0x100u);
  MEMORY[0x10010360] = 0;
  result = 0;
  MEMORY[0x10010364] = 0;
  MEMORY[0x10010248] = 0;
  MEMORY[0x10010240] = 0;
  MEMORY[0x10010370] = 0;
  MEMORY[0x10010374] = 0;
  MEMORY[0x10010378] = 0;
  return result;
}

//----- (0000909A) --------------------------------------------------------
unsigned int sub_909A()
{
  unsigned int i; // eax
  unsigned __int8 v1; // al
  char *v2; // edx
  unsigned int v3; // ecx
  _BYTE *v4; // edx
  unsigned int result; // eax
  __int16 v6; // cx
  char v7; // cl
  char v8; // cl
  __int16 v9[512]; // [esp+4h] [ebp-518h]
  char v10[256]; // [esp+404h] [ebp-118h] BYREF
  char v11[6]; // [esp+504h] [ebp-18h] BYREF
  unsigned __int8 v12; // [esp+50Ah] [ebp-12h]
  char v13; // [esp+50Bh] [ebp-11h] BYREF
  int v14; // [esp+518h] [ebp-4h]
  int savedregs; // [esp+51Ch] [ebp+0h] BYREF

  v14 = MEMORY[0x1000F368];
  if ( MEMORY[0x1000B0C4](MEMORY[0x10010364], v11) == 1 )
  {
    for ( i = 0; i < 0x100; ++i )
      v10[i] = i;
    v1 = v12;
    v10[0] = 32;
    if ( v12 )
    {
      v2 = &v13;
      do
      {
        v3 = (unsigned __int8)*v2;
        if ( v1 <= v3 )
          memset(&v10[v1], 0x20u, v3 - v1 + 1);
        v4 = v2 + 1;
        v1 = *v4;
        v2 = v4 + 1;
      }
      while ( v1 );
    }
    sub_A068(&savedregs);
    sub_A2B0((int)&savedregs);
    sub_A2B0((int)&savedregs);
    result = 0;
    while ( 1 )
    {
      v6 = v9[result];
      if ( (v6 & 1) != 0 )
      {
        *(_BYTE *)(result + 268501601) |= 0x10u;
        v7 = *((_BYTE *)&v9[384] + result);
      }
      else
      {
        if ( (v6 & 2) == 0 )
        {
          *(_BYTE *)(result + 268501888) = 0;
          goto LABEL_16;
        }
        *(_BYTE *)(result + 268501601) |= 0x20u;
        v7 = *((_BYTE *)&v9[256] + result);
      }
      *(_BYTE *)(result + 268501888) = v7;
LABEL_16:
      if ( ++result >= 0x100 )
        return result;
    }
  }
  for ( result = 0; result < 0x100; ++result )
  {
    if ( result >= 0x41 && result <= 0x5A )
    {
      *(_BYTE *)(result + 268501601) |= 0x10u;
      v8 = result + 32;
LABEL_22:
      *(_BYTE *)(result + 268501888) = v8;
      continue;
    }
    if ( result >= 0x61 && result <= 0x7A )
    {
      *(_BYTE *)(result + 268501601) |= 0x20u;
      v8 = result - 32;
      goto LABEL_22;
    }
    *(_BYTE *)(result + 268501888) = 0;
  }
  return result;
}
// 1000B0C4: using guessed type int (__stdcall *)(_DWORD, _DWORD);

//----- (00009226) --------------------------------------------------------
int __cdecl sub_9226(int a1)
{
  int v1; // edx
  unsigned int i; // eax
  bool v3; // cc
  char *v4; // ecx
  unsigned __int8 v5; // dl
  unsigned int k; // eax
  _BYTE *v7; // ebx
  unsigned int v8; // eax
  _BYTE *j; // esi
  unsigned __int8 v10; // dl
  unsigned int v11; // edi
  char v12; // dl
  int v13; // eax
  _DWORD *v14; // ecx
  unsigned int l; // eax
  int v16; // ecx
  int result; // eax
  unsigned int v18; // [esp+Ch] [ebp-1Ch]
  unsigned int v19; // [esp+10h] [ebp-18h] BYREF
  char v20; // [esp+16h] [ebp-12h]
  char v21; // [esp+17h] [ebp-11h] BYREF
  int v22; // [esp+24h] [ebp-4h]

  v22 = MEMORY[0x1000F368];
  if ( a1 )
  {
    v1 = 0;
    for ( i = 0; i < 0xF0; i += 48 )
    {
      if ( *(_DWORD *)(i + 268499488) == a1 )
      {
        memset((void *)0x10010260, 0, 0x100u);
        v18 = 0;
        MEMORY[0x10010360] = 0;
        v7 = (_BYTE *)(48 * v1 + 268499504);
        do
        {
          LOBYTE(v8) = *v7;
          for ( j = v7; (_BYTE)v8; LOBYTE(v8) = *j )
          {
            v10 = j[1];
            if ( !v10 )
              break;
            v8 = (unsigned __int8)v8;
            v11 = v10;
            if ( (unsigned __int8)v8 <= (unsigned int)v10 )
            {
              v12 = *(_BYTE *)(v18 + 268499480);
              do
              {
                *(_BYTE *)(v8 + 268501601) |= v12;
                ++v8;
              }
              while ( v8 <= v11 );
            }
            j += 2;
          }
          ++v18;
          v7 += 8;
        }
        while ( v18 < 4 );
        MEMORY[0x10010364] = a1;
        MEMORY[0x10010248] = 1;
        v13 = sub_9042(a1);
        v14 += 67124873;
        MEMORY[0x10010370] = *v14;
        MEMORY[0x10010374] = v14[1];
        MEMORY[0x10010240] = v13;
        MEMORY[0x10010378] = v14[2];
        goto LABEL_31;
      }
      ++v1;
    }
    if ( MEMORY[0x1000B0C4](a1, &v19) == 1 )
    {
      v3 = v19 <= 1;
      memset((void *)0x10010260, 0, 0x100u);
      MEMORY[0x10010360] = 0;
      MEMORY[0x10010364] = a1;
      MEMORY[0x10010240] = 0;
      if ( v3 )
      {
        MEMORY[0x10010248] = 0;
      }
      else
      {
        if ( v20 )
        {
          v4 = &v21;
          do
          {
            v5 = *v4;
            if ( !*v4 )
              break;
            for ( k = (unsigned __int8)*(v4 - 1); k <= v5; ++k )
              *(_BYTE *)(k + 268501601) |= 4u;
            v4 += 2;
          }
          while ( *(v4 - 1) );
        }
        for ( l = 1; l < 0xFF; ++l )
          *(_BYTE *)(l + 268501601) |= 8u;
        MEMORY[0x10010240] = sub_9042(a1);
        MEMORY[0x10010248] = v16;
      }
      MEMORY[0x10010370] = 0;
      MEMORY[0x10010374] = 0;
      MEMORY[0x10010378] = 0;
      goto LABEL_31;
    }
    if ( MEMORY[0x100100D0] )
      goto LABEL_30;
    result = -1;
  }
  else
  {
LABEL_30:
    sub_9071();
LABEL_31:
    sub_909A();
    result = 0;
  }
  return result;
}
// 9327: variable 'v14' is possibly undefined
// 9376: variable 'v16' is possibly undefined
// 1000B0C4: using guessed type int (__stdcall *)(_DWORD, _DWORD);

//----- (000093B6) --------------------------------------------------------
void __usercall sub_93B6(int a1@<ebp>)
{
  int v1; // eax
  _DWORD *v2; // esi
  _DWORD *v3; // eax
  int v4; // eax
  int i; // eax
  int j; // eax
  int k; // eax

  sub_7154(268488320, 20);
  *(_DWORD *)(a1 - 32) = -1;
  sub_6600(13);
  *(_DWORD *)(a1 - 4) = 0;
  MEMORY[0x100100D0] = 0;
  v1 = *(_DWORD *)(a1 + 8);
  switch ( v1 )
  {
    case -2:
      MEMORY[0x100100D0] = 1;
      v1 = MEMORY[0x1000B0C0]();
      break;
    case -3:
      MEMORY[0x100100D0] = 1;
      v1 = MEMORY[0x1000B0BC]();
      break;
    case -4:
      MEMORY[0x100100D0] = 1;
      v1 = MEMORY[0x10010130];
      break;
  }
  *(_DWORD *)(a1 + 8) = v1;
  if ( v1 == MEMORY[0x10010364] )
  {
    *(_DWORD *)(a1 - 32) = 0;
  }
  else
  {
    v2 = (_DWORD *)MEMORY[0x10010244];
    *(_DWORD *)(a1 - 36) = MEMORY[0x10010244];
    if ( !v2 || *v2 )
    {
      sub_58A7(a1, 0x220u);
      v2 = v3;
      *(_DWORD *)(a1 - 36) = v3;
    }
    if ( v2 )
    {
      v4 = sub_9226(*(_DWORD *)(a1 + 8));
      *(_DWORD *)(a1 - 32) = v4;
      if ( !v4 )
      {
        *v2 = 0;
        v2[1] = MEMORY[0x10010364];
        v2[2] = MEMORY[0x10010248];
        v2[3] = MEMORY[0x10010240];
        for ( i = 0; ; ++i )
        {
          *(_DWORD *)(a1 - 28) = i;
          if ( i >= 5 )
            break;
          *((_WORD *)v2 + i + 8) = *(_WORD *)(2 * i + 0x10010370);
        }
        for ( j = 0; ; ++j )
        {
          *(_DWORD *)(a1 - 28) = j;
          if ( j >= 257 )
            break;
          *((_BYTE *)v2 + j + 28) = *(_BYTE *)(j + 268501600);
        }
        for ( k = 0; ; ++k )
        {
          *(_DWORD *)(a1 - 28) = k;
          if ( k >= 256 )
            break;
          *((_BYTE *)v2 + k + 285) = *(_BYTE *)(k + 268501888);
        }
        MEMORY[0x10010244] = v2;
      }
    }
    if ( *(_DWORD *)(a1 - 32) == -1 && v2 != (_DWORD *)MEMORY[0x10010244] )
      sub_53E0(a1);
  }
  *(_DWORD *)(a1 - 4) = -1;
  sub_94FD();
  sub_718F();
}
// 9449: variable 'v3' is possibly undefined
// 1000B0BC: using guessed type int (*)(void);
// 1000B0C0: using guessed type int (*)(void);

//----- (000094FD) --------------------------------------------------------
int sub_94FD()
{
  return sub_654B(13);
}

//----- (00009506) --------------------------------------------------------
int __usercall sub_9506@<eax>(int a1@<ebp>)
{
  if ( !MEMORY[0x100115F0] )
  {
    sub_93B6(a1);
    MEMORY[0x100115F0] = 1;
  }
  return 0;
}

//----- (00009524) --------------------------------------------------------
int __cdecl sub_9524(int a1, int a2, int a3)
{
  int v3; // ebx
  int v4; // eax
  int v5; // edi
  int (__stdcall *v6)(int, int); // esi
  int v7; // eax
  char v9[12]; // [esp+Ch] [ebp-10h] BYREF
  char v10[4]; // [esp+18h] [ebp-4h] BYREF

  v3 = 0;
  if ( !MEMORY[0x100100D4] )
  {
    v4 = MEMORY[0x1000B0C8](268488432);
    v5 = v4;
    if ( !v4 )
      return 0;
    v6 = MEMORY[0x1000B00C];
    MEMORY[0x100100D4] = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD))MEMORY[0x1000B00C](v4, 268488420);
    if ( !MEMORY[0x100100D4] )
      return 0;
    MEMORY[0x100100D8] = (int (*)(void))v6(v5, 268488404);
    MEMORY[0x100100DC] = (int (__stdcall *)(_DWORD))v6(v5, 268488384);
    if ( MEMORY[0x1000FD88] == 2 )
    {
      MEMORY[0x100100E4] = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD))v6(v5, 268488356);
      if ( MEMORY[0x100100E4] )
        MEMORY[0x100100E0] = (int (*)(void))v6(v5, 268488332);
    }
  }
  if ( !MEMORY[0x100100E0]
    || (v7 = MEMORY[0x100100E0]()) != 0 && MEMORY[0x100100E4](v7, 1, v9, 12, v10) && (v9[8] & 1) != 0 )
  {
    if ( MEMORY[0x100100D8] )
    {
      v3 = MEMORY[0x100100D8]();
      if ( v3 )
      {
        if ( MEMORY[0x100100DC] )
          v3 = MEMORY[0x100100DC](v3);
      }
    }
  }
  else if ( MEMORY[0x1000FD94] < 4u )
  {
    BYTE2(a3) |= 4u;
  }
  else
  {
    BYTE2(a3) |= 0x20u;
  }
  return MEMORY[0x100100D4](v3, a1, a2, a3);
}
// 1000B00C: using guessed type int (__stdcall *)(_DWORD, _DWORD);
// 1000B0C8: using guessed type int (__stdcall *)(_DWORD);
// 100100D4: using guessed type int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD);
// 100100D8: using guessed type int (*)(void);
// 100100DC: using guessed type int (__stdcall *)(_DWORD);
// 100100E0: using guessed type int (*)(void);
// 100100E4: using guessed type int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (00009620) --------------------------------------------------------
_BYTE *__cdecl sub_9620(_BYTE *a1, char *a2, unsigned int a3)
{
  unsigned int v3; // ecx
  unsigned int v4; // ebx
  char *v5; // esi
  _BYTE *v6; // edi
  unsigned int v7; // ecx
  char v8; // al
  unsigned int v10; // ecx
  int v11; // eax
  int v12; // edx

  v3 = a3;
  if ( !a3 )
    return a1;
  v4 = a3;
  v5 = a2;
  v6 = a1;
  if ( ((unsigned __int8)a2 & 3) == 0 )
  {
    v7 = a3 >> 2;
    if ( a3 >> 2 )
      goto LABEL_21;
LABEL_10:
    while ( 1 )
    {
      v8 = *v5++;
      *v6++ = v8;
      if ( !v8 )
        break;
      if ( !--v4 )
        return a1;
    }
    while ( --v4 )
LABEL_17:
      *v6++ = v8;
    return a1;
  }
  do
  {
    v8 = *v5++;
    *v6++ = v8;
    if ( !--v3 )
      return a1;
    if ( !v8 )
    {
      while ( ((unsigned __int8)v6 & 3) != 0 )
      {
        *v6++ = 0;
        if ( !--v3 )
          return a1;
      }
      v4 = v3;
      v10 = v3 >> 2;
      if ( !v10 )
        goto LABEL_17;
      goto LABEL_31;
    }
  }
  while ( ((unsigned __int8)v5 & 3) != 0 );
  LOBYTE(v4) = v3;
  v7 = v3 >> 2;
  if ( !v7 )
  {
LABEL_9:
    v4 &= 3u;
    if ( v4 )
      goto LABEL_10;
    return a1;
  }
  while ( 1 )
  {
LABEL_21:
    v11 = (*(_DWORD *)v5 + 2130640639) ^ ~*(_DWORD *)v5;
    v12 = *(_DWORD *)v5;
    v5 += 4;
    if ( (v11 & 0x81010100) == 0 )
      goto LABEL_20;
    if ( !(_BYTE)v12 )
      break;
    if ( !BYTE1(v12) )
    {
      *(_DWORD *)v6 = (unsigned __int8)v12;
      goto LABEL_30;
    }
    if ( (v12 & 0xFF0000) == 0 )
    {
      *(_DWORD *)v6 = (unsigned __int16)v12;
      goto LABEL_30;
    }
    if ( (v12 & 0xFF000000) == 0 )
    {
      *(_DWORD *)v6 = v12;
      goto LABEL_30;
    }
LABEL_20:
    *(_DWORD *)v6 = v12;
    v6 += 4;
    if ( !--v7 )
      goto LABEL_9;
  }
  *(_DWORD *)v6 = 0;
LABEL_30:
  v6 += 4;
  v8 = 0;
  v10 = v7 - 1;
  if ( v10 )
  {
LABEL_31:
    v8 = 0;
    do
    {
      *(_DWORD *)v6 = 0;
      v6 += 4;
      --v10;
    }
    while ( v10 );
  }
  v4 &= 3u;
  if ( v4 )
    goto LABEL_17;
  return a1;
}

//----- (00009846) --------------------------------------------------------
int __usercall sub_9846@<eax>(int a1@<ebp>, int a2)
{
  _BYTE *v2; // eax

  if ( (unsigned int)a2 < MEMORY[0x10010480] )
  {
    v2 = (_BYTE *)(*(_DWORD *)(4 * (a2 >> 5) + 0x100104A0) + 36 * (a2 & 0x1F));
    if ( (v2[4] & 1) != 0 )
      return *(_DWORD *)v2;
  }
  *sub_58B9(a1) = 9;
  *sub_58C2(a1) = 0;
  return -1;
}

//----- (000099E5) --------------------------------------------------------
void __usercall sub_99E5(int a1@<ebp>)
{
  int v1; // edi
  unsigned int v2; // esi
  _DWORD *v3; // eax
  _DWORD *v4; // eax
  unsigned int v5; // eax
  _DWORD *v6; // eax
  int v7; // eax
  unsigned int v8; // eax
  int v9; // eax

  sub_7154(268489752, 20);
  v1 = *(_DWORD *)(a1 + 8);
  if ( v1 )
  {
    v2 = *(_DWORD *)(a1 + 12);
    if ( v2 )
    {
      if ( MEMORY[0x100105C0] == 3 )
      {
        do
        {
          *(_DWORD *)(a1 - 28) = 0;
          if ( v2 <= 0xFFFFFFE0 )
          {
            sub_6600(4);
            *(_DWORD *)(a1 - 4) = 0;
            v3 = (_DWORD *)sub_6679(v1);
            *(_DWORD *)(a1 - 32) = v3;
            if ( v3 )
            {
              if ( v2 <= MEMORY[0x100105AC] )
              {
                if ( sub_6B79(v3, v1, v2) )
                {
                  *(_DWORD *)(a1 - 28) = v1;
                }
                else
                {
                  v4 = sub_6E58(v2);
                  *(_DWORD *)(a1 - 28) = v4;
                  if ( v4 )
                  {
                    v5 = *(_DWORD *)(v1 - 4) - 1;
                    *(_DWORD *)(a1 - 36) = v5;
                    if ( v5 >= v2 )
                      v5 = v2;
                    sub_5460(*(_DWORD *)(a1 - 28), v1, v5);
                    v6 = (_DWORD *)sub_6679(v1);
                    *(_DWORD *)(a1 - 32) = v6;
                    sub_66A4(v6, v1);
                  }
                }
              }
              if ( !*(_DWORD *)(a1 - 28) )
              {
                if ( !v2 )
                {
                  v2 = 1;
                  *(_DWORD *)(a1 + 12) = 1;
                }
                v2 = (v2 + 15) & 0xFFFFFFF0;
                *(_DWORD *)(a1 + 12) = v2;
                v7 = MEMORY[0x1000B004](MEMORY[0x100105BC], 0, v2);
                *(_DWORD *)(a1 - 28) = v7;
                if ( v7 )
                {
                  v8 = *(_DWORD *)(v1 - 4) - 1;
                  *(_DWORD *)(a1 - 36) = v8;
                  if ( v8 >= v2 )
                    v8 = v2;
                  sub_5460(*(_DWORD *)(a1 - 28), v1, v8);
                  sub_66A4(*(_DWORD **)(a1 - 32), v1);
                }
              }
            }
            *(_DWORD *)(a1 - 4) = -1;
            sub_9B4D();
            if ( !*(_DWORD *)(a1 - 32) )
            {
              if ( !v2 )
                v2 = 1;
              v2 = (v2 + 15) & 0xFFFFFFF0;
              *(_DWORD *)(a1 + 12) = v2;
              *(_DWORD *)(a1 - 28) = MEMORY[0x1000B044](MEMORY[0x100105BC], 0, v1, v2);
            }
          }
        }
        while ( !*(_DWORD *)(a1 - 28) && MEMORY[0x1000FF3C] && sub_72A9(v2) );
      }
      else
      {
        do
        {
          v9 = 0;
          if ( v2 <= 0xFFFFFFE0 )
            v9 = MEMORY[0x1000B044](MEMORY[0x100105BC], 0, v1, v2);
        }
        while ( !v9 && MEMORY[0x1000FF3C] && sub_72A9(v2) );
      }
    }
    else
    {
      sub_53E0(a1);
    }
  }
  else
  {
    sub_58A7(a1, *(_DWORD *)(a1 + 12));
  }
  sub_718F();
}
// 9B5F: conditional instruction was optimized away because of 'esi.4 in (1..FFFFFFE0)'
// 5460: using guessed type _DWORD __cdecl sub_5460(_DWORD, _DWORD, _DWORD);
// 1000B004: using guessed type int (__stdcall *)(_DWORD, _DWORD, _DWORD);
// 1000B044: using guessed type int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00009B4D) --------------------------------------------------------
int sub_9B4D()
{
  return sub_654B(4);
}

//----- (00009B92) --------------------------------------------------------
void __usercall sub_9B92(int a1@<ebp>)
{
  int v1; // esi
  unsigned int v2; // eax

  sub_7154(268489768, 16);
  if ( MEMORY[0x100105C0] != 3 )
    goto LABEL_5;
  sub_6600(4);
  *(_DWORD *)(a1 - 4) = 0;
  v1 = *(_DWORD *)(a1 + 8);
  v2 = sub_6679(v1);
  *(_DWORD *)(a1 - 32) = v2;
  if ( v2 )
    *(_DWORD *)(a1 - 28) = *(_DWORD *)(v1 - 4) - 9;
  *(_DWORD *)(a1 - 4) = -1;
  sub_9BFF();
  if ( !*(_DWORD *)(a1 - 32) )
LABEL_5:
    MEMORY[0x1000B0D0](MEMORY[0x100105BC], 0, *(_DWORD *)(a1 + 8));
  sub_718F();
}
// 1000B0D0: using guessed type int (__cdecl *)(_DWORD, _DWORD, _DWORD);

//----- (00009BFF) --------------------------------------------------------
int sub_9BFF()
{
  return sub_654B(4);
}

//----- (00009C08) --------------------------------------------------------
void __usercall sub_9C08(int a1@<ebp>, int a2)
{
  if ( a2 )
  {
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
    sub_53E0(a1);
  }
}

//----- (00009D98) --------------------------------------------------------
void __usercall sub_9D98(int a1@<ebp>, _DWORD *a2)
{
  int v2; // eax
  int v3; // esi

  if ( a2 )
  {
    if ( *a2 != *MEMORY[0x1000FC24] && *a2 != MEMORY[0x1000FBF4] )
      sub_53E0(a1);
    v2 = a2[1];
    if ( v2 != *(_DWORD *)(MEMORY[0x1000FC24] + 4) && v2 != MEMORY[0x1000FBF8] )
      sub_53E0(a1);
    v3 = a2[2];
    if ( v3 != *(_DWORD *)(MEMORY[0x1000FC24] + 8) && v3 != MEMORY[0x1000FBFC] )
      sub_53E0(a1);
  }
}

//----- (00009DF7) --------------------------------------------------------
void __usercall sub_9DF7(int a1@<ebp>, _DWORD *a2)
{
  int v2; // eax
  int v3; // eax
  int v4; // eax
  int v5; // eax
  int v6; // eax
  int v7; // eax
  int v8; // esi

  if ( a2 )
  {
    v2 = a2[3];
    if ( v2 != *(_DWORD *)(MEMORY[0x1000FC24] + 12) && v2 != MEMORY[0x1000FC00] )
      sub_53E0(a1);
    v3 = a2[4];
    if ( v3 != *(_DWORD *)(MEMORY[0x1000FC24] + 16) && v3 != MEMORY[0x1000FC04] )
      sub_53E0(a1);
    v4 = a2[5];
    if ( v4 != *(_DWORD *)(MEMORY[0x1000FC24] + 20) && v4 != MEMORY[0x1000FC08] )
      sub_53E0(a1);
    v5 = a2[6];
    if ( v5 != *(_DWORD *)(MEMORY[0x1000FC24] + 24) && v5 != MEMORY[0x1000FC0C] )
      sub_53E0(a1);
    v6 = a2[7];
    if ( v6 != *(_DWORD *)(MEMORY[0x1000FC24] + 28) && v6 != MEMORY[0x1000FC10] )
      sub_53E0(a1);
    v7 = a2[8];
    if ( v7 != *(_DWORD *)(MEMORY[0x1000FC24] + 32) && v7 != MEMORY[0x1000FC14] )
      sub_53E0(a1);
    v8 = a2[9];
    if ( v8 != *(_DWORD *)(MEMORY[0x1000FC24] + 36) && v8 != MEMORY[0x1000FC18] )
      sub_53E0(a1);
  }
}

//----- (0000A068) --------------------------------------------------------
void __usercall sub_A068(_DWORD *a1@<ebp>)
{
  int v1; // esi
  int v2; // eax
  int v3; // edi
  unsigned __int8 *v4; // esi
  unsigned __int8 *v5; // eax
  int v6; // eax
  int v7; // ebx
  int v8; // edi
  int v9; // eax
  int v10; // eax
  unsigned __int8 v11[8]; // [esp-8h] [ebp-8h] BYREF

  sub_7154(268490088, 28);
  v1 = 0;
  if ( !MEMORY[0x10010138] )
  {
    if ( MEMORY[0x1000B0E0](1, 268490080, 1, a1 - 7) )
    {
      MEMORY[0x10010138] = 1;
    }
    else if ( MEMORY[0x1000B050]() == 120 )
    {
      MEMORY[0x10010138] = 2;
    }
  }
  if ( MEMORY[0x10010138] == 2 || !MEMORY[0x10010138] )
  {
    v7 = a1[7];
    if ( !v7 )
      v7 = MEMORY[0x10010120];
    v8 = a1[6];
    if ( !v8 )
      v8 = MEMORY[0x10010130];
    v9 = sub_A839(v7);
    if ( v9 != -1 )
    {
      if ( v9 != v8 )
      {
        sub_A87C((int)a1);
        v1 = v10;
        if ( !v10 )
          goto LABEL_31;
        a1[3] = v10;
      }
      MEMORY[0x1000B0D8](v7, a1[2], a1[3], a1[4], a1[5]);
      if ( v1 )
        sub_53E0((int)a1);
    }
  }
  else if ( MEMORY[0x10010138] == 1 )
  {
    *(a1 - 9) = 0;
    *(a1 - 8) = 0;
    if ( !a1[6] )
      a1[6] = MEMORY[0x10010130];
    v2 = MEMORY[0x1000B0DC](a1[6], 8 * (a1[8] != 0) + 1, a1[3], a1[4], 0, 0);
    v3 = v2;
    *(a1 - 10) = v2;
    if ( v2 )
    {
      *(a1 - 1) = 0;
      sub_5980((2 * v2 + 3) & 0xFFFFFFFC, v11[0]);
      *(a1 - 6) = v11;
      v4 = v11;
      *(a1 - 11) = v11;
      sub_57A0(v11, 0, 2 * v3);
      *(a1 - 1) = -1;
      if ( !v11 )
      {
        sub_6070((int)a1);
        v4 = v5;
        if ( !v5 )
          goto LABEL_31;
        *(a1 - 8) = 1;
      }
      v6 = MEMORY[0x1000B0DC](a1[6], 1, a1[3], a1[4], v4, v3);
      if ( v6 )
        *(a1 - 9) = MEMORY[0x1000B0E0](a1[2], v4, v6, a1[5]);
      if ( *(a1 - 8) )
        sub_53E0((int)a1);
    }
  }
LABEL_31:
  sub_718F();
}
// A164: variable 'v5' is possibly undefined
// A1EE: variable 'v10' is possibly undefined
// 1000B050: using guessed type int (*)(void);
// 1000B0D8: using guessed type int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 1000B0DC: using guessed type int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 1000B0E0: using guessed type int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (0000A2B0) --------------------------------------------------------
void __usercall sub_A2B0(int a1@<ebp>)
{
  int v1; // ecx
  _BYTE *v2; // eax
  int v3; // eax
  int v4; // esi
  int v5; // eax
  int v6; // eax
  int v7; // edi
  int v8; // eax
  int v9; // eax
  int v10; // eax
  int v11; // eax
  unsigned int v12; // esi
  unsigned __int8 *v13; // edi
  unsigned __int8 *v14; // eax
  int v15; // eax
  unsigned __int8 v16[8]; // [esp-8h] [ebp-8h] BYREF

  sub_7154(268490104, 56);
  if ( !MEMORY[0x10010160] )
  {
    if ( MEMORY[0x1000B0E8](0, 256, 268490080, 1, 0, 0) )
    {
      MEMORY[0x10010160] = 1;
    }
    else if ( MEMORY[0x1000B050]() == 120 )
    {
      MEMORY[0x10010160] = 2;
    }
  }
  if ( *(int *)(a1 + 20) > 0 )
  {
    v1 = *(_DWORD *)(a1 + 20);
    v2 = *(_BYTE **)(a1 + 16);
    while ( 1 )
    {
      --v1;
      if ( !*v2 )
        break;
      ++v2;
      if ( !v1 )
      {
        v1 = -1;
        break;
      }
    }
    *(_DWORD *)(a1 + 20) += -1 - v1;
  }
  if ( MEMORY[0x10010160] == 2 || !MEMORY[0x10010160] )
  {
    *(_DWORD *)(a1 - 40) = 0;
    *(_DWORD *)(a1 - 60) = 0;
    if ( !*(_DWORD *)(a1 + 8) )
      *(_DWORD *)(a1 + 8) = MEMORY[0x10010120];
    if ( !*(_DWORD *)(a1 + 32) )
      *(_DWORD *)(a1 + 32) = MEMORY[0x10010130];
    v9 = sub_A839(*(_DWORD *)(a1 + 8));
    *(_DWORD *)(a1 - 64) = v9;
    if ( v9 == -1 )
      goto LABEL_59;
    if ( v9 == *(_DWORD *)(a1 + 32) )
    {
      MEMORY[0x1000B0E4](
        *(_DWORD *)(a1 + 8),
        *(_DWORD *)(a1 + 12),
        *(_DWORD *)(a1 + 16),
        *(_DWORD *)(a1 + 20),
        *(_DWORD *)(a1 + 24),
        *(_DWORD *)(a1 + 28));
LABEL_57:
      if ( *(_DWORD *)(a1 - 40) )
        sub_53E0(a1);
      goto LABEL_59;
    }
    sub_A87C(a1);
    *(_DWORD *)(a1 - 40) = v10;
    if ( !v10 )
      goto LABEL_59;
    v11 = MEMORY[0x1000B0E4](*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), v10, *(_DWORD *)(a1 + 20), 0, 0);
    v12 = v11;
    *(_DWORD *)(a1 - 36) = v11;
    if ( v11 )
    {
      *(_DWORD *)(a1 - 4) = 0;
      sub_5980((v11 + 3) & 0xFFFFFFFC, v16[0]);
      *(_DWORD *)(a1 - 24) = v16;
      v13 = v16;
      *(_DWORD *)(a1 - 68) = v16;
      sub_57A0(v16, 0, v12);
      *(_DWORD *)(a1 - 4) = -1;
      if ( v16 )
        goto LABEL_51;
      sub_58A7(a1, *(_DWORD *)(a1 - 36));
      v13 = v14;
      if ( v14 )
      {
        sub_57A0(v14, 0, *(_DWORD *)(a1 - 36));
        *(_DWORD *)(a1 - 60) = 1;
LABEL_51:
        v15 = MEMORY[0x1000B0E4](
                *(_DWORD *)(a1 + 8),
                *(_DWORD *)(a1 + 12),
                *(_DWORD *)(a1 - 40),
                *(_DWORD *)(a1 + 20),
                v13,
                *(_DWORD *)(a1 - 36));
        *(_DWORD *)(a1 - 36) = v15;
        if ( v15 )
          sub_A87C(a1);
        goto LABEL_54;
      }
    }
LABEL_54:
    if ( *(_DWORD *)(a1 - 60) )
      sub_53E0(a1);
    goto LABEL_57;
  }
  if ( MEMORY[0x10010160] == 1 )
  {
    *(_DWORD *)(a1 - 44) = 0;
    *(_DWORD *)(a1 - 56) = 0;
    *(_DWORD *)(a1 - 52) = 0;
    if ( !*(_DWORD *)(a1 + 32) )
      *(_DWORD *)(a1 + 32) = MEMORY[0x10010130];
    v3 = MEMORY[0x1000B0DC](
           *(_DWORD *)(a1 + 32),
           8 * (*(_DWORD *)(a1 + 36) != 0) + 1,
           *(_DWORD *)(a1 + 16),
           *(_DWORD *)(a1 + 20),
           0,
           0);
    v4 = v3;
    *(_DWORD *)(a1 - 48) = v3;
    if ( v3 )
    {
      *(_DWORD *)(a1 - 4) = 1;
      sub_5980((2 * v3 + 3) & 0xFFFFFFFC, v16[0]);
      *(_DWORD *)(a1 - 24) = v16;
      *(_DWORD *)(a1 - 28) = v16;
      *(_DWORD *)(a1 - 4) = -1;
      if ( !*(_DWORD *)(a1 - 28) )
      {
        sub_58A7(a1, 2 * v4);
        *(_DWORD *)(a1 - 28) = v5;
        if ( !v5 )
          goto LABEL_59;
        *(_DWORD *)(a1 - 56) = 1;
      }
      if ( !MEMORY[0x1000B0DC](
              *(_DWORD *)(a1 + 32),
              1,
              *(_DWORD *)(a1 + 16),
              *(_DWORD *)(a1 + 20),
              *(_DWORD *)(a1 - 28),
              v4) )
        goto LABEL_34;
      v6 = MEMORY[0x1000B0E8](*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), *(_DWORD *)(a1 - 28), v4, 0, 0);
      v7 = v6;
      *(_DWORD *)(a1 - 44) = v6;
      if ( !v6 )
        goto LABEL_34;
      if ( (*(_BYTE *)(a1 + 13) & 4) != 0 )
      {
        if ( *(_DWORD *)(a1 + 28) && v6 <= *(_DWORD *)(a1 + 28) )
          MEMORY[0x1000B0E8](
            *(_DWORD *)(a1 + 8),
            *(_DWORD *)(a1 + 12),
            *(_DWORD *)(a1 - 28),
            v4,
            *(_DWORD *)(a1 + 24),
            *(_DWORD *)(a1 + 28));
        goto LABEL_34;
      }
      *(_DWORD *)(a1 - 4) = 2;
      sub_5980((2 * v6 + 3) & 0xFFFFFFFC, v16[0]);
      *(_DWORD *)(a1 - 24) = v16;
      *(_DWORD *)(a1 - 32) = v16;
      *(_DWORD *)(a1 - 4) = -1;
      if ( !*(_DWORD *)(a1 - 32) )
      {
        sub_58A7(a1, 2 * v7);
        *(_DWORD *)(a1 - 32) = v8;
        if ( !v8 )
        {
LABEL_34:
          if ( *(_DWORD *)(a1 - 52) )
            sub_53E0(a1);
          if ( *(_DWORD *)(a1 - 56) )
            sub_53E0(a1);
          goto LABEL_59;
        }
        *(_DWORD *)(a1 - 52) = 1;
      }
      if ( MEMORY[0x1000B0E8](
             *(_DWORD *)(a1 + 8),
             *(_DWORD *)(a1 + 12),
             *(_DWORD *)(a1 - 28),
             v4,
             *(_DWORD *)(a1 - 32),
             v7) )
      {
        if ( *(_DWORD *)(a1 + 28) )
          MEMORY[0x1000B0A0](
            *(_DWORD *)(a1 + 32),
            0,
            *(_DWORD *)(a1 - 32),
            v7,
            *(_DWORD *)(a1 + 24),
            *(_DWORD *)(a1 + 28),
            0,
            0);
        else
          MEMORY[0x1000B0A0](*(_DWORD *)(a1 + 32), 0, *(_DWORD *)(a1 - 32), v7, 0, 0, 0, 0);
      }
      goto LABEL_34;
    }
  }
LABEL_59:
  sub_718F();
}
// A3D0: variable 'v5' is possibly undefined
// A49E: variable 'v8' is possibly undefined
// A560: variable 'v10' is possibly undefined
// A5CA: variable 'v14' is possibly undefined
// 1000B050: using guessed type int (*)(void);
// 1000B0A0: using guessed type int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 1000B0DC: using guessed type int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 1000B0E4: using guessed type int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 1000B0E8: using guessed type int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (0000A7B1) --------------------------------------------------------
int __usercall sub_A7B1@<eax>(int a1@<ebp>, unsigned __int8 *a2)
{
  _DWORD *v2; // edi
  _DWORD *v3; // eax
  int v5; // eax
  int v7; // ecx
  unsigned __int8 *v8; // esi
  int v9; // edx
  int result; // eax
  int v11; // ecx

  v2 = (_DWORD *)sub_72FD(a1)[25];
  if ( v2 != (_DWORD *)MEMORY[0x1000F8DC] )
  {
    sub_9007(a1);
    v2 = v3;
  }
  while ( 1 )
  {
    v5 = *a2;
    if ( !((int)v2[10] <= 1 ? *(_BYTE *)(v2[18] + 2 * v5) & 8 : sub_AA45(v2, v5, 8)) )
      break;
    ++a2;
  }
  v7 = *a2;
  v8 = a2 + 1;
  v9 = v7;
  if ( v7 == 45 || v7 == 43 )
    v7 = *v8++;
  result = 0;
  while ( 1 )
  {
    v11 = v7 < 48 || v7 > 57 ? -1 : v7 - 48;
    if ( v11 == -1 )
      break;
    result = v11 + 10 * result;
    v7 = *v8++;
  }
  if ( v9 == 45 )
    result = -result;
  return result;
}
// A7C8: variable 'v3' is possibly undefined

//----- (0000A839) --------------------------------------------------------
int __cdecl sub_A839(int a1)
{
  int result; // eax
  unsigned __int8 v2[8]; // [esp+0h] [ebp-Ch] BYREF
  int v3; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v3 = MEMORY[0x1000F368];
  v2[6] = 0;
  if ( MEMORY[0x1000B0D4](a1, 4100, v2, 6) )
    result = sub_A7B1((int)&savedregs, v2);
  else
    result = -1;
  return result;
}
// 1000B0D4: using guessed type int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (0000A87C) --------------------------------------------------------
void __usercall sub_A87C(int a1@<ebp>)
{
  int v1; // ebx
  int v2; // eax
  int (__stdcall *v3)(_DWORD, int); // esi
  int v4; // esi
  unsigned __int8 *v5; // ebx
  unsigned __int8 *v6; // eax
  int v7; // eax
  int v8; // eax
  unsigned __int8 v9[8]; // [esp-8h] [ebp-8h] BYREF

  sub_7154(268490208, 56);
  *(_DWORD *)(a1 - 28) = MEMORY[0x1000F368];
  *(_DWORD *)(a1 - 52) = 0;
  *(_DWORD *)(a1 - 68) = 0;
  v1 = **(_DWORD **)(a1 + 20);
  *(_DWORD *)(a1 - 64) = v1;
  *(_DWORD *)(a1 - 60) = 0;
  v2 = *(_DWORD *)(a1 + 8);
  if ( v2 == *(_DWORD *)(a1 + 12) )
  {
LABEL_30:
    if ( *(_DWORD *)(a1 - 68) )
      sub_53E0(a1);
    goto LABEL_32;
  }
  v3 = MEMORY[0x1000B0C4];
  if ( MEMORY[0x1000B0C4](v2, a1 - 48)
    && *(_DWORD *)(a1 - 48) == 1
    && v3(*(_DWORD *)(a1 + 12), a1 - 48)
    && *(_DWORD *)(a1 - 48) == 1 )
  {
    *(_DWORD *)(a1 - 60) = 1;
  }
  if ( *(_DWORD *)(a1 - 60) )
  {
    if ( v1 == -1 )
      v4 = (int)(sub_5A70(*(_DWORD **)(a1 + 16)) + 1);
    else
      v4 = v1;
    *(_DWORD *)(a1 - 56) = v4;
  }
  else
  {
    v4 = *(_DWORD *)(a1 - 56);
  }
  if ( *(_DWORD *)(a1 - 60)
    || (v4 = MEMORY[0x1000B0DC](*(_DWORD *)(a1 + 8), 1, *(_DWORD *)(a1 + 16), v1, 0, 0), (*(_DWORD *)(a1 - 56) = v4) != 0) )
  {
    *(_DWORD *)(a1 - 4) = 0;
    sub_5980((2 * v4 + 3) & 0xFFFFFFFC, v9[0]);
    *(_DWORD *)(a1 - 24) = v9;
    v5 = v9;
    *(_DWORD *)(a1 - 72) = v9;
    sub_57A0(v9, 0, 2 * v4);
    *(_DWORD *)(a1 - 4) = -1;
    if ( !v9 )
    {
      sub_6070(a1);
      v5 = v6;
      if ( !v6 )
        goto LABEL_32;
      *(_DWORD *)(a1 - 68) = 1;
    }
    if ( MEMORY[0x1000B0DC](*(_DWORD *)(a1 + 8), 1, *(_DWORD *)(a1 + 16), *(_DWORD *)(a1 - 64), v5, v4) )
    {
      if ( *(_DWORD *)(a1 + 24) )
      {
        if ( MEMORY[0x1000B0A0](*(_DWORD *)(a1 + 12), 0, v5, v4, *(_DWORD *)(a1 + 24), *(_DWORD *)(a1 + 28), 0, 0) )
          *(_DWORD *)(a1 - 52) = *(_DWORD *)(a1 + 24);
      }
      else if ( *(_DWORD *)(a1 - 60) || (v4 = MEMORY[0x1000B0A0](*(_DWORD *)(a1 + 12), 0, v5, v4, 0, 0, 0, 0)) != 0 )
      {
        sub_6070(a1);
        *(_DWORD *)(a1 - 52) = v7;
        if ( v7 )
        {
          v8 = MEMORY[0x1000B0A0](*(_DWORD *)(a1 + 12), 0, v5, v4, v7, v4, 0, 0);
          if ( v8 )
          {
            if ( *(_DWORD *)(a1 - 64) != -1 )
              **(_DWORD **)(a1 + 20) = v8;
          }
          else
          {
            sub_53E0(a1);
            *(_DWORD *)(a1 - 52) = 0;
          }
        }
      }
    }
    goto LABEL_30;
  }
LABEL_32:
  sub_596F(*(_DWORD *)(a1 - 28), a1);
  sub_718F();
}
// A973: variable 'v6' is possibly undefined
// A9EC: variable 'v7' is possibly undefined
// 1000B0A0: using guessed type int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 1000B0C4: using guessed type int (__stdcall *)(_DWORD, _DWORD);
// 1000B0DC: using guessed type int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (0000AA45) --------------------------------------------------------
int __cdecl sub_AA45(_DWORD *a1, int a2, int a3)
{
  int v3; // ecx
  int v4; // eax
  int v5; // eax
  int result; // eax
  int v7; // [esp+0h] [ebp-4h] BYREF

  v7 = v3;
  if ( (unsigned int)(a2 + 1) <= 0x100 )
  {
    v4 = *(unsigned __int16 *)(a1[18] + 2 * a2);
    return a3 & v4;
  }
  if ( *(char *)(a1[18] + 2 * BYTE1(a2) + 1) >= 0 )
  {
    LOWORD(v7) = (unsigned __int8)a2;
    v5 = 1;
  }
  else
  {
    *(_WORD *)((char *)&v7 + 1) = (unsigned __int8)a2;
    LOBYTE(v7) = BYTE1(a2);
    v5 = 2;
  }
  result = sub_A068(1, &v7, v5, (char *)&a2 + 2, a1[1], a1[5], 1);
  if ( result )
  {
    v4 = HIWORD(a2);
    return a3 & v4;
  }
  return result;
}
// AA48: variable 'v3' is possibly undefined
// A068: using guessed type int __cdecl sub_A068(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (00012078) --------------------------------------------------------
void __cdecl decrypt(void **a1, int *a2, unsigned __int8 *a3, int a4)
{
  unsigned int *v4; // edi
  CProtectedString *v5; // eax
  char *v6; // eax
  void (__stdcall *v7)(const void **, unsigned int *, unsigned __int8 *, int); // esi
  CProtectedString *v8; // eax
  char *v9; // eax
  void (*v10)(void); // ebx
  void *v11; // eax
  const void *v12; // esi
  struct _IMAGE_DOS_HEADER *v13; // [esp+30h] [ebp-14h] BYREF
  const void *v14; // [esp+34h] [ebp-10h] BYREF
  unsigned int v15[2]; // [esp+38h] [ebp-Ch] BYREF
  int v16; // [esp+40h] [ebp-4h]

  v16 = -1;
  v15[1] = (unsigned int)&_L31384;
  v15[0] = __readfsdword((unsigned int)&_except_list);
  __writefsdword((unsigned int)&_except_list, (unsigned int)v15);
  v4 = (unsigned int *)a2;
  *a1 = 0;
  v13 = 0;
  v14 = 0;
  *v4 = 0;
  if ( !LoadPbDllFromMemory(&lpziplib, (void **)&v13) )
  {
    v5 = CProtectedString::CProtectedString((CProtectedString *)&a2, &`string'[-79108541], 7, 0xF4u, 0xFB48E643);
    v16 = 0;
    v6 = CProtectedString::Str(v5);
    v7 = (void (__stdcall *)(const void **, unsigned int *, unsigned __int8 *, int))GetProcAddressDirectly(v13, v6);
    v16 = -1;
    CProtectedString::~CProtectedString((CProtectedString *)&a2);
    v8 = CProtectedString::CProtectedString(
           (CProtectedString *)&a2,
           (char *)&`string' + 680490288,
           10,
           0xCDu,
           0x288F7530u);
    v16 = 1;
    v9 = CProtectedString::Str(v8);
    v10 = (void (*)(void))GetProcAddressDirectly(v13, v9);
    v16 = -1;
    CProtectedString::~CProtectedString((CProtectedString *)&a2);
    if ( v7 && v10 )
    {
      v7(&v14, v4, a3, a4);
      v11 = operator new(*v4);
      v12 = v14;
      *a1 = v11;
      qmemcpy(v11, v12, *v4);
      v10();
      v14 = 0;
    }
    UnloadPbDllFromMemory(v13);
  }
  __writefsdword((unsigned int)&_except_list, v15[0]);
}

//----- (000121C8) --------------------------------------------------------
void __usercall _L31378(int a1@<ebp>)
{
  CProtectedString::~CProtectedString((CProtectedString *)(a1 + 8));
}

//----- (00012228) --------------------------------------------------------
void __cdecl __noreturn Interface_SeTranslator(unsigned int pExceptionObject)
{
  _CxxThrowException(&pExceptionObject, (_ThrowInfo *)&_TI1I);
}

//----- (00012288) --------------------------------------------------------
int _E34()
{
  _E31();
  return _E33();
}

//----- (00012298) --------------------------------------------------------
CProtectedAddress *_E31()
{
  return CProtectedAddress::CProtectedAddress((CProtectedAddress *)&g_client_Protected, 0);
}

//----- (000122A8) --------------------------------------------------------
int _E33()
{
  return atexit(_E32);
}

//----- (000122B8) --------------------------------------------------------
void __cdecl _E32()
{
  CProtectedAddress::~CProtectedAddress((CProtectedAddress *)&g_client_Protected);
}

//----- (000122C8) --------------------------------------------------------
int _E39()
{
  _E36();
  return _E38();
}

//----- (000122D8) --------------------------------------------------------
CProtectedAddress *_E36()
{
  return CProtectedAddress::CProtectedAddress((CProtectedAddress *)&lpImageDll_Protected, 0);
}

//----- (000122E8) --------------------------------------------------------
int _E38()
{
  return atexit(_E37);
}

//----- (000122F8) --------------------------------------------------------
void __cdecl _E37()
{
  CProtectedAddress::~CProtectedAddress((CProtectedAddress *)&lpImageDll_Protected);
}

//----- (00012308) --------------------------------------------------------
int _E44()
{
  _E41();
  return _E43();
}

//----- (00012318) --------------------------------------------------------
MutexBuffer_T *_E41()
{
  return MutexBuffer_T::MutexBuffer_T(&g_muextBuffer);
}

//----- (00012328) --------------------------------------------------------
int _E43()
{
  return atexit(_E42);
}

//----- (00012338) --------------------------------------------------------
void __cdecl _E42()
{
  MutexBuffer_T::~MutexBuffer_T(&g_muextBuffer);
}

//----- (00012348) --------------------------------------------------------
void __thiscall MutexBuffer_T::~MutexBuffer_T(LPCRITICAL_SECTION lpCriticalSection)
{
  unsigned int v1[3]; // [esp+4h] [ebp-Ch] BYREF

  v1[1] = (unsigned int)&_L31427;
  v1[0] = __readfsdword((unsigned int)&_except_list);
  __writefsdword((unsigned int)&_except_list, (unsigned int)v1);
  v1[2] = -1;
  DeleteCriticalSection(lpCriticalSection);
  __writefsdword((unsigned int)&_except_list, v1[0]);
}

//----- (00012388) --------------------------------------------------------
void __usercall _L31421(int a1@<ebp>)
{
  CSHMutex::~CSHMutex(*(LPCRITICAL_SECTION *)(a1 - 16));
}

//----- (000123C4) --------------------------------------------------------
MutexBuffer_T *__thiscall MutexBuffer_T::MutexBuffer_T(LPCRITICAL_SECTION lpCriticalSection)
{
  MutexBuffer_T *result; // eax
  unsigned int v3[3]; // [esp+4h] [ebp-Ch] BYREF

  v3[2] = -1;
  v3[1] = (unsigned int)&_L31439;
  v3[0] = __readfsdword((unsigned int)&_except_list);
  __writefsdword((unsigned int)&_except_list, (unsigned int)v3);
  InitializeCriticalSection(lpCriticalSection);
  result = (MutexBuffer_T *)lpCriticalSection;
  __writefsdword((unsigned int)&_except_list, v3[0]);
  return result;
}

//----- (00012404) --------------------------------------------------------
void __usercall _L31433(int a1@<ebp>)
{
  CSHMutex::~CSHMutex(*(LPCRITICAL_SECTION *)(a1 - 16));
}

//----- (00012440) --------------------------------------------------------
int _E49()
{
  _E46();
  return _E48();
}

//----- (00012450) --------------------------------------------------------
CProtectedAddress *_E46()
{
  return CProtectedAddress::CProtectedAddress((CProtectedAddress *)&pcodedata_Protected, 0);
}

//----- (00012460) --------------------------------------------------------
int _E48()
{
  return atexit(_E47);
}

//----- (00012470) --------------------------------------------------------
void __cdecl _E47()
{
  CProtectedAddress::~CProtectedAddress((CProtectedAddress *)&pcodedata_Protected);
}

//----- (00012480) --------------------------------------------------------
int _E54()
{
  _E51();
  return _E53();
}

//----- (00012490) --------------------------------------------------------
CProtectedAddress *_E51()
{
  return CProtectedAddress::CProtectedAddress((CProtectedAddress *)&ncodedatalen_Protected, 0);
}

//----- (000124A0) --------------------------------------------------------
int _E53()
{
  return atexit(_E52);
}

//----- (000124B0) --------------------------------------------------------
void __cdecl _E52()
{
  CProtectedAddress::~CProtectedAddress((CProtectedAddress *)&ncodedatalen_Protected);
}

//----- (000124C0) --------------------------------------------------------
void __userpurge CHCSetCodeData(int a1@<edi>, const void *a2, int a3)
{
  void *v3; // eax
  void *v4; // eax
  int v5; // [esp+0h] [ebp-1Ch]
  int v6; // [esp+Ch] [ebp-10h]
  int v7; // [esp+Ch] [ebp-10h]
  int v8; // [esp+Ch] [ebp-10h]
  unsigned int v9[2]; // [esp+10h] [ebp-Ch] BYREF
  int v10; // [esp+18h] [ebp-4h]

  v10 = -1;
  v9[1] = (unsigned int)&_L31493;
  v9[0] = __readfsdword((unsigned int)&_except_list);
  __writefsdword((unsigned int)&_except_list, (unsigned int)v9);
  EnterCriticalSection(&g_muextBuffer);
  v10 = 0;
  if ( CProtectedAddress::operator()(&pcodedata_Protected, &g_muextBuffer) )
  {
    v3 = (void *)CProtectedAddress::operator()(&pcodedata_Protected, v6);
    operator delete(v3);
    CProtectedAddress::operator=(&pcodedata_Protected, 0);
    CProtectedAddress::operator=(&ncodedatalen_Protected, 0);
    dword_12044 = CProtectedAddress::operator()(&pcodedata_Protected, v7);
    dword_12048 = CProtectedAddress::operator()(&ncodedatalen_Protected, v8);
  }
  if ( a2 && a3 > 0 )
  {
    v4 = operator new(a3);
    qmemcpy(v4, a2, a3);
    CProtectedAddress::operator=(&pcodedata_Protected, v4);
    CProtectedAddress::operator=(&ncodedatalen_Protected, a3);
    dword_12044 = CProtectedAddress::operator()(&pcodedata_Protected, a1);
    dword_12048 = CProtectedAddress::operator()(&ncodedatalen_Protected, v5);
    v10 = -1;
    LeaveCriticalSection(&g_muextBuffer);
    __writefsdword((unsigned int)&_except_list, v9[0]);
  }
  else
  {
    v10 = -1;
    LeaveCriticalSection(&g_muextBuffer);
    __writefsdword((unsigned int)&_except_list, v9[0]);
  }
}
// 124C0: could not find valid save-restore pair for edi
// 12504: variable 'v6' is possibly undefined
// 1252F: variable 'v7' is possibly undefined
// 1253E: variable 'v8' is possibly undefined
// 125A0: variable 'v5' is possibly undefined
// 12044: using guessed type int dword_12044;
// 12048: using guessed type int dword_12048;
// 132C4: using guessed type int __thiscall CProtectedAddress::operator=(_DWORD, _DWORD);
// 132CC: using guessed type int __thiscall CProtectedAddress::operator()(_DWORD, _DWORD);

//----- (00012600) --------------------------------------------------------
void __usercall _L31463(int a1@<ebp>)
{
  CSHMutexLock::~CSHMutexLock((CSHMutexLock *)(a1 - 16));
}

//----- (0001263C) --------------------------------------------------------
#error "12641: call analysis failed (funcsize=22)"

//----- (0001269C) --------------------------------------------------------
unsigned int __usercall load_lib@<eax>(int a1@<edi>)
{
  CProtectedString *v1; // eax
  unsigned int result; // eax
  unsigned int v3; // ebp
  void *v4; // eax
  int v5; // eax
  unsigned __int8 *v6; // eax
  unsigned int v7; // edi
  int v8; // [esp+18h] [ebp-168h]
  int v9; // [esp+18h] [ebp-168h]
  int v10; // [esp+18h] [ebp-168h]
  void *v11; // [esp+2Ch] [ebp-154h] BYREF
  void *v12; // [esp+30h] [ebp-150h] BYREF
  const void *v13; // [esp+34h] [ebp-14Ch]
  unsigned int v14; // [esp+38h] [ebp-148h]
  int v15; // [esp+3Ch] [ebp-144h]
  int v16; // [esp+40h] [ebp-140h] BYREF
  int v17; // [esp+48h] [ebp-138h] BYREF
  int v18; // [esp+50h] [ebp-130h]
  int v19; // [esp+58h] [ebp-128h]
  int v20; // [esp+60h] [ebp-120h]
  int v21; // [esp+68h] [ebp-118h]
  int v22; // [esp+70h] [ebp-110h]
  CHAR Str[4]; // [esp+74h] [ebp-10Ch] BYREF
  unsigned int v24[2]; // [esp+174h] [ebp-Ch] BYREF
  int v25; // [esp+17Ch] [ebp-4h]

  v25 = -1;
  v24[1] = (unsigned int)&_L31580;
  v24[0] = __readfsdword((unsigned int)&_except_list);
  __writefsdword((unsigned int)&_except_list, (unsigned int)v24);
  v16 = (int)&g_muextBuffer;
  EnterCriticalSection(&g_muextBuffer);
  v25 = 0;
  v15 = 0;
  if ( CProtectedAddress::operator()(&ncodedatalen_Protected, a1) <= 0
    || !CProtectedAddress::operator()(&pcodedata_Protected, v8) )
  {
    GetModuleFileNameA(0, Str, 0xFFu);
    strrchr(Str, 92)[1] = 0;
    v1 = CProtectedString::CProtectedString(
           (CProtectedString *)&v11,
           (char *)&`string' + 315042205,
           10,
           0x7Bu,
           0x12C7299Du);
    LOBYTE(v25) = 1;
    strcat(Str, CProtectedString::Str(v1));
    LOBYTE(v25) = 0;
    CProtectedString::~CProtectedString((CProtectedString *)&v11);
    CFileMapping::CFileMapping((CFileMapping *)&v12);
    LOBYTE(v25) = 2;
    CFileMapping::OpenRead((CFileMapping *)&v12, Str, 0, 0);
    if ( !v13 )
    {
      LOBYTE(v25) = 0;
      CFileMapping::~CFileMapping((CFileMapping *)&v12);
      v25 = -1;
      LeaveCriticalSection(&g_muextBuffer);
      result = -13;
      goto LABEL_18;
    }
    v3 = v14;
    v4 = operator new(v14);
    qmemcpy(v4, v13, v3);
    CProtectedAddress::operator=(&pcodedata_Protected, v4);
    CProtectedAddress::operator=(&ncodedatalen_Protected, v3);
    dword_12044 = CProtectedAddress::operator()(&pcodedata_Protected, v8);
    dword_12048 = CProtectedAddress::operator()(&ncodedatalen_Protected, v9);
    LOBYTE(v25) = 0;
    CFileMapping::~CFileMapping((CFileMapping *)&v12);
  }
  v5 = CProtectedAddress::operator()(&ncodedatalen_Protected, v8);
  v6 = (unsigned __int8 *)CProtectedAddress::operator()(&pcodedata_Protected, v5);
  decrypt(&v11, &v16, v6, v10);
  v12 = 0;
  v7 = LoadAHPe(v11, &v12, (struct AHPE_ExportFunction_T *)&v17);
  if ( v7 )
  {
    if ( v11 )
      operator delete(v11);
    v11 = 0;
    CProtectedAddress::operator=(&lpImageDll_Protected, 0);
    v25 = -1;
    LeaveCriticalSection(&g_muextBuffer);
    result = -50 - v7;
  }
  else
  {
    CProtectedAddress::operator=(&lpImageDll_Protected, v12);
    g_sh_done = v17;
    g_sh_init = v18;
    g_set_base = v19;
    g_set_db_buf = v20;
    g_set_func = v21;
    g_sh_set_info = v22;
    if ( v18 && v22 && v17 && v20 && v19 && v21 )
    {
      v25 = -1;
      LeaveCriticalSection(&g_muextBuffer);
      result = 0;
    }
    else
    {
      free_lib();
      v25 = -1;
      LeaveCriticalSection(&g_muextBuffer);
      result = -3;
    }
  }
LABEL_18:
  __writefsdword((unsigned int)&_except_list, v24[0]);
  return result;
}
// 1269C: could not find valid save-restore pair for edi
// 128E0: conditional instruction was optimized away because of '%var_158.4==0'
// 126F2: variable 'v8' is possibly undefined
// 12827: variable 'v9' is possibly undefined
// 12861: variable 'v10' is possibly undefined
// 12044: using guessed type int dword_12044;
// 12048: using guessed type int dword_12048;
// 12060: using guessed type int g_sh_init;
// 12064: using guessed type int g_sh_set_info;
// 12068: using guessed type int g_sh_done;
// 1206C: using guessed type int g_set_db_buf;
// 12070: using guessed type int g_set_base;
// 12074: using guessed type int g_set_func;
// 132C4: using guessed type int __thiscall CProtectedAddress::operator=(_DWORD, _DWORD);
// 132CC: using guessed type int __thiscall CProtectedAddress::operator()(_DWORD, _DWORD);

//----- (0001299C) --------------------------------------------------------
void __usercall _L31509(int a1@<ebp>)
{
  CSHMutexLock::~CSHMutexLock((CSHMutexLock *)(a1 - 320));
}

//----- (00012C72) --------------------------------------------------------
#error "12C77: call analysis failed (funcsize=19)"

//----- (00012CBB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge _L31612@<eax>(int a1@<ebp>, int a2, int a3)
{
  int result; // eax

  *(_DWORD *)(a1 - 4) = -1;
  CProtectedAddress::~CProtectedAddress((CProtectedAddress *)(a1 - 20));
  result = -21;
  __writefsdword((unsigned int)&_except_list, *(_DWORD *)(a1 - 12));
  return result;
}
// 12CDF: positive sp value 10 has been found
// 12CBB: could not find valid save-restore pair for ebx
// 12CBB: could not find valid save-restore pair for edi
// 12CBB: could not find valid save-restore pair for esi

//----- (00012CE2) --------------------------------------------------------
#error "12CE7: call analysis failed (funcsize=19)"

//----- (00012D2B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge _L31611@<eax>(int a1@<ebp>, int a2, int a3)
{
  int result; // eax

  *(_DWORD *)(a1 - 4) = -1;
  CProtectedAddress::~CProtectedAddress((CProtectedAddress *)(a1 - 20));
  result = -20;
  __writefsdword((unsigned int)&_except_list, *(_DWORD *)(a1 - 12));
  return result;
}
// 12D4F: positive sp value 10 has been found
// 12D2B: could not find valid save-restore pair for ebx
// 12D2B: could not find valid save-restore pair for edi
// 12D2B: could not find valid save-restore pair for esi

//----- (00012D79) --------------------------------------------------------
#error "12D7E: call analysis failed (funcsize=18)"

//----- (00012DBB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge _L31613@<eax>(int a1@<ebp>, int a2, int a3)
{
  int result; // eax

  *(_DWORD *)(a1 - 4) = -1;
  CProtectedAddress::~CProtectedAddress((CProtectedAddress *)(a1 - 20));
  result = -10;
  __writefsdword((unsigned int)&_except_list, *(_DWORD *)(a1 - 12));
  return result;
}
// 12DDF: positive sp value 10 has been found
// 12DBB: could not find valid save-restore pair for ebx
// 12DBB: could not find valid save-restore pair for edi
// 12DBB: could not find valid save-restore pair for esi

//----- (00012DE2) --------------------------------------------------------
#error "12DE7: call analysis failed (funcsize=18)"

//----- (00012E24) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge _L31614@<eax>(int a1@<ebp>, int a2, int a3)
{
  int result; // eax

  *(_DWORD *)(a1 - 4) = -1;
  CProtectedAddress::~CProtectedAddress((CProtectedAddress *)(a1 - 20));
  result = -17;
  __writefsdword((unsigned int)&_except_list, *(_DWORD *)(a1 - 12));
  return result;
}
// 12E48: positive sp value 10 has been found
// 12E24: could not find valid save-restore pair for ebx
// 12E24: could not find valid save-restore pair for edi
// 12E24: could not find valid save-restore pair for esi

//----- (00012E4B) --------------------------------------------------------
int (__userpurge *_L31599())@<eax>(int a1@<ebp>, int a2, int a3)
{
  init = 0;
  return _L31609;
}
// 1205C: using guessed type int init;

//----- (00012E5B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge _L31609@<eax>(int a1@<ebp>, int a2, int a3)
{
  int result; // eax

  *(_DWORD *)(a1 - 4) = -1;
  CProtectedAddress::~CProtectedAddress((CProtectedAddress *)(a1 - 20));
  result = -18;
  __writefsdword((unsigned int)&_except_list, *(_DWORD *)(a1 - 12));
  return result;
}
// 12E7F: positive sp value 10 has been found
// 12E5B: could not find valid save-restore pair for ebx
// 12E5B: could not find valid save-restore pair for edi
// 12E5B: could not find valid save-restore pair for esi

//----- (00012E82) --------------------------------------------------------
int (__userpurge *_L31600())@<eax>(int a1@<ebp>, int a2, int a3)
{
  init = 0;
  return _L31610;
}
// 1205C: using guessed type int init;

//----- (00012E92) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge _L31610@<eax>(int a1@<ebp>, int a2, int a3)
{
  int result; // eax

  *(_DWORD *)(a1 - 4) = -1;
  CProtectedAddress::~CProtectedAddress((CProtectedAddress *)(a1 - 20));
  result = -19;
  __writefsdword((unsigned int)&_except_list, *(_DWORD *)(a1 - 12));
  return result;
}
// 12EB6: positive sp value 10 has been found
// 12E92: could not find valid save-restore pair for ebx
// 12E92: could not find valid save-restore pair for edi
// 12E92: could not find valid save-restore pair for esi

//----- (00012EBC) --------------------------------------------------------
void __usercall _L31608(int a1@<ebp>)
{
  CProtectedAddress::~CProtectedAddress((CProtectedAddress *)(a1 - 20));
}

//----- (00012FE8) --------------------------------------------------------
#error "12FED: call analysis failed (funcsize=17)"

//----- (00013038) --------------------------------------------------------
int __stdcall CHCEnd()
{
  int result; // eax
  _DWORD v1[7]; // [esp-18h] [ebp-28h] BYREF
  unsigned int v2[2]; // [esp+4h] [ebp-Ch] BYREF
  int v3; // [esp+Ch] [ebp-4h]

  v3 = -1;
  v2[1] = (unsigned int)&_L31639;
  v2[0] = __readfsdword((unsigned int)&_except_list);
  __writefsdword((unsigned int)&_except_list, (unsigned int)v2);
  v1[6] = v1;
  _set_se_translator((void (__cdecl *)(unsigned int, struct _EXCEPTION_POINTERS *))Interface_SeTranslator);
  v3 = 0;
  if ( init )
  {
    if ( --init )
      init = 0;
    cleanup_sh();
    result = 0;
    __writefsdword((unsigned int)&_except_list, v2[0]);
  }
  else
  {
    result = 0;
    __writefsdword((unsigned int)&_except_list, v2[0]);
  }
  return result;
}
// 1205C: using guessed type int init;
// 12FE8: using guessed type void __cdecl cleanup_sh();
// 132C4: using guessed type int __thiscall CProtectedAddress::operator=(_DWORD, _DWORD);

//----- (0001319C) --------------------------------------------------------
int _E17()
{
  _E14();
  return _E16();
}

//----- (000131AC) --------------------------------------------------------
int _E14()
{
  return std::ios_base::Init::Init((std::ios_base::Init *)&_Ios_init);
}

//----- (000131BC) --------------------------------------------------------
int _E16()
{
  return atexit(_E15);
}

//----- (000131CC) --------------------------------------------------------
void __cdecl _E15()
{
  std::ios_base::Init::~Init((std::ios_base::Init *)&_Ios_init);
}

//----- (000131DC) --------------------------------------------------------
int _E23()
{
  _E20();
  return _E22();
}

//----- (000131EC) --------------------------------------------------------
int _E20()
{
  return std::_Winit::_Winit((std::_Winit *)&_Wios_init);
}

//----- (000131FC) --------------------------------------------------------
int _E22()
{
  return atexit(_E21);
}

//----- (0001320C) --------------------------------------------------------
void __cdecl _E21()
{
  std::_Winit::~_Winit((std::_Winit *)&_Wios_init);
}

//----- (0001321C) --------------------------------------------------------
void __thiscall CSHMutex::~CSHMutex(LPCRITICAL_SECTION lpCriticalSection)
{
  DeleteCriticalSection(lpCriticalSection);
}

//----- (0001322C) --------------------------------------------------------
void __thiscall CSHMutexLock::~CSHMutexLock(CSHMutexLock *this)
{
  LeaveCriticalSection(*(LPCRITICAL_SECTION *)this);
}

//----- (0001323C) --------------------------------------------------------
int _E61()
{
  if ( (___B_1___id___ctype_G_std___D__9_51 & 1) == 0 )
    ___B_1___id___ctype_G_std___D__9_51 |= 1u;
  return _E60();
}

//----- (0001325C) --------------------------------------------------------
int _E60()
{
  return atexit(std::ctype<unsigned short>::id`template static data member destructor helper');
}

// nfuncs=233 queued=196 decompiled=196 lumina nreq=0 worse=0 better=0
#error "There were 10 decompilation failure(s) on 196 function(s)"
